{"version":3,"file":"creat-loader.es.js","sources":["src/common/constants.ts","src/common/utils/index.ts","src/classFile/Author.ts","src/classFile/Background.ts","src/classFile/Cursor.ts","src/classFile/Event.ts","src/classFile/Export.ts","src/support/Canvas.ts","src/classFile/Grid.ts","src/classFile/History.ts","src/classFile/ImageEdit.ts","src/classFile/KeyCommand.ts","src/common/utils/checkClick.ts","src/support/BaseNode.ts","src/support/BaseMultiplexCoordinateNode.ts","src/support/plot.ts","src/support/DragNode.ts","src/components/ArbitraryPlot.ts","src/components/Arrow.ts","src/components/Circle.ts","src/components/Diamond.ts","src/components/Image.ts","src/components/Line.ts","src/components/Rectangle.ts","src/components/Text.ts","src/components/Triangle.ts","src/classFile/Nodes.ts","src/classFile/Render.ts","src/common/utils/Calculate.ts","src/components/MultiplexSelectNode.ts","src/classFile/Selection.ts","src/classFile/TextEdit.ts","src/common/utils/diffData.ts","src/API.ts","src/index.ts"],"sourcesContent":["import { KeyPosit } from '../types'\n\n// The number key corresponding to the key position\nexport const keyPosit: KeyPosit = {\n  '0': 48,\n  '1': 49,\n  '2': 50,\n  '3': 51,\n  '4': 52,\n  '5': 53,\n  '6': 54,\n  '7': 55,\n  '8': 56,\n  '9': 57,\n  Backspace: 8,\n  Tab: 9,\n  Enter: 13,\n  Shift: 16,\n  Control: 17,\n  Alt: 18,\n  CapsLock: 20,\n  Esc: 27,\n  Space: 32,\n  PageUp: 33,\n  PageDown: 34,\n  End: 35,\n  Home: 36,\n  Insert: 45,\n  Left: 37,\n  Up: 38,\n  Right: 39,\n  Down: 40,\n  Del: 46,\n  NumLock: 144,\n  Cmd: 91,\n  CmdFF: 224,\n  F1: 112,\n  F2: 113,\n  F3: 114,\n  F4: 115,\n  F5: 116,\n  F6: 117,\n  F7: 118,\n  F8: 119,\n  F9: 120,\n  F10: 121,\n  F11: 122,\n  F12: 123,\n  '`': 192,\n  '=': 187,\n  '+': 187,\n  '-': 189,\n  \"'\": 222,\n  '/': 191,\n  '.': 190,\n  a: 65,\n  b: 66,\n  c: 67,\n  d: 68,\n  e: 69,\n  f: 70,\n  g: 71,\n  h: 72,\n  i: 73,\n  j: 74,\n  k: 75,\n  l: 76,\n  m: 77,\n  n: 78,\n  o: 79,\n  p: 80,\n  q: 81,\n  r: 82,\n  s: 83,\n  t: 84,\n  u: 85,\n  v: 86,\n  w: 87,\n  x: 88,\n  y: 89,\n  z: 90\n}\n// Click on the applicable trigger pixel range\nexport const CLICK_DISTANCE = 10\n\n// Four corners of a graphical object\nexport const FOUR_CORNER = {\n  TOP_LEFT: 'topLeft',\n  TOP_RIGHT: 'topRight',\n  BOTTOM_RIGHT: 'bottomRight',\n  BOTTOM_LEFT: 'bottomLeft'\n}\n\n// Drag and drop a part of a graphic object\nexport const DRAG_NODE_PARTS = {\n  BODY: 'body',\n  ROTATE: 'rotate',\n  TOP_LEFT_BUTTON: 'topLeftButton',\n  TOP_RIGHT_BUTTON: 'topRightButton',\n  BOTTOM_RIGHT_BUTTON: 'bottomRightButton',\n  BOTTOM_LEFT_BUTTON: 'bottomLeftButton'\n}\n","import { Ctx, LocalData, Node, NodeArray, Style } from '../../types'\n\n// Generate an ID, seeded with a timestamp + random number, with the first half random and the second half incremental\nexport function getNodeID() {\n  const seed = Math.floor(Math.random() * 1e12) * 1e7 + new Date().getTime()\n  return seed.toString(36)\n}\n\n// Unique key for graphical objects\nlet nodeKeyIndex = 0\nexport function createNodeKey() {\n  nodeKeyIndex += 1\n  return nodeKeyIndex\n}\n\nexport const deepCopy = (obj: LocalData) => JSON.parse(JSON.stringify(obj))\n\n// Download the file\nexport const downloadFile = (file: string, fileName: string) => {\n  const a = document.createElement('a')\n  a.href = file\n  a.download = fileName\n  a.click()\n}\n\n// Throttling\nexport const throttle = (fn: any, ctx: Ctx, time = 20) => {\n  let _timer: any = null\n  return (...args: any) => {\n    if (_timer) {\n      return\n    }\n    _timer = setTimeout(() => {\n      fn.call(ctx, ...args)\n      _timer = null\n    }, time)\n  }\n}\n\n// Spliced text font size string\nexport const getFontString = (fontSize: number, fontFamily: string) =>\n  `${fontSize}px ${fontFamily}`\n\n// Text cut into lines\nexport const splitTextLines = (text: string) =>\n  text.replace(/\\r\\n?/g, '\\n').split('\\n')\n\n// Curvature to angle\nexport const radToDeg = (rad: number) => rad * (180 / Math.PI)\n\n// Angle to radians\nexport const degToRad = (deg: number) => deg * (Math.PI / 180)\n\nexport const createCanvas = (\n  width: number,\n  height: number,\n  option: { noStyle?: boolean; noTranslate?: boolean; className?: string } = {\n    noStyle: false,\n    noTranslate: false,\n    className: ''\n  }\n) => {\n  const canvas = document.createElement('canvas')\n  if (!option.noStyle) {\n    canvas.style.cssText = `position: absolute;left: 0;top: 0;`\n  }\n  if (option.className) {\n    canvas.className = option.className\n  }\n  // Get Drawing Context\n  const ctx = canvas.getContext('2d')\n  canvas.width = width\n  canvas.height = height\n  // Move the canvas origin to the centre of the canvas\n  if (!option.noTranslate) {\n    ctx?.translate(canvas.width / 2, canvas.height / 2)\n  }\n  return {\n    canvas,\n    ctx\n  }\n}\n\n// Calculate the distance between two coordinates\nexport const getTowCoordinateDistance = (\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number\n) => Math.sqrt((x1 - x2) ** 2 + (y1 - y2) ** 2)\n\n// Calculate the distance from a point to a line\nexport const getCoordinateToLineDistance = (\n  x: number,\n  y: number,\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number\n) => {\n  // Straight line perpendicular to x-axis\n  if (x1 === x2) {\n    return Math.abs(x - x1)\n  }\n  const B = 1\n  const A = (y1 - y2) / (x2 - x1)\n  const C = 0 - B * y1 - A * x1\n  return Math.abs((A * x + B * y + C) / Math.sqrt(A * A + B * B))\n}\n\n// Check if you have clicked on a line segment\nexport const checkIsAtSegment = (\n  x: number,\n  y: number,\n  x1: number,\n  y1: number,\n  x2: number | undefined,\n  y2: number | undefined,\n  dis = 10\n) => {\n  if (typeof x2 === 'undefined' || typeof y2 === 'undefined') {\n    return false\n  }\n  if (getCoordinateToLineDistance(x, y, x1, y1, x2, y2) > dis) {\n    return false\n  }\n  const dis1 = getTowCoordinateDistance(x, y, x1, y1)\n  const dis2 = getTowCoordinateDistance(x, y, x2, y2)\n  const dis3 = getTowCoordinateDistance(x1, y1, x2, y2)\n  const max = Math.sqrt(dis * dis + dis3 * dis3)\n  return dis1 <= max && dis2 <= max\n}\n\n// Calculate the angle of difference between two coordinates with the same centre point\nexport const getTowCoordinateRotate = (\n  cx: number,\n  cy: number,\n  tx: number,\n  ty: number,\n  fx: number,\n  fy: number\n) => radToDeg(Math.atan2(ty - cy, tx - cx) - Math.atan2(fy - cy, fx - cx))\n\n// Get coordinates rotated by a specified angle from a specified centre, clockwise or anti-clockwise rotate by passing positive or negative\nexport const getRotatedCoordinate = (\n  x: number,\n  y: number,\n  cx: number,\n  cy: number,\n  rotate: number\n) => {\n  const deg = radToDeg(Math.atan2(y - cy, x - cx))\n  const del = deg + rotate\n  const dis = getTowCoordinateDistance(x, y, cx, cy)\n  return {\n    x: Math.cos(degToRad(del)) * dis + cx,\n    y: Math.sin(degToRad(del)) * dis + cy\n  }\n}\n\n// Get the coordinates of the element's centroid\nexport const getNodeCenterCoordinate = (node: any) => {\n  const { x, y, width, height }: any = node as Node\n  return {\n    x: x + width / 2,\n    y: y + height / 2\n  }\n}\n\n// Rotate the coordinates by the specified angle at the specified centre point\nexport const transformCoordinateReverseRotate = (\n  x: number,\n  y: number,\n  cx: number,\n  cy: number,\n  rotate: number\n) => {\n  if (rotate !== 0) {\n    const rp = getRotatedCoordinate(x, y, cx, cy, -rotate)\n    x = rp.x\n    y = rp.y\n  }\n  return {\n    x,\n    y\n  }\n}\n\n//  Handles mouse coordinates according to whether the element is rotated or not, if the element is rotated, then the mouse coordinates are rotated backwards\nexport const transformCoordinateOnNode = (x: number, y: number, node: any) => {\n  const center = getNodeCenterCoordinate(node as Node)\n  return transformCoordinateReverseRotate(\n    x,\n    y,\n    center.x,\n    center.y,\n    <number>node.rotate\n  )\n}\n\n// Get the four corner coordinates of the object\nexport const getNodeFourCornerCoordinate = (node: Node, dir: string) => {\n  const { x, y, width, height }: any = node\n  switch (dir) {\n    case 'topLeft':\n      return {\n        x,\n        y\n      }\n    case 'topRight':\n      return {\n        x: x + width,\n        y\n      }\n    case 'bottomRight':\n      return {\n        x: x + width,\n        y: y + height\n      }\n    case 'bottomLeft':\n      return {\n        x,\n        y: y + height\n      }\n    default:\n      break\n  }\n  return {}\n}\n\n// Get the outer bounding box for multiple coordinates\nexport const getBoundingRect = (\n  coordinateArr = [],\n  returnFourCorners = false\n) => {\n  let minX = Infinity\n  let maxX = -Infinity\n  let minY = Infinity\n  let maxY = -Infinity\n  coordinateArr.forEach((coordinate) => {\n    const [x, y]: Array<number> = coordinate\n    if (x < minX) {\n      minX = x\n    }\n    if (x > maxX) {\n      maxX = x\n    }\n    if (y < minY) {\n      minY = y\n    }\n    if (y > maxY) {\n      maxY = y\n    }\n  })\n  const x = minX\n  const y = minY\n  const width = maxX - minX\n  const height = maxY - minY\n  // Return in four corner coordinates\n  if (returnFourCorners) {\n    return [\n      {\n        x,\n        y\n      },\n      {\n        x: x + width,\n        y\n      },\n      {\n        x: x + width,\n        y: y + height\n      },\n      {\n        x,\n        y: y + height\n      }\n    ]\n  }\n  return {\n    x,\n    y,\n    width,\n    height\n  }\n}\n\n// Get the coordinates of the four corners of a rotated graphic object\nexport const getNodeRotatedFourCornerCoordinate = (node: Node, dir: string) => {\n  const center = getNodeCenterCoordinate(node)\n  const dirPos = getNodeFourCornerCoordinate(node, dir)\n  if (!dirPos || !dirPos.x || !dirPos.y) {\n    return 0\n  }\n  return getRotatedCoordinate(\n    dirPos.x,\n    dirPos.y,\n    center.x,\n    center.y,\n    <number>node.rotate\n  )\n}\n\n// Determines whether a coordinate is within a rectangle. rx can be a graphical object with x, y, width, height\nexport const checkCoordinateIsInRectangle = (\n  x: number,\n  y: number,\n  rx: number | Node,\n  ry?: number | undefined,\n  rw?: number | undefined,\n  rh?: number | undefined\n) => {\n  if (typeof rx === 'object') {\n    const node = rx\n    rx = node.x as number\n    ry = node.y\n    rw = node.width\n    rh = node.height\n  }\n  if (\n    typeof ry === 'undefined' ||\n    typeof rw === 'undefined' ||\n    typeof rh === 'undefined'\n  ) {\n    return false\n  }\n  return x >= rx && x <= rx + rw && y >= ry && y <= ry + rh\n}\n\n// Get the outermost bounding box information of multiple graphic objects\nexport const getMultiplexNodeRectInfo = (nodeList: NodeArray = []) => {\n  if (nodeList.length <= 0) {\n    return {\n      minX: 0,\n      maxX: 0,\n      minY: 0,\n      maxY: 0\n    }\n  }\n  let minX = Infinity\n  let maxX = -Infinity\n  let minY = Infinity\n  let maxY = -Infinity\n  nodeList.forEach((node) => {\n    const coordinateList = node?.getEndCoordinateList?.()\n    coordinateList.forEach(({ x, y }: { x: number; y: number }) => {\n      if (x < minX) {\n        minX = x\n      }\n      if (x > maxX) {\n        maxX = x\n      }\n      if (y < minY) {\n        minY = y\n      }\n      if (y > maxY) {\n        maxY = y\n      }\n    })\n  })\n  return {\n    minX,\n    maxX,\n    minY,\n    maxY\n  }\n}\n\n// Calculate the actual rendering width of the text\nlet textCheckEl: HTMLDivElement | null = null\nexport const getTextActWidth = (text: string, style: Style) => {\n  if (!textCheckEl) {\n    textCheckEl = document.createElement('div')\n    textCheckEl.style.position = 'fixed'\n    textCheckEl.style.left = '-99999px'\n    document.body.appendChild(textCheckEl)\n  }\n  const { fontSize, fontFamily } = style\n  textCheckEl.innerText = text\n  textCheckEl.style.fontSize = `${fontSize}px`\n  textCheckEl.style.fontFamily = fontFamily\n  const { width } = textCheckEl.getBoundingClientRect()\n  return width\n}\n\n//  Gets the coordinates of the four corners of the graphical object, after applying the rotation\nexport const getNodeFourCorners = (node: Node) => {\n  const bottomRight = getNodeRotatedFourCornerCoordinate(node, 'bottomRight')\n  const topLeft = getNodeRotatedFourCornerCoordinate(node, 'topLeft')\n  const topRight = getNodeRotatedFourCornerCoordinate(node, 'topRight')\n  const bottomLeft = getNodeRotatedFourCornerCoordinate(node, 'bottomLeft')\n  return [topLeft, topRight, bottomLeft, bottomRight]\n}\n\n// Creating picture objects\nexport const createImageObj = (url: string) =>\n  new Promise((resolve) => {\n    const img = new Image()\n    img.setAttribute('crossOrigin', 'anonymous')\n    img.onload = () => {\n      resolve(img)\n    }\n    img.onerror = () => {\n      resolve(null)\n    }\n    img.src = url\n  })\n\n// Calculate the maximum font size that will fit all text within a fixed width\nexport const getMaxFontSizeInWidth = (\n  text: string,\n  width: number,\n  style: { fontSize: number; fontFamily: string }\n) => {\n  let fontSize = 12\n  while (\n    getTextActWidth(text, {\n      ...style,\n      fontSize: fontSize + 1\n    }) < width\n  ) {\n    fontSize += 1\n  }\n  return fontSize\n}\n\n// Calculating the actual width of line feed text\nexport const getWrapTextActWidth = (node: Node) => {\n  const { text }: any = node\n  const textArr = splitTextLines(text)\n  let maxWidth = -Infinity\n  textArr.forEach((textRow) => {\n    const width = getTextActWidth(textRow, <any>node.style)\n    if (width > maxWidth) {\n      maxWidth = width\n    }\n  })\n  return maxWidth\n}\n\n// Calculate the number of words in the longest line of newline text\nexport const getWrapTextMaxRowTextNumber = (text: string) => {\n  const textArr = splitTextLines(text)\n  let maxNumber = -Infinity\n  textArr.forEach((textRow) => {\n    if (textRow.length > maxNumber) {\n      maxNumber = textRow.length\n    }\n  })\n  return maxNumber\n}\n\n// Calculate the width and height of a text graphic object\nexport const getTextNodeSize = (node: Node) => {\n  const { text, style }: any = node\n  const width = getWrapTextActWidth(node)\n  const lines = Math.max(splitTextLines(text).length, 1)\n  const lineHeight = style.fontSize * style.lineHeightRatio\n  const height = lines * lineHeight\n  return {\n    width,\n    height\n  }\n}\n\n// Calculate brush thickness based on speed\nexport const computedLineWidthBySpeed = (\n  speed: number,\n  lastLineWidth: number,\n  baseLineWidth = 2\n) => {\n  let lineWidth = 0\n  const maxLineWidth = baseLineWidth + 2\n  const maxSpeed = 10\n  const minSpeed = 0.5\n  if (speed >= maxSpeed) {\n    lineWidth = baseLineWidth\n  } else if (speed <= minSpeed) {\n    lineWidth = maxLineWidth + 1\n  } else {\n    lineWidth =\n      maxLineWidth - ((speed - minSpeed) / (maxSpeed - minSpeed)) * maxLineWidth\n  }\n  if (lastLineWidth === -1) {\n    lastLineWidth = maxLineWidth\n  }\n  return lineWidth * 0.5 + lastLineWidth * 0.3\n}\n","import { keyPosit } from '../common/constants'\nimport { throttle } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class Author {\n  public app: AppObject\n\n  public startScrollX: number | undefined\n\n  public startScrollY: number | undefined\n\n  isDragAuthor: boolean\n\n  constructor(app: AppObject) {\n    this.app = app\n    // Save the scroll offset when dragging is about to start\n    this.startScrollX = 0\n    this.startScrollY = 0\n    // Canvas drag and drop Author\n    this.isDragAuthor = false\n    // A little relief from lag\n    this.onMove = throttle(this.onMove, this as any, 15)\n    this.bindEvent()\n  }\n\n  // Save the current scroll offset\n  onStart() {\n    this.startScrollX = this.app.state.scrollX\n    this.startScrollY = this.app.state.scrollY\n  }\n\n  // Update scroll offset and re-render\n  onMove(e: any, event: { mouseOffset: { originX: number; originY: number } }) {\n    if (\n      typeof this.startScrollX !== 'undefined' &&\n      typeof this.startScrollY !== 'undefined' &&\n      typeof this.app.state.scale !== 'undefined'\n    ) {\n      this.app.scrollTo(\n        this.startScrollX - event.mouseOffset.originX / this.app.state.scale,\n        this.startScrollY - event.mouseOffset.originY / this.app.state.scale\n      )\n    }\n  }\n\n  bindEvent() {\n    this.app.event.on('keydown', (e: { keyCode: number }) => {\n      if (e.keyCode === keyPosit.Space) {\n        this.isDragAuthor = true\n        this.app.cursor.set('grab')\n      }\n    })\n    this.app.event.on('keyup', () => {\n      if (this.isDragAuthor) {\n        this.isDragAuthor = false\n        this.app.cursor.set('default')\n      }\n    })\n  }\n\n  // Set to edit Author\n  setEditAuthor() {\n    this.app.cursor.set('default')\n    this.app.updateState({\n      readonly: false\n    })\n  }\n\n  // Set to read-only Author\n  setReadonlyAuthor() {\n    this.app.cursor.set('grab')\n    this.app.cancelActiveNode()\n    this.app.updateState({\n      readonly: true\n    })\n  }\n}\n","import { AppObject, Ctx } from '../types'\n\nexport default class Background {\n  public app: AppObject\n\n  constructor(app: AppObject) {\n    this.app = app\n  }\n\n  // Setting the background\n  set() {\n    if (this.app.state.backgroundColor) {\n      this.addBackgroundColor()\n    } else {\n      this.remove()\n    }\n  }\n\n  // Add background colour\n  addBackgroundColor() {\n    this.app.mountEL.style.backgroundColor = <string>(\n      this.app.state.backgroundColor\n    )\n  }\n\n  // Remove background colour\n  remove() {\n    this.app.mountEL.style.backgroundColor = ''\n  }\n\n  // Set background colour inside canvas, not css style\n  static canvasAddBackgroundColor(\n    ctx: Ctx,\n    width: number,\n    height: number,\n    backgroundColor: string\n  ) {\n    ctx.save()\n    ctx.rect(0, 0, width, height)\n    ctx.fillStyle = backgroundColor\n    ctx.fill()\n    ctx.restore()\n  }\n}\n","import { DRAG_NODE_PARTS } from '../common/constants'\nimport { AppObject } from '../types'\n\nexport default class Cursor {\n  public app: AppObject\n\n  public currentType: string\n\n  constructor(app: AppObject) {\n    this.app = app\n    this.currentType = 'default'\n  }\n\n  // Set the mouse pointer style\n  set(type = 'default') {\n    this.currentType = type\n    let style = type\n    if (type === 'eraser') {\n      style = `url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAbZJREFUSEvNlL1rVEEUxc95uwvCVjYKNnZa2ATEXrALNhaKiBgQDabQwt13hlQbi30w8x4oNhaCkYBFElAhoJXaip2FRfIX2FhY2c2VJy5skn0fERacbphzf3Pv5dxLzOlwTlz8H2Dv/VqSJF/NbFHS3bpqW2ec5/mqmWUk1wC8iTFmzrnLVfBWYO/9gGQxBVkl+c7M1iWdnwVvBIcQ7gN4OiP4IckPZrYj6fTB91pwURT3YozPqso1sxWSnwF8knR8WlcJDiHcAfC8yY5mdgvAT5KvJXUn+plg7/0SyZdN0Kn3bQA/JK1UgvM8v2Fmr44A/SMleSlN048zwSGEqwC2jgpNkmRxOBy+r+yx9/4xyQUAF9vCzeyKc+5trStCCCaJRVFciDF+aQG/Lmmz1schhHKKXkg6UQqzLDvT7XZ3a+BLkjZaTV6ZcafTOTsYDPbKgPF4fLLX630/VCa5nKZprRX32a1cMiRHZTsmsNFodKzf7/+a3M3stnNuvalNh3w8gQO4Jmn7r1OeADhlZjedc62sWDUgyyQfADgH4BuAR2WG5UdNmdZOXtvgOl3jdvvXT+YG/g3VNZQXhpoDKQAAAABJRU5ErkJggg==) 10 10, auto`\n    }\n    if (type === 'text') {\n      style = `url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAWZJREFUSEvNlLFOwzAQhi+5iaUrDDwBHekDNHtZEOorMFk5JQ8APEAsJyOPwAjsZEZ0LAMrCzwBUxx0kVM5adI4RZXwlMj2p///fXceHGh5B+LC/wPHcXxWFMWSHSulbtvO91JsoA8AMDXAXCkV2PC9wAwgIlZ5Y8HubOWjwLX9GtCCN1Q7g1v2N+oM/Mr3/Usp5UftwAlsoG8AcNRlnfeTJHkflbGBrnvqvZGrM5iI5gDw0gNdI+KyrXQwigHoDyLO+qAM78w4DMNjz/O++todEae7oJ1gIcQpIn7+BboFHrDP5wOlVO4yuBpREBGX1HnPRWdoQ3EURQut9VMXtCzLkzRNv12UblUFET0CwEX7stZ6lmXZagx0o1gIMTEPNrEAK631dQ01rVuNyPobAHg+5PZeQ7HVXWz31ff9eynls62SiEoDCqzhU+Vu73VFMd/14qZiWDGDuCOrZf/b952G0Nh8+fwvoNqzF6HDmhsAAAAASUVORK5CYII=) 10 10, auto`\n    }\n    this.app.mountEL.style.cursor = style\n  }\n\n  setEraser() {\n    this.set('eraser')\n  }\n\n  setText() {\n    this.set('text')\n  }\n\n  setMove() {\n    this.set('move')\n  }\n\n  hide() {\n    this.set('none')\n  }\n\n  reset() {\n    this.set()\n  }\n\n  setCrossHair() {\n    this.set('crosshair')\n  }\n\n  // Set to a movable state in a certain direction\n  setResize(direction: string) {\n    let type = ''\n    switch (direction) {\n      case DRAG_NODE_PARTS.BODY:\n        type = 'move'\n        break\n      case DRAG_NODE_PARTS.ROTATE:\n        type = 'grab'\n        break\n      case DRAG_NODE_PARTS.TOP_LEFT_BUTTON:\n        type = 'nw-resize'\n        break\n      case DRAG_NODE_PARTS.TOP_RIGHT_BUTTON:\n        type = 'ne-resize'\n        break\n      case DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON:\n        type = 'se-resize'\n        break\n      case DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON:\n        type = 'sw-resize'\n        break\n      default:\n        break\n    }\n    this.set(type)\n  }\n}\n","import EventEmitter from 'eventemitter3'\n\nimport { getTowCoordinateDistance } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class Event extends EventEmitter {\n  public app: AppObject\n\n  public calculate: any\n\n  public lastMousePos: { x: number; y: number }\n\n  public mouseDistance: number\n\n  public lastMouseTime: number\n\n  public mouseDuration: number\n\n  public mouseSpeed: number\n\n  public isMousedown: boolean\n\n  public mousedownPos: {\n    originClientY: number\n    x: number\n    y: number\n    unGridClientX: number\n    unGridClientY: number\n    originClientX: number\n  }\n\n  public mouseOffset: {\n    originX: number\n    originY: number\n    x: number\n    y: number\n  }\n\n  constructor(app: AppObject) {\n    super()\n    this.app = app\n    this.calculate = app.calculate\n\n    // Record the mouse position at the previous moment\n    this.lastMousePos = {\n      x: 0,\n      y: 0\n    }\n\n    // Distance of mouse movement in the previous instant\n    this.mouseDistance = 0\n\n    // Record the time of the previous moment\n    this.lastMouseTime = Date.now()\n\n    // The moment before\n    this.mouseDuration = 0\n\n    // Mouse movement speed in the previous instant\n    this.mouseSpeed = 0\n\n    // Is the mouse pressed\n    this.isMousedown = false\n\n    // Mouse position when pressed\n    this.mousedownPos = {\n      x: 0,\n      y: 0,\n      unGridClientX: 0,\n      unGridClientY: 0,\n      originClientX: 0,\n      originClientY: 0\n    }\n\n    // The difference between the current position of the mouse and the position when it is pressed\n    this.mouseOffset = {\n      x: 0,\n      y: 0,\n      originX: 0,\n      originY: 0\n    }\n\n    this.onMousedown = this.onMousedown.bind(this)\n    this.onMousemove = this.onMousemove.bind(this)\n    this.onMouseup = this.onMouseup.bind(this)\n    this.onDblclick = this.onDblclick.bind(this)\n    this.onMousewheel = this.onMousewheel.bind(this)\n    this.onKeydown = this.onKeydown.bind(this)\n    this.onKeyup = this.onKeyup.bind(this)\n    this.onContextmenu = this.onContextmenu.bind(this)\n    this.bindEvent()\n  }\n\n  onMouseup(e: any) {\n    e = this.transformEvent(e)\n    this.isMousedown = false\n    this.mousedownPos.x = 0\n    this.mousedownPos.y = 0\n    this.emit('mouseup', e, this)\n  }\n\n  onDblclick(e: any) {\n    e = this.transformEvent(e)\n    this.emit('dblclick', e, this)\n  }\n\n  onMousewheel(e: any) {\n    e = this.transformEvent(e)\n    this.emit('mousewheel', e.originEvent.wheelDelta < 0 ? 'down' : 'up')\n  }\n\n  onContextmenu(e: any) {\n    e.stopPropagation()\n    e.preventDefault()\n    e = this.transformEvent(e)\n    this.emit('contextmenu', e, this)\n  }\n\n  onKeydown(e: any) {\n    this.emit('keydown', e, this)\n  }\n\n  onKeyup(e: any) {\n    this.emit('keyup', e, this)\n  }\n\n  onMousedown(e: any) {\n    e = this.transformEvent(e)\n    this.isMousedown = true\n    this.mousedownPos.x = e.clientX\n    this.mousedownPos.y = e.clientY\n    this.mousedownPos.unGridClientX = e.unGridClientX\n    this.mousedownPos.unGridClientY = e.unGridClientY\n    this.mousedownPos.originClientX = e.originEvent.clientX\n    this.mousedownPos.originClientY = e.originEvent.clientY\n    this.emit('mousedown', e, this)\n  }\n\n  onMousemove(e: any) {\n    e = this.transformEvent(e)\n    const x = e.clientX\n    const y = e.clientY\n    if (this.isMousedown) {\n      this.mouseOffset.x = x - this.mousedownPos.x\n      this.mouseOffset.y = y - this.mousedownPos.y\n      this.mouseOffset.originX =\n        e.originEvent.clientX - this.mousedownPos.originClientX\n      this.mouseOffset.originY =\n        e.originEvent.clientY - this.mousedownPos.originClientY\n    }\n    const curTime = Date.now()\n    this.mouseDuration = curTime - this.lastMouseTime\n    this.mouseDistance = getTowCoordinateDistance(\n      x,\n      y,\n      this.lastMousePos.x,\n      this.lastMousePos.y\n    )\n    this.mouseSpeed = this.mouseDistance / this.mouseDuration\n    this.emit('mousemove', e, this)\n    this.lastMouseTime = curTime\n    this.lastMousePos.x = x\n    this.lastMousePos.y = y\n  }\n\n  // events into coordinates, and adsorption if grid is turned on\n  transformEvent(e: { clientX: any; clientY: any }) {\n    const { calculate } = this.app\n    const wp = calculate.windowToContainer(e.clientX, e.clientY)\n    let { x, y } = calculate.reverseScale(wp.x, wp.y)\n    x = calculate.addScrollX(x)\n    y = calculate.addScrollY(y)\n    const unGridClientX = x\n    const unGridClientY = y\n    const gp = calculate.gridAdsorbent(x, y)\n    return {\n      originEvent: e,\n      unGridClientX,\n      unGridClientY,\n      clientX: gp.x,\n      clientY: gp.y\n    }\n  }\n\n  bindEvent() {\n    this.app.mountEL.addEventListener('mousedown', this.onMousedown)\n    this.app.mountEL.addEventListener('mousemove', this.onMousemove)\n    this.app.mountEL.addEventListener('mouseup', this.onMouseup)\n    this.app.mountEL.addEventListener('dblclick', this.onDblclick)\n    this.app.mountEL.addEventListener('mousewheel', this.onMousewheel)\n    this.app.mountEL.addEventListener('contextmenu', this.onContextmenu)\n    window.addEventListener('keydown', this.onKeydown)\n    window.addEventListener('keyup', this.onKeyup)\n  }\n\n  unbindEvent() {\n    this.app.mountEL.removeEventListener('mousedown', this.onMousedown)\n    this.app.mountEL.removeEventListener('mousemove', this.onMousemove)\n    this.app.mountEL.removeEventListener('mouseup', this.onMouseup)\n    this.app.mountEL.removeEventListener('dblclick', this.onDblclick)\n    this.app.mountEL.removeEventListener('mousewheel', this.onMousewheel)\n    this.app.mountEL.removeEventListener('contextmenu', this.onContextmenu)\n    window.removeEventListener('keydown', this.onKeydown)\n    window.removeEventListener('keyup', this.onKeyup)\n  }\n}\n","import { createCanvas, getMultiplexNodeRectInfo } from '../common/utils'\nimport { AppObject, Ctx, Node, NodeArray } from '../types'\nimport Background from './Background'\n\nexport default class Export {\n  public app: AppObject\n\n  public openPreview: boolean\n\n  public saveState: {\n    width: number\n    scale: number\n    scrollY: number\n    scrollX: number\n    height: number\n    ctx?: Ctx\n  }\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.openPreview = false\n\n    this.saveState = {\n      scale: 0,\n      scrollX: 0,\n      scrollY: 0,\n      width: 0,\n      height: 0\n    }\n  }\n\n  // Export as json data\n  exportJson() {\n    return this.app.getData()\n  }\n\n  // Draw all graphic objects\n  render(ctx: Ctx, onlySelected: boolean) {\n    ctx.save()\n    this.getNodeList(onlySelected).forEach((node: Node) => {\n      if (node.noRender) {\n        return\n      }\n      const cacheActive = node.isActive\n      const cacheSelected = node.isSelected\n      node.isActive = false\n      node.isSelected = false\n      node.render()\n      node.isActive = cacheActive\n      node.isSelected = cacheSelected\n    })\n    ctx.restore()\n  }\n\n  // Save the current state data of the app class\n  saveAppState() {\n    const { width, height, state, ctx } = this.app\n    this.saveState.width = width\n    this.saveState.height = height\n    if (state.scale) {\n      this.saveState.scale = state.scale\n    }\n    if (state.scrollX) {\n      this.saveState.scrollX = state.scrollX\n    }\n    if (state.scrollY) {\n      this.saveState.scrollY = state.scrollY\n    }\n    this.saveState.ctx = ctx\n  }\n\n  // Export as image\n  exportImage({\n    type = 'image/png',\n    renderBg = true,\n    useBlob = false,\n    paddingX = 10,\n    paddingY = 10,\n    onlySelected = true\n  } = {}) {\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.getNodeList(onlySelected)\n    )\n    const width = maxX - minX + paddingX * 2\n    const height = maxY - minY + paddingY * 2\n    // Creating an export canvas\n    const { canvas, ctx } = createCanvas(width, height, {\n      noStyle: true,\n      noTranslate: true\n    })\n    if (!ctx) {\n      // eslint-disable-next-line no-console\n      console.error('Create Export Canvas Error')\n      return ''\n    }\n    this.show(canvas)\n    this.saveAppState()\n    this.changeAppState(minX - paddingX, minY - paddingY, ctx)\n    // Painting background colours\n    if (renderBg && this.app.state.backgroundColor && ctx) {\n      Background.canvasAddBackgroundColor(\n        ctx,\n        width,\n        height,\n        this.app.state.backgroundColor\n      )\n    }\n    // Drawing graphic objects to exported canvas\n    this.render(ctx, onlySelected)\n    this.recoveryAppState()\n\n    if (useBlob) {\n      return new Promise((resolve, reject) => {\n        canvas.toBlob((blob) => {\n          if (blob) {\n            resolve(blob)\n          } else {\n            reject()\n          }\n        }, type)\n      })\n    }\n    return canvas.toDataURL(type)\n  }\n\n  show(canvas: HTMLCanvasElement) {\n    if (this.openPreview) {\n      canvas.style.cssText = `position: absolute;left: 0;top: 0;background-color: #FFFFFF;`\n      document.body.appendChild(canvas)\n    }\n  }\n\n  // Recovery of app class status data\n  recoveryAppState() {\n    const { width, height, scale, scrollX, scrollY, ctx } = this.saveState\n    this.app.state.scale = scale\n    this.app.state.scrollX = scrollX\n    this.app.state.scrollY = scrollY\n    this.app.width = width\n    this.app.height = height\n    if (ctx) {\n      this.app.ctx = ctx\n    }\n  }\n\n  // Temporary modification of app class status data\n  changeAppState(minX: number, minY: number, ctx: Ctx) {\n    this.app.ctx = ctx\n    this.app.width = minX * 2\n    this.app.height = minY * 2\n    this.app.state.scale = 1\n    this.app.state.scrollX = 0\n    this.app.state.scrollY = 0\n  }\n\n  // Get the graphic object to be exported\n  getNodeList(onlySelected = true) {\n    // Exporting all graphic objects\n    if (!onlySelected) {\n      return this.app.nodes.nodeList\n    }\n    // Export only active or selected graphic objects\n    let selectedNodes: NodeArray = []\n    if (this.app.nodes.activeNode) {\n      selectedNodes.push(this.app.nodes.activeNode)\n    } else if (this.app.selection.hasSelectionNodes()) {\n      selectedNodes = this.app.selection.getSelectionNodes()\n    }\n    return this.app.nodes.nodeList.filter((node: Node) =>\n      selectedNodes.includes(node)\n    )\n  }\n}\n","import { createCanvas } from '../common/utils'\nimport { Ctx } from '../types'\n\nexport default class Canvas {\n  public width: number\n\n  public height: number\n\n  public el: HTMLCanvasElement | undefined\n\n  public ctx: Ctx | undefined\n\n  constructor(\n    width: number,\n    height: number,\n    opt?: { noStyle?: boolean; noTranslate?: boolean; className?: string }\n  ) {\n    this.width = width\n    this.height = height\n    const { canvas, ctx } = createCanvas(width, height, opt)\n    if (ctx) {\n      this.el = canvas\n      this.ctx = ctx\n    }\n  }\n\n  clearCanvas() {\n    const { width, height } = this\n    this.ctx?.clearRect(-width / 2, -height / 2, width, height)\n  }\n}\n","import Canvas from '../support/Canvas'\nimport { AppObject, Ctx } from '../types'\n\nexport default class Grid {\n  public app: AppObject\n\n  public canvas: any\n\n  public ctx: Ctx | null\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.canvas = null\n\n    this.ctx = null\n\n    this.init()\n\n    this.app.on('zoomChange', this.renderGrid, this)\n\n    this.app.on('scrollChange', this.renderGrid, this)\n  }\n\n  // plot vertical lines\n  renderVerticalLines() {\n    const { calculate, width, state } = this.app\n    const { gridConfig, scale } = state\n    let maxRight = 0\n    if (\n      typeof gridConfig === 'undefined' ||\n      typeof scale === 'undefined' ||\n      typeof gridConfig.size === 'undefined'\n    ) {\n      // eslint-disable-next-line no-console\n      console.error('gridConfig or scale or gridConfig.size is undefined')\n      return\n    }\n    for (let i = -width / 2; i < width / 2; i += gridConfig.size) {\n      this.plotVerticalLine(i)\n      maxRight = i\n    }\n    // Draws the line beyond the left side when rolling to the right\n    for (\n      let i = -width / 2 - gridConfig.size;\n      i > -calculate.subScrollX(width / scale / 2);\n      i -= gridConfig.size\n    ) {\n      this.plotVerticalLine(i)\n    }\n    // Draws the line beyond the right when rolling to the left\n    for (\n      let i = maxRight + gridConfig.size;\n      i < calculate.addScrollX(width / scale / 2);\n      i += gridConfig.size\n    ) {\n      this.plotVerticalLine(i)\n    }\n  }\n\n  // Rendering of horizontal lines\n  renderHorizontalLines() {\n    const { calculate, height, state } = this.app\n    const { gridConfig, scale } = state\n    if (\n      typeof gridConfig === 'undefined' ||\n      typeof scale === 'undefined' ||\n      typeof gridConfig.size === 'undefined'\n    ) {\n      return\n    }\n    let maxBottom = 0\n    for (let i = -height / 2; i < height / 2; i += gridConfig.size) {\n      this.plotHorizontalLine(i)\n      maxBottom = i\n    }\n    // Draws the line beyond the top when rolling downwards\n    for (\n      let i = -height / 2 - gridConfig.size;\n      i > -calculate.subScrollY(height / scale / 2);\n      i -= gridConfig.size\n    ) {\n      this.plotHorizontalLine(i)\n    }\n    // Draws the line beyond the bottom when rolling upwards\n    for (\n      let i = maxBottom + gridConfig.size;\n      i < calculate.addScrollY(height / scale / 2);\n      i += gridConfig.size\n    ) {\n      this.plotHorizontalLine(i)\n    }\n  }\n\n  renderGrid() {\n    this.canvas.clearCanvas()\n    const { gridConfig, scale, showGrid } = this.app.state\n    if (!showGrid) {\n      return\n    }\n    if (\n      this.ctx &&\n      scale &&\n      gridConfig &&\n      this.ctx.strokeStyle &&\n      this.ctx.lineWidth\n    ) {\n      this.ctx.save()\n      this.ctx.scale(scale, scale)\n      // @ts-ignore\n      this.ctx.strokeStyle = gridConfig.strokeStyle\n      // @ts-ignore\n      this.ctx.lineWidth = gridConfig.lineWidth\n    }\n\n    this.renderVerticalLines()\n\n    this.renderHorizontalLines()\n\n    this.ctx?.restore()\n  }\n\n  // Drawing horizontal lines\n  plotHorizontalLine(i: number) {\n    const { calculate, width, state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return\n    }\n    const _i = calculate.subScrollY(i)\n    this.ctx?.beginPath()\n    this.ctx?.moveTo(-width / state.scale / 2, _i)\n    this.ctx?.lineTo(width / state.scale / 2, _i)\n    this.ctx?.stroke()\n  }\n\n  // plot the reset line\n  plotVerticalLine(i: number) {\n    const { calculate, height, state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return\n    }\n    const _i = calculate.subScrollX(i)\n    this.ctx?.beginPath()\n    this.ctx?.moveTo(_i, -height / state.scale / 2)\n    this.ctx?.lineTo(_i, height / state.scale / 2)\n    this.ctx?.stroke()\n  }\n\n  showGrid() {\n    this.app.updateState({\n      showGrid: true\n    } as any)\n    this.renderGrid()\n  }\n\n  hideGrid() {\n    this.app.updateState({\n      showGrid: false\n    } as any)\n    this.canvas.clearCanvas()\n  }\n\n  updateGrid(config = {}) {\n    this.app.updateState({\n      gridConfig: {\n        ...this.app.state.gridConfig,\n        ...config\n      }\n    } as any)\n    if (this.app.state.showGrid) {\n      this.hideGrid()\n      this.showGrid()\n    }\n  }\n\n  init() {\n    if (this.canvas) {\n      this.app.mountEL.removeChild(this.canvas.el)\n    }\n    const { width, height } = this.app\n    this.canvas = new Canvas(width, height, {\n      className: 'grid'\n    })\n    this.ctx = this.canvas.ctx\n    this.app.mountEL.insertBefore(this.canvas.el, this.app.mountEL.children[0])\n  }\n}\n","import { deepCopy } from '../common/utils'\nimport { AppObject, LocalData } from '../types'\n\nexport default class History {\n  public app: AppObject\n\n  public historyStack: Array<LocalData>\n\n  public length: number\n\n  public index: number\n\n  public fixIndex: number\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.historyStack = []\n\n    this.length = 0\n\n    this.index = -1\n\n    this.fixIndex = -1\n  }\n\n  emitChange() {\n    this.app.emit('shuttle', this.index, this.length)\n  }\n\n  now() {\n    return this.historyStack[this.length - 1]\n  }\n\n  clear() {\n    this.index = -1\n    this.length = 0\n    this.historyStack = []\n    this.emitChange()\n  }\n\n  add(data: LocalData) {\n    const prev = this.length > 0 ? this.historyStack[this.length - 1] : null\n    const copyData = deepCopy(data)\n    if (copyData === prev) {\n      return\n    }\n    this.historyStack.push(copyData)\n    this.length += 1\n    this.index = this.length - 1\n    this.emitChange()\n  }\n\n  shuttle() {\n    const oldData = this.app.getData()\n    const data = this.historyStack[this.index]\n    // Avoid interference and enforce correction\n    this.fixIndex = this.index\n    const fixLength = this.length\n    this.app\n      .setData(data, true)\n      .then(() => {\n        this.index = this.fixIndex\n        this.length = fixLength\n        this.emitChange()\n        this.app.emit('change', data)\n        this.app.emitDiffNodesChange(oldData, data)\n        this.app.emitDiffStateChange(oldData, data)\n      })\n      .catch(() => {\n        // eslint-disable-next-line no-console\n        console.error('History shuttle setData error')\n      })\n  }\n\n  undo() {\n    if (this.index <= 0) {\n      return\n    }\n    this.index -= 1\n    this.shuttle()\n  }\n\n  redo() {\n    if (this.index >= this.length - 1) {\n      return\n    }\n    this.index += 1\n    this.shuttle()\n  }\n}\n","import EventEmitter from 'eventemitter3'\n\nimport { AppObject } from '../types'\n\nexport default class ImageEdit extends EventEmitter {\n  public app: AppObject\n\n  public el: HTMLInputElement | null\n\n  isReady: boolean\n\n  public previewEl: HTMLDivElement | null\n\n  public imageData: {\n    url: string\n    width: number\n    height: number\n    ratio: number\n    imageObj: HTMLInputElement\n  } | null\n\n  public maxWidth: number\n\n  public maxHeight: number\n\n  public maxRatio: number\n\n  constructor(app: AppObject) {\n    super()\n\n    this.app = app\n\n    this.el = null\n\n    this.isReady = false\n\n    this.previewEl = null\n\n    this.imageData = null\n\n    this.maxWidth = 750\n\n    this.maxHeight = 450\n\n    this.maxRatio = this.maxWidth / this.maxHeight\n\n    this.onImageSelectChange = this.onImageSelectChange.bind(this)\n  }\n\n  updatePreviewElPos(x: number, y: number) {\n    const width = 100\n    if (!this.imageData) {\n      // eslint-disable-next-line no-console\n      console.error('imageData is null')\n      return\n    }\n    const height = width / this.imageData.ratio\n    if (!this.previewEl) {\n      this.previewEl = document.createElement('div')\n      this.previewEl.style.position = 'fixed'\n      this.previewEl.style.width = `${width}px`\n      this.previewEl.style.height = `${height}px`\n      this.previewEl.style.backgroundImage = `url('${this.imageData.url}')`\n      this.previewEl.style.backgroundSize = 'cover'\n      this.previewEl.style.pointerEvents = 'none'\n      document.body.appendChild(this.previewEl)\n    }\n    const tp = this.app.calculate.mountELToWindow(x, y)\n    this.previewEl.style.left = `${tp.x - width / 2}px`\n    this.previewEl.style.top = `${tp.y - height / 2}px`\n  }\n\n  reset() {\n    if (this.el) {\n      this.el.value = ''\n    }\n    this.isReady = false\n    if (this.previewEl) {\n      document.body.removeChild(this.previewEl)\n    }\n    this.previewEl = null\n    this.imageData = null\n  }\n\n  async getImageUrl(file: Blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        resolve(reader.result)\n      }\n      reader.onerror = () => {\n        reject()\n      }\n      reader.readAsDataURL(file)\n    })\n  }\n\n  async getImageSize(url: string): Promise<{\n    imageObj: HTMLInputElement\n    size: {\n      width: number\n      height: number\n    }\n    ratio: number\n  }> {\n    return new Promise((resolve, reject) => {\n      const img = new Image()\n      img.setAttribute('crossOrigin', 'anonymous')\n      img.onload = () => {\n        let { width } = img\n        let { height } = img\n        const ratio = img.width / img.height\n        if (img.width > this.maxWidth || img.height > this.maxHeight) {\n          if (ratio > this.maxRatio) {\n            width = this.maxWidth\n            height = this.maxWidth / ratio\n          } else {\n            height = this.maxHeight\n            width = this.maxHeight * ratio\n          }\n        }\n        resolve({\n          imageObj: img,\n          size: {\n            width,\n            height\n          },\n          ratio\n        } as any)\n      }\n      img.onerror = () => {\n        reject()\n      }\n      img.src = url\n    })\n  }\n\n  async onImageSelectChange(e: any) {\n    const url = await this.getImageUrl(e.target.files[0])\n    if (typeof url !== 'string') {\n      // eslint-disable-next-line no-console\n      console.error('url is not string')\n      return\n    }\n    const { imageObj, size, ratio } = await this.getImageSize(url)\n    this.isReady = true\n    this.imageData = {\n      url,\n      ...size,\n      ratio,\n      imageObj\n    }\n    this.emit('imageSelectChange', this.imageData)\n  }\n\n  selectImage() {\n    if (!this.el) {\n      this.el = document.createElement('input')\n      this.el.style.position = 'fixed'\n      this.el.style.left = '-9999999px'\n      this.el.type = 'file'\n      this.el.accept = 'image/*'\n      this.el.addEventListener('change', this.onImageSelectChange)\n      document.body.appendChild(this.el)\n    }\n    this.el.click()\n  }\n}\n","import { keyPosit } from '../common/constants'\nimport { AppObject, KeyPosit } from '../types'\n\nexport default class KeyCommand {\n  public app: AppObject\n\n  public keyPosit: KeyPosit\n\n  public shortcutMap: any\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.keyPosit = keyPosit\n\n    this.shortcutMap = {}\n\n    this.bindEvent()\n  }\n\n  // Get the array of key values corresponding to the shortcut keys\n  getKeyCodeArr(key: string) {\n    key = key.replace(/\\+\\+/, '+add')\n    const keyArr = key\n      .split(/\\s*\\+\\s*/)\n      .map((item) => (item === 'add' ? '+' : item))\n    const arr: any[] = []\n    keyArr.forEach((item) => {\n      // @ts-ignore\n      arr.push(keyPosit[item])\n    })\n    return arr\n  }\n\n  // Get an array of key values in an event object\n  getOriginEventCodeArr(e: {\n    stopPropagation?: () => void\n    preventDefault?: () => void\n    ctrlKey?: any\n    metaKey?: any\n    altKey?: any\n    shiftKey?: any\n    keyCode?: any\n  }) {\n    const arr = []\n    if (e.ctrlKey || e.metaKey) {\n      arr.push(keyPosit.Control)\n    }\n    if (e.altKey) {\n      arr.push(keyPosit.Alt)\n    }\n    if (e.shiftKey) {\n      arr.push(keyPosit.Shift)\n    }\n    if (!arr.includes(e.keyCode)) {\n      arr.push(e.keyCode)\n    }\n    return arr\n  }\n\n  // Check if the key value matches\n  checkKey(\n    e: { stopPropagation: () => void; preventDefault: () => void },\n    key: string\n  ) {\n    const o = this.getOriginEventCodeArr(e)\n    const k = this.getKeyCodeArr(key)\n    if (o.length !== k.length) {\n      return false\n    }\n    for (let i = 0; i < o.length; i += 1) {\n      const index = k.findIndex((item) => item === o[i])\n      if (index === -1) {\n        return false\n      }\n      k.splice(index, 1)\n    }\n    return true\n  }\n\n  onKeydown(e: { stopPropagation: () => void; preventDefault: () => void }) {\n    Object.keys(this.shortcutMap).forEach((key) => {\n      if (this.checkKey(e, key)) {\n        e.stopPropagation()\n        e.preventDefault()\n        this.shortcutMap[key].forEach(\n          (f: { fn: { call: (arg0: any) => void }; ctx: any }) => {\n            f.fn.call(f.ctx)\n          }\n        )\n      }\n    })\n  }\n\n  // Add shortcut command\n  addShortcut(key: string, fn: any, ctx?: any) {\n    key.split(/\\s*\\|\\s*/).forEach((item) => {\n      if (this.shortcutMap[item]) {\n        this.shortcutMap[item].push({\n          fn,\n          ctx\n        })\n      } else {\n        this.shortcutMap[item] = [\n          {\n            fn,\n            ctx\n          }\n        ]\n      }\n    })\n  }\n\n  // Remove shortcut command\n  removeShortcut(key: string, fn: any) {\n    key.split(/\\s*\\|\\s*/).forEach((item) => {\n      if (this.shortcutMap[item]) {\n        if (fn) {\n          const index = this.shortcutMap[item].findIndex(\n            (f: { fn: any }) => f.fn === fn\n          )\n          if (index !== -1) {\n            this.shortcutMap[item].splice(index, 1)\n          }\n        } else {\n          this.shortcutMap[item] = []\n          delete this.shortcutMap[item]\n        }\n      }\n    })\n  }\n\n  bindEvent() {\n    this.app.event.on('keydown', this.onKeydown, this)\n  }\n\n  unBindEvent() {\n    this.app.event.off('keydown', this.onKeydown)\n  }\n}\n","import { Node } from '../../types'\nimport { CLICK_DISTANCE } from '../constants'\nimport {\n  checkCoordinateIsInRectangle,\n  checkIsAtSegment,\n  getTowCoordinateDistance\n} from './index'\n\ntype Segments = Array<[x1: number, y1: number, x2: number, y2: number]>\ntype Rp = { xs?: number; ys?: number; x: number; y: number }\n\n// Detects if a click is inside a rectangle\nexport const checkIsAtRectangleInner = (node: any, rp: Rp) =>\n  checkCoordinateIsInRectangle(rp.x, rp.y, node as Node) ? node : null\n\n// Calculate the radius of the circle from the width and height\nexport const getCircleRadius = (width: number, height: number) =>\n  Math.min(Math.abs(width), Math.abs(height)) / 2\n\n// Detects if a click is made on the fold\nexport const checkIsAtMultiplexSegment = (segments: Segments, rp: Rp) => {\n  let res = false\n  segments.forEach((seg) => {\n    if (res) return\n    if (checkIsAtSegment(rp.x, rp.y, ...seg, CLICK_DISTANCE)) {\n      res = true\n    }\n  })\n  return res\n}\n\n// Calculate the radius of the circle from the width and height\nexport const checkIsAtCircleEdge = (node: any, rp: Rp) => {\n  const { width, height, x, y } = node as Node\n  const radius = getCircleRadius(width, height)\n  const dis = getTowCoordinateDistance(rp.x, rp.y, x + radius, y + radius)\n  const onCircle =\n    dis >= radius - CLICK_DISTANCE && dis <= radius + CLICK_DISTANCE\n  return onCircle ? node : null\n}\n\n// Detects if you click on the edge of a rectangle\nexport const checkIsAtRectangleEdge = (node: any, rp: Rp) => {\n  const { x, y, width, height } = node as Node\n  const segments: Segments = [\n    [x, y, x + width, y],\n    [x + width, y, x + width, y + height],\n    [x + width, y + height, x, y + height],\n    [x, y + height, x, y]\n  ]\n  return checkIsAtMultiplexSegment(segments, rp) ? node : null\n}\n\n// Detects if a triangle edge is clicked on\nexport const checkIsAtTriangleEdge = (node: Node, rp: Rp) => {\n  const { x, y, width, height } = node\n  const segments = [\n    [x + width / 2, y, x + width, y + height],\n    [x + width, y + height, x, y + height],\n    [x, y + height, x + width / 2, y]\n  ]\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n\n// Detects if a diamond edge is clicked on\nexport const checkIsAtDiamondEdge = (node: any, rp: Rp) => {\n  const { x, y, width, height } = node as Node\n  const segments = [\n    [x + width / 2, y, x + width, y + height / 2],\n    [x + width, y + height / 2, x + width / 2, y + height],\n    [x + width / 2, y + height, x, y + height / 2],\n    [x, y + height / 2, x + width / 2, y]\n  ]\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n\n// Detects if you click on the edge of the arrow\nexport const checkIsAtArrowEdge = (node: any, rp: Rp) => {\n  const { coordinateArr } = node as Node\n  if (typeof coordinateArr === 'undefined') {\n    return null\n  }\n  const x = coordinateArr[0][0]\n  const y = coordinateArr[0][1]\n  const tx = coordinateArr[coordinateArr.length - 1][0]\n  const ty = coordinateArr[coordinateArr.length - 1][1]\n  const segments = [[x, y, tx, ty]]\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n\n// Detects if a click is made on the edge of a free line segment\nexport const checkIsAtArbitraryPlotLineEdge = (node: Node, rp: Rp) => {\n  let res: Node | null = null\n  if (typeof node.coordinateArr === 'undefined') {\n    return null\n  }\n  node.coordinateArr.forEach((coordinate) => {\n    if (res) return\n    const dis = getTowCoordinateDistance(\n      rp.x,\n      rp.y,\n      coordinate[0],\n      coordinate[1]\n    )\n    if (dis <= CLICK_DISTANCE) {\n      res = node\n    }\n  })\n  return res\n}\n\n// Detects if a click is made on the edge of a line segment\nexport const checkIsAtLineEdge = (node: Node, rp: Rp) => {\n  const segments = []\n  if (typeof node.coordinateArr === 'undefined') {\n    return null\n  }\n  const len = node.coordinateArr.length\n  const arr = node.coordinateArr\n  for (let i = 0; i < len - 1; i += 1) {\n    segments.push([...arr[i], ...arr[i + 1]])\n  }\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n","import EventEmitter from 'eventemitter3'\n\nimport {\n  createNodeKey,\n  degToRad,\n  getNodeFourCorners,\n  getRotatedCoordinate\n} from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class BaseNode extends EventEmitter {\n  public app: AppObject\n\n  public id: string\n\n  public type: string\n\n  public key: number\n\n  public isCreate: boolean\n\n  public isActive: boolean\n\n  public isSelected: boolean\n\n  public startX: number\n\n  public startY: number\n\n  x: number\n\n  y: number\n\n  width: number\n\n  height: number\n\n  public startRotate: number\n\n  public rotate: number\n\n  public noRender: boolean\n\n  public style: any\n\n  dragNode: any\n\n  constructor(options: any, app: AppObject) {\n    super()\n    this.app = app\n    // Graphical object id\n    this.id = options.id\n    // Type\n    this.type = options.type || ''\n    // key\n    this.key = createNodeKey()\n    // Is it being created\n    this.isCreate = true\n    // Activated or not\n    this.isActive = true\n    // Whether selected by multiple choice\n    this.isSelected = false\n    // Record initial position for use when dragging\n    this.startX = 0\n    this.startY = 0\n    // Real-time position, which is the coordinate of the upper left corner of the graphic object\n    this.x = options.x || 0\n    this.y = options.y || 0\n    // Width and height\n    this.width = options.width || 0\n    this.height = options.height || 0\n    // Records the initial angle for use when rotating\n    this.startRotate = 0\n    // Angle\n    this.rotate = options.rotate || 0\n    // Does not need to be rendered\n    this.noRender = false\n    // style\n    this.style = {\n      strokeStyle: this.app.state.defaultColor,\n      fillStyle: 'transparent',\n      lineWidth: 2,\n      lineDash: 0,\n      globalAlpha: 1,\n      ...(options.style || {})\n    }\n    // Example of dragging and dropping a graphic object\n    this.dragNode = undefined\n  }\n\n  // Detects if a graphic object has been hit\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  isClick(x: number, y: number) {\n    throw new Error('Subclasses need to implement this method!')\n  }\n\n  // Offsetting the angle of a graphic object\n  offsetRotate(or: number) {\n    this.updateRotate(this.startRotate + or)\n    return this\n  }\n\n  // Setting the drawing style\n  setStyle(style = {}) {\n    const _style = style as any\n    Object.keys(_style).forEach((key) => {\n      if (key === 'lineDash') {\n        if (_style.lineDash > 0) {\n          this.app.ctx.setLineDash([_style.lineDash])\n        }\n      } else if (\n        _style[key] !== undefined &&\n        _style[key] !== '' &&\n        _style[key] !== null\n      ) {\n        // @ts-ignore\n        this.app.ctx[key] = _style[key]\n      }\n    })\n    return this\n  }\n\n  // Public rendering operations\n  warpRender(renderFn: any) {\n    const { x, y, width, height, rotate, style } = this\n    const { x: tx, y: ty } = this.app.calculate.transform(x, y)\n    const halfWidth = width / 2\n    const halfHeight = height / 2\n    const cx = tx + halfWidth\n    const cy = ty + halfHeight\n    this.app.ctx.save()\n    this.app.ctx.translate(cx, cy)\n    this.app.ctx.rotate(degToRad(rotate))\n    this.setStyle(style)\n    renderFn({\n      halfWidth,\n      halfHeight,\n      tx,\n      ty,\n      cx,\n      cy\n    })\n    this.app.ctx.restore()\n    return this\n  }\n\n  // Save the initial state of the graphic object\n  saveState() {\n    const { rotate, x, y } = this\n    this.startRotate = rotate\n    this.startX = x\n    this.startY = y\n    return this\n  }\n\n  // Moving graphic objects\n  move(ox: number, oy: number) {\n    const { startX, startY } = this\n    this.x = startX + ox\n    this.y = startY + oy\n    this.emit('nodePositionChange', this.x, this.y)\n    return this\n  }\n\n  // Updating the angle of a graphic object\n  updateRotate(rotate: number) {\n    rotate %= 360\n    if (rotate < 0) {\n      rotate = 360 + rotate\n    }\n    this.rotate = rotate\n    this.app.emitNodeRotateChange(this.rotate)\n  }\n\n  // Rotate the individual coordinates of a graphic object according to the specified centre coordinates\n  rotateByCenter(rotate: number, cx: number, cy: number) {\n    this.offsetRotate(rotate)\n    const np = getRotatedCoordinate(this.startX, this.startY, cx, cy, rotate)\n    this.updatePos(np.x, np.y)\n  }\n\n  // Start adjusting graphic objects\n  startResize(resizeType: string, e: any) {\n    this.dragNode.startResize(resizeType, e)\n    return this\n  }\n\n  // Ending the adjustment of graphic objects\n  endResize() {\n    this.dragNode.endResize()\n    return this\n  }\n\n  // Adjustment in graphic objects\n  resize(...args: any[]) {\n    this.dragNode.handleResizeNode(...args)\n    return this\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    return getNodeFourCorners(this as any)\n  }\n\n  // Update graphic object enclosures\n  updateRect(x: number, y: number, width: number, height: number) {\n    this.updatePos(x, y)\n    this.updateSize(width, height)\n    return this\n  }\n\n  // Update activation of graphic object sizes\n  updateSize(width: number, height: number) {\n    this.width = width\n    this.height = height\n    this.emit('nodeSizeChange', this.width, this.height)\n    return this\n  }\n\n  // Update coordinates of active graphic objects\n  updatePos(x: number, y: number) {\n    this.x = x\n    this.y = y\n    this.emit('nodePositionChange', this.x, this.y)\n    return this\n  }\n\n  // Serialisation\n  serialize() {\n    return {\n      id: this.id,\n      type: this.type,\n      width: this.width,\n      height: this.height,\n      x: this.x,\n      y: this.y,\n      rotate: this.rotate,\n      style: {\n        ...this.style\n      }\n    }\n  }\n\n  // Rendering drag-and-drop graphic objects\n  renderDragNode() {\n    if (this.isActive && !this.isCreate) {\n      this.dragNode.showAll()\n      this.dragNode.render()\n    } else if (this.isSelected) {\n      // Selected by multiple choice\n      this.dragNode.onlyShowBody()\n      this.dragNode.render()\n    }\n  }\n\n  // Rendering methods, which need to be implemented\n  render() {\n    throw new Error('Subclasses need to implement this method！')\n  }\n}\n","import {\n  deepCopy,\n  getBoundingRect,\n  getNodeCenterCoordinate,\n  getRotatedCoordinate\n} from '../common/utils'\nimport { AppObject } from '../types'\nimport BaseNode from './BaseNode'\n\nexport default class BaseMultiplexCoordinateNode extends BaseNode {\n  public startCoordinateArr: any[]\n\n  public coordinateArr: any\n\n  public startWidth: number | undefined\n\n  public startHeight: number | undefined\n\n  public fictitiousCoordinate: { x: number; y: number }\n\n  constructor(opts: any, app: AppObject) {\n    super(opts, app)\n    // Record initial coordinates when dragging\n    this.startCoordinateArr = []\n    // Coordinates\n    this.coordinateArr = opts.coordinateArr || []\n    // Record initial size for use when scaling\n    this.startWidth = 0\n    this.startHeight = 0\n    // The current live position of the mouse, used to display the virtual line from the last coordinate of the line segment to the current mouse when drawing\n    this.fictitiousCoordinate = {\n      x: 0,\n      y: 0\n    }\n  }\n\n  // Update graphic object enclosures\n  updateRect(x: number, y: number, width: number, height: number) {\n    const { startWidth, startHeight, startCoordinateArr } = this\n    if (\n      typeof startWidth === 'undefined' ||\n      typeof startHeight === 'undefined'\n    ) {\n      return this\n    }\n    const scaleX = width / startWidth\n    const scaleY = height / startHeight\n    this.coordinateArr = startCoordinateArr.map((coordinate) => {\n      const nx = coordinate[0] * scaleX\n      const ny = coordinate[1] * scaleY\n      return [nx, ny, ...coordinate.slice(2)]\n    })\n    const rect: any = getBoundingRect(this.coordinateArr)\n    const offsetX = rect.x - x\n    const offsetY = rect.y - y\n    this.coordinateArr = this.coordinateArr.map(\n      (coordinate: string | any[]) => [\n        coordinate[0] - offsetX,\n        coordinate[1] - offsetY,\n        ...coordinate.slice(2)\n      ]\n    )\n    this.updatePos(x, y)\n    this.updateSize(width, height)\n    return this\n  }\n\n  // Rotate the individual coordinates of a graphic object according to the specified centre coordinates\n  rotateByCenter(rotate: number, cx: number, cy: number) {\n    this.coordinateArr = this.startCoordinateArr.map((coordinate) => {\n      const np = getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        cx,\n        cy,\n        rotate\n      )\n      return [np.x, np.y, ...coordinate.slice(2)]\n    })\n    this.updateMultiplexCoordinateBoundingRect()\n  }\n\n  // Serialisation\n  serialize() {\n    const base = super.serialize()\n    return {\n      ...base,\n      coordinateArr: [...this.coordinateArr]\n    }\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    return this.coordinateArr.map((coordinate: number[]) => {\n      const center = getNodeCenterCoordinate(this as any)\n      const np = getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        center.x,\n        center.y,\n        this.rotate as number\n      )\n      return {\n        x: np.x,\n        y: np.y\n      }\n    })\n  }\n\n  // Adding coordinates, graphs with multiple coordinate data, e.g. line segments, free lines\n  addCoordinate(x: number, y: number, ...args: any[]) {\n    if (!Array.isArray(this.coordinateArr)) {\n      return undefined\n    }\n    this.coordinateArr.push([x, y, ...args])\n    return this\n  }\n\n  // Update of graphical object enclosures for graphs with multiple coordinate data\n  updateMultiplexCoordinateBoundingRect() {\n    const rect: any = getBoundingRect(this.coordinateArr)\n    this.x = rect.x\n    this.y = rect.y\n    this.width = rect.width\n    this.height = rect.height\n    return this\n  }\n\n  // Update virtual coordinates coordinates\n  updateFictitiousCoordinate(x: number, y: number) {\n    this.fictitiousCoordinate.x = x\n    this.fictitiousCoordinate.y = y\n  }\n\n  // Moving graphic objects\n  move(ox: number, oy: number) {\n    this.coordinateArr = this.startCoordinateArr.map((coordinate) => [\n      coordinate[0] + ox,\n      coordinate[1] + oy,\n      ...coordinate.slice(2)\n    ])\n    const { startX, startY } = this\n    if (startX && startY) {\n      this.x = startX + ox\n      this.y = startY + oy\n    }\n    return this\n  }\n\n  // Save the initial state of the graphic object\n  saveState() {\n    const { rotate, x, y, width, height, coordinateArr } = this\n    this.startRotate = rotate\n    this.startX = x\n    this.startY = y\n    this.startCoordinateArr = deepCopy(coordinateArr)\n    this.startWidth = width\n    this.startHeight = height\n    return this\n  }\n}\n","import {\n  degToRad,\n  getFontString,\n  radToDeg,\n  splitTextLines\n} from '../common/utils'\nimport { Ctx } from '../types'\n\n// Drawing public operations\nexport const plotWrap = (ctx: Ctx, fn: any, fill = false) => {\n  ctx.beginPath()\n  fn()\n  ctx.stroke()\n  if (fill) {\n    ctx.fill()\n  }\n}\n\n// Drawing circle\nexport const plotCircle = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  r: number,\n  fill = false\n) => {\n  plotWrap(\n    ctx,\n    () => {\n      ctx.arc(x, y, r, 0, 2 * Math.PI)\n    },\n    fill\n  )\n}\n\n// Drawing arrows\nexport const plotArrow = (ctx: Ctx, coordinateArr: any[]) => {\n  const x = coordinateArr[0][0]\n  const y = coordinateArr[0][1]\n  const tx = coordinateArr[coordinateArr.length - 1][0]\n  const ty = coordinateArr[coordinateArr.length - 1][1]\n  plotWrap(\n    ctx,\n    () => {\n      ctx.moveTo(x, y)\n      ctx.lineTo(tx, ty)\n    },\n    true\n  )\n  const l = 30\n  const deg = 30\n  const lineDeg = radToDeg(Math.atan2(ty - y, tx - x))\n  plotWrap(\n    ctx,\n    () => {\n      const plusDeg = deg - lineDeg\n      const _x = tx - l * Math.cos(degToRad(plusDeg))\n      const _y = ty + l * Math.sin(degToRad(plusDeg))\n      ctx.moveTo(_x, _y)\n      ctx.lineTo(tx, ty)\n    },\n    true\n  )\n  plotWrap(ctx, () => {\n    const plusDeg = 90 - lineDeg - deg\n    const _x = tx - l * Math.sin(degToRad(plusDeg))\n    const _y = ty - l * Math.cos(degToRad(plusDeg))\n    ctx.moveTo(_x, _y)\n    ctx.lineTo(tx, ty)\n  })\n}\n\n// Drawing rectangles\nexport const plotRect = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  fill = false\n) => {\n  plotWrap(ctx, () => {\n    ctx.rect(x, y, width, height)\n    if (fill) {\n      ctx.fillRect(x, y, width, height)\n    }\n  })\n}\n\n// Drawing a diamond\nexport const plotDiamond = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  fill = false\n) => {\n  plotWrap(\n    ctx,\n    () => {\n      ctx.moveTo(x + width / 2, y)\n      ctx.lineTo(x + width, y + height / 2)\n      ctx.lineTo(x + width / 2, y + height)\n      ctx.lineTo(x, y + height / 2)\n      ctx.closePath()\n    },\n    fill\n  )\n}\n\n// Convert the coordinates of the brush to the coordinates of the canvas\nconst transformArbitraryLineCoordinate = (\n  coordinate: string | any[],\n  opt: {\n    app: {\n      calculate: { transform: (arg0: any, arg1: any) => { x: any; y: any } }\n    }\n    cx: number\n    cy: number\n  }\n) => {\n  const { x, y } = opt.app.calculate.transform(coordinate[0], coordinate[1])\n  return [x - opt.cx, y - opt.cy, ...coordinate.slice(2)]\n}\n\n// Drawing line segments\nexport const plotLineSegment = (\n  ctx: Ctx,\n  mx: number,\n  my: number,\n  tx: number,\n  ty: number,\n  lineWidth = 0\n) => {\n  plotWrap(ctx, () => {\n    if (lineWidth > 0) {\n      ctx.lineWidth = lineWidth\n    }\n    ctx.moveTo(mx, my)\n    ctx.lineTo(tx, ty)\n    ctx.lineCap = 'round'\n    ctx.lineJoin = 'round'\n  })\n}\n\n// Drawing triangles\nexport const plotTriangle = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  width: number,\n  height: any,\n  fill = false\n) => {\n  plotWrap(\n    ctx,\n    () => {\n      ctx.moveTo(x + width / 2, y)\n      ctx.lineTo(x + width, y + height)\n      ctx.lineTo(x, y + height)\n      ctx.closePath()\n    },\n    fill\n  )\n}\n\n// Drawing free line segments (Also known as a paintbrush)\nexport const plotArbitraryLine = (\n  ctx: Ctx,\n  coordinates: string | any[],\n  opt: any\n) => {\n  for (let i = 0; i < coordinates.length - 1; i += 1) {\n    plotWrap(\n      ctx,\n      () => {\n        const coordinate = transformArbitraryLineCoordinate(coordinates[i], opt)\n        const nextCoordinate = transformArbitraryLineCoordinate(\n          coordinates[i + 1],\n          opt\n        )\n        plotLineSegment(\n          ctx,\n          coordinate[0],\n          coordinate[1],\n          nextCoordinate[0],\n          nextCoordinate[1],\n          nextCoordinate[2]\n        )\n      },\n      true\n    )\n  }\n}\n\n// Drawing text\nexport const plotText = (ctx: Ctx, textObj: any, x: number, y: number) => {\n  const { text, style } = textObj\n  const lineHeight = style.fontSize * style.lineHeightRatio\n  plotWrap(ctx, () => {\n    ctx.font = getFontString(style.fontSize, style.fontFamily)\n    ctx.textBaseline = 'middle'\n    const textArr = splitTextLines(text)\n    textArr.forEach((textRow, index) => {\n      ctx.fillText(textRow, x, y + (index * lineHeight + lineHeight / 2))\n    })\n  })\n}\n\n// Drawing pictures\nexport const plotImage = (\n  ctx: Ctx,\n  node: any,\n  x: number,\n  y: number,\n  width: number,\n  height: number\n) => {\n  plotWrap(ctx, () => {\n    const ratio = width / height\n    let showWidth = 0\n    let showHeight = 0\n    if (ratio > node.ratio) {\n      showHeight = height\n      showWidth = node.ratio * height\n    } else {\n      showWidth = width\n      showHeight = width / node.ratio\n    }\n    ctx.drawImage(node.imageObj, x, y, showWidth, showHeight)\n  })\n}\n\n// Draw the line\nexport const plotLine = (ctx: Ctx, coordinates: any[]) => {\n  plotWrap(ctx, () => {\n    let first = true\n    coordinates.forEach((coordinate) => {\n      if (first) {\n        first = false\n        ctx.moveTo(coordinate[0], coordinate[1])\n      } else {\n        ctx.lineTo(coordinate[0], coordinate[1])\n      }\n    })\n  })\n}\n","import { DRAG_NODE_PARTS, FOUR_CORNER } from '../common/constants'\nimport {\n  checkCoordinateIsInRectangle,\n  getNodeCenterCoordinate,\n  getNodeRotatedFourCornerCoordinate,\n  getRotatedCoordinate,\n  getTowCoordinateDistance,\n  getTowCoordinateRotate,\n  transformCoordinateOnNode,\n  transformCoordinateReverseRotate\n} from '../common/utils'\nimport { AppObject, Node } from '../types'\nimport BaseNode from './BaseNode'\nimport { plotCircle, plotRect } from './plot'\n\nexport default class DragNode extends BaseNode {\n  public options: Node\n\n  public node: any\n\n  public offset: number\n\n  public size: number\n\n  public resizeType: string\n\n  public diagonalCoordinate: { x: number; y: number }\n\n  public mousedownPosAndNodePosOffset: { x: number; y: number }\n\n  public nodeRatio: number\n\n  public hideParts: any[]\n\n  constructor(node: any, app: AppObject, options = {}) {\n    super(\n      {\n        type: 'dragNode',\n        notNeedDragNode: true\n      },\n      app\n    )\n\n    // @ts-ignore\n    this.options = {\n      lockRatio: false,\n      ...options\n    }\n\n    this.style = {\n      strokeStyle: '#666',\n      fillStyle: 'transparent',\n      lineWidth: 'small',\n      lineDash: 0,\n      globalAlpha: 1\n    }\n\n    // Attribution Nodes\n    this.node = node\n\n    // Distance to graphic objects\n    this.offset = 5\n\n    // Drag handle size\n    this.size = 10\n\n    // What adjustment operation is currently in progress\n    this.resizeType = ''\n\n    // Diagonal coordinates of the coordinates of the graphical object currently dragged with the mouse held down\n    this.diagonalCoordinate = {\n      x: 0,\n      y: 0\n    }\n\n    // The difference between the coordinates of the current mouse press and the coordinates of the dragged graphic object\n    this.mousedownPosAndNodePosOffset = {\n      x: 0,\n      y: 0\n    }\n\n    // Aspect ratio of graphical objects\n    this.nodeRatio = 0\n\n    // The hidden part\n    this.hideParts = []\n\n    this.x = 0\n    this.y = 0\n  }\n\n  // Start adjusting graphic objects\n  // @ts-ignore\n  startResize(resizeType: string, e: any) {\n    this.resizeType = resizeType\n    if (this.options.lockRatio) {\n      this.nodeRatio = this.node.width / this.node.height\n    }\n    if (resizeType === DRAG_NODE_PARTS.BODY) {\n      this.node.saveState()\n    } else if (resizeType === DRAG_NODE_PARTS.ROTATE) {\n      this.node.saveState()\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_LEFT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.TOP_LEFT)\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_RIGHT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.TOP_RIGHT)\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.BOTTOM_RIGHT)\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.BOTTOM_LEFT)\n    }\n  }\n\n  // Ending the adjustment of graphic objects\n  // @ts-ignore\n  endResize() {\n    this.resizeType = ''\n    this.diagonalCoordinate = {\n      x: 0,\n      y: 0\n    }\n    this.mousedownPosAndNodePosOffset = {\n      x: 0,\n      y: 0\n    }\n    this.nodeRatio = 0\n  }\n\n  // Handling of four retractable handle events for dragging graphic objects by pressing\n  handleDragMousedown(e: { clientX: number; clientY: number }, corner: string) {\n    const centerPos = getNodeCenterCoordinate(this.node)\n    const pos: any = getNodeRotatedFourCornerCoordinate(this.node, corner)\n    this.diagonalCoordinate.x = 2 * centerPos.x - pos.x\n    this.diagonalCoordinate.y = 2 * centerPos.y - pos.y\n    this.mousedownPosAndNodePosOffset.x = e.clientX - pos.x\n    this.mousedownPosAndNodePosOffset.y = e.clientY - pos.y\n    this.node.saveState()\n  }\n\n  // Adjusting graphic objects\n  handleResizeNode(\n    e: any,\n    mx: number,\n    my: number,\n    offsetX: number,\n    offsetY: number\n  ) {\n    const { resizeType } = this\n    if (resizeType === DRAG_NODE_PARTS.BODY) {\n      this.handleMoveNode(offsetX, offsetY)\n    } else if (resizeType === DRAG_NODE_PARTS.ROTATE) {\n      this.handleRotateNode(e, mx, my)\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_LEFT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (newCenter.x - rp.x) * 2,\n          height: (newCenter.y - rp.y) * 2\n        }),\n        (rp: { x: any; y: any }) => ({\n          x: rp.x,\n          y: rp.y\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; width?: any; height?: any; y?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + newRect.width - this.nodeRatio * newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            y = newRect.y + (newRect.height - newRect.width / this.nodeRatio)\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_RIGHT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (rp.x - newCenter.x) * 2,\n          height: (newCenter.y - rp.y) * 2\n        }),\n        (rp: { x: number; y: any }, newSize: { width: number }) => ({\n          x: rp.x - newSize.width,\n          y: rp.y\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; height?: any; width?: any; y?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + this.nodeRatio * newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            x = newRect.x + newRect.width\n            y = newRect.y + (newRect.height - newRect.width / this.nodeRatio)\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (rp.x - newCenter.x) * 2,\n          height: (rp.y - newCenter.y) * 2\n        }),\n        (\n          rp: { x: number; y: number },\n          newSize: { width: number; height: number }\n        ) => ({\n          x: rp.x - newSize.width,\n          y: rp.y - newSize.height\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; height?: any; y?: any; width?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + this.nodeRatio * newRect.height\n            y = newRect.y + newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            x = newRect.x + newRect.width\n            y = newRect.y + newRect.width / this.nodeRatio\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (newCenter.x - rp.x) * 2,\n          height: (rp.y - newCenter.y) * 2\n        }),\n        (rp: { x: number; y: number }, newSize: { height: number }) => ({\n          x: rp.x,\n          y: rp.y - newSize.height\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; width?: any; height?: any; y?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + newRect.width - this.nodeRatio * newRect.height\n            y = newRect.y + newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            y = newRect.y + newRect.width / this.nodeRatio\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    }\n  }\n\n  // Move the graphic object as a whole\n  handleMoveNode(offsetX: number, offsetY: number) {\n    this.node.move(offsetX, offsetY)\n  }\n\n  // Rotating graphic objects\n  handleRotateNode(\n    e: { clientX: number; clientY: number },\n    mx: number,\n    my: number\n  ) {\n    const centerPos = getNodeCenterCoordinate(this.node)\n    const rotate = getTowCoordinateRotate(\n      centerPos.x,\n      centerPos.y,\n      e.clientX,\n      e.clientY,\n      mx,\n      my\n    )\n    this.node.offsetRotate(rotate)\n  }\n\n  // Set the hidden section\n  setHideParts(parts = []) {\n    this.hideParts = parts\n  }\n\n  // Show all sections\n  showAll() {\n    this.setHideParts([])\n  }\n\n  // Only the main part is displayed\n  onlyShowBody() {\n    this.setHideParts([\n      DRAG_NODE_PARTS.ROTATE,\n      DRAG_NODE_PARTS.TOP_LEFT_BUTTON,\n      DRAG_NODE_PARTS.TOP_RIGHT_BUTTON,\n      DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON,\n      DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON\n    ] as any)\n  }\n\n  // Update data\n  update() {\n    this.x = this.node.x - this.offset\n    this.y = this.node.y - this.offset\n    this.width = this.node.width + this.offset * 2\n    this.height = this.node.height + this.offset * 2\n    this.rotate = this.node.rotate\n  }\n\n  // Scaling calculations\n  stretchCalc(\n    x: number,\n    y: number,\n    calcSize: (\n      arg0: { x: number; y: number },\n      arg1: { x: number; y: number }\n    ) => any,\n    calcPos: (arg0: { x: number; y: number }, arg1: any) => any\n  ) {\n    const newCenter = {\n      x: (x + this.diagonalCoordinate.x) / 2,\n      y: (y + this.diagonalCoordinate.y) / 2\n    }\n    const rp = transformCoordinateReverseRotate(\n      x,\n      y,\n      newCenter.x,\n      newCenter.y,\n      this.node.rotate\n    )\n    const newSize = calcSize(newCenter, rp)\n    let isWidthReverse = false\n    if (newSize.width < 0) {\n      newSize.width = 0\n      isWidthReverse = true\n    }\n    let isHeightReverse = false\n    if (newSize.height < 0) {\n      newSize.height = 0\n      isHeightReverse = true\n    }\n    const newPos = calcPos(rp, newSize)\n    const newRect = {\n      x: newPos.x,\n      y: newPos.y,\n      width: newSize.width,\n      height: newSize.height\n    }\n    if (isWidthReverse || isHeightReverse) {\n      newRect.x = this.node.x\n      newRect.y = this.node.y\n    }\n    return {\n      newRect,\n      newCenter\n    }\n  }\n\n  // Stretching graphic objects\n  handleStretchNode(\n    e: { clientX: number; clientY: number },\n    calcSize: any,\n    calcPos: any,\n    fixPos: any\n  ) {\n    const actClientX = e.clientX - this.mousedownPosAndNodePosOffset.x\n    const actClientY = e.clientY - this.mousedownPosAndNodePosOffset.y\n    const { newRect, newCenter } = this.stretchCalc(\n      actClientX,\n      actClientY,\n      calcSize,\n      calcPos\n    )\n    if (this.options.lockRatio) {\n      this.fixStretch(newRect, newCenter, calcSize, calcPos, fixPos)\n      return\n    }\n    this.node.updateRect(newRect.x, newRect.y, newRect.width, newRect.height)\n  }\n\n  // Correction of new graphics when aspect ratio is locked\n  fixStretch(\n    newRect: { x?: any; y?: any; width: any; height: any },\n    newCenter: { x: any; y: any },\n    calcSize: {\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (arg0: { x: number; y: number }, arg1: { x: number; y: number }): any\n      (arg0: { x: number; y: number }, arg1: { x: number; y: number }): any\n    },\n    calcPos: {\n      (rp: { x: any; y: any }): { x: any; y: any }\n      (rp: { x: number; y: any }, newSize: { width: number }): {\n        x: number\n        y: any\n      }\n      (\n        rp: { x: number; y: number },\n        newSize: { width: number; height: number }\n      ): { x: number; y: number }\n      (rp: { x: number; y: number }, newSize: { height: number }): {\n        x: number\n        y: number\n      }\n      (arg0: { x: number; y: number }, arg1: any): any\n      (arg0: { x: number; y: number }, arg1: any): any\n    },\n    fixPos: {\n      (\n        newRatio: number,\n        newRect: { x?: any; width?: any; height?: any; y?: any }\n      ): { x: any; y: any }\n      (\n        newRatio: number,\n        newRect: { x?: any; height?: any; width?: any; y?: any }\n      ): { x: any; y: any }\n      (\n        newRatio: number,\n        newRect: { x?: any; height?: any; y?: any; width?: any }\n      ): { x: any; y: any }\n      (\n        newRatio: number,\n        newRect: { x?: any; width?: any; height?: any; y?: any }\n      ): { x: any; y: any }\n      (arg0: number, arg1: any): any\n    }\n  ) {\n    const newRatio = newRect.width / newRect.height\n    const fp = fixPos(newRatio, newRect)\n    const rp = getRotatedCoordinate(\n      fp.x,\n      fp.y,\n      newCenter.x,\n      newCenter.y,\n      this.node.rotate\n    )\n    const fixNewRect = this.stretchCalc(rp.x, rp.y, calcSize, calcPos).newRect\n    if (fixNewRect.width === 0 && fixNewRect.height === 0) {\n      return\n    }\n    this.node.updateRect(\n      fixNewRect.x,\n      fixNewRect.y,\n      fixNewRect.width,\n      fixNewRect.height\n    )\n  }\n\n  render() {\n    this.update()\n    const { width, height } = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      this.app.ctx.save()\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.BODY)) {\n        this.app.ctx.setLineDash([5])\n        plotRect(this.app.ctx, -halfWidth, -halfHeight, width, height)\n        this.app.ctx.restore()\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.TOP_LEFT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth - this.size,\n          -halfHeight - this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.TOP_RIGHT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth + this.node.width + this.size,\n          -halfHeight - this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth + this.node.width + this.size,\n          -halfHeight + this.node.height + this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth - this.size,\n          -halfHeight + this.node.height + this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.ROTATE)) {\n        plotCircle(\n          this.app.ctx,\n          -halfWidth + this.node.width / 2 + this.size / 2,\n          -halfHeight - this.size * 2,\n          this.size\n        )\n      }\n    })\n  }\n\n  // Detects which part of a dragged graphic object a coordinate is on\n  checkCoordinateInDragNodeWhere(x: number, y: number) {\n    let part = ''\n    const rp = transformCoordinateOnNode(x, y, this.node)\n    if (checkCoordinateIsInRectangle(rp.x, rp.y, this as any)) {\n      part = DRAG_NODE_PARTS.BODY\n    } else if (\n      getTowCoordinateDistance(\n        rp.x,\n        rp.y,\n        this.x + this.width / 2,\n        this.y - this.size * 2\n      ) <= this.size\n    ) {\n      part = DRAG_NODE_PARTS.ROTATE\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.TOP_LEFT)\n    ) {\n      part = DRAG_NODE_PARTS.TOP_LEFT_BUTTON\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.TOP_RIGHT)\n    ) {\n      part = DRAG_NODE_PARTS.TOP_RIGHT_BUTTON\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.BOTTOM_RIGHT)\n    ) {\n      part = DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.BOTTOM_LEFT)\n    ) {\n      part = DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON\n    }\n    if (this.hideParts.includes(part)) {\n      part = ''\n    }\n    return part\n  }\n\n  // Detects if the coordinates are within a drag and drop button\n  _checkCoordinateIsInButton(x: number, y: number, dir: string) {\n    let _x = 0\n    let _y = 0\n    switch (dir) {\n      case FOUR_CORNER.TOP_LEFT:\n        _x = this.x - this.size\n        _y = this.y - this.size\n        break\n      case FOUR_CORNER.TOP_RIGHT:\n        _x = this.x + this.width\n        _y = this.y - this.size\n        break\n      case FOUR_CORNER.BOTTOM_RIGHT:\n        _x = this.x + this.width\n        _y = this.y + this.height\n        break\n      case FOUR_CORNER.BOTTOM_LEFT:\n        _x = this.x - this.size\n        _y = this.y + this.height\n        break\n      default:\n        break\n    }\n    return checkCoordinateIsInRectangle(x, y, _x, _y, this.size, this.size)\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtArbitraryPlotLineEdge } from '../common/utils/checkClick'\nimport BaseMultiplexCoordinateNode from '../support/BaseMultiplexCoordinateNode'\nimport DragNode from '../support/DragNode'\nimport { plotArbitraryLine, plotLineSegment } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class ArbitraryPlot extends BaseMultiplexCoordinateNode {\n  public lastLineWidth: number\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n\n    // The third number of the coordinates [x,y,speed] is the line width\n    this.lastLineWidth = -1\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtArbitraryPlotLineEdge(this as any, rp)\n  }\n\n  // Rendering of a single line segment\n  singleRender(\n    mx: number,\n    my: number,\n    tx: number,\n    ty: number,\n    lineWidth: number | undefined\n  ) {\n    this.app.ctx.save()\n    plotLineSegment(this.app.ctx, mx, my, tx, ty, lineWidth)\n    this.app.ctx.restore()\n  }\n\n  render() {\n    const { coordinateArr }: any = this\n    this.warpRender(({ cx, cy }: any) => {\n      plotArbitraryLine(this.app.ctx, coordinateArr, {\n        app: this.app,\n        cx,\n        cy\n      })\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtArrowEdge } from '../common/utils/checkClick'\nimport BaseMultiplexCoordinateNode from '../support/BaseMultiplexCoordinateNode'\nimport DragNode from '../support/DragNode'\nimport { plotArrow } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Arrow extends BaseMultiplexCoordinateNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, app)\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtArrowEdge(this, rp)\n  }\n\n  render() {\n    const { coordinateArr, fictitiousCoordinate }: any = this\n    this.warpRender(({ cx, cy }: { cx: number; cy: number }) => {\n      // Plus the current live position of the mouse\n      let realtimeCoordinate: any[][] = []\n      if (coordinateArr.length > 0 && this.isCreate) {\n        const { x: fx, y: fy } = this.app.calculate.transform(\n          fictitiousCoordinate.x - cx,\n          fictitiousCoordinate.y - cy\n        )\n        realtimeCoordinate = [[fx, fy]]\n      }\n      plotArrow(\n        this.app.ctx,\n        coordinateArr\n          .map((coordinate: any[]) => {\n            const { x, y } = this.app.calculate.transform(\n              coordinate[0],\n              coordinate[1]\n            )\n            return [x - cx, y - cy]\n          })\n          .concat(realtimeCoordinate)\n      )\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport {\n  checkIsAtCircleEdge,\n  getCircleRadius\n} from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotCircle } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Circle extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app, {\n      lockRatio: true\n    })\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtCircleEdge(this, rp)\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(() => {\n      plotCircle(this.app.ctx, 0, 0, getCircleRadius(width, height), true)\n    })\n    this.renderDragNode()\n  }\n}\n","import {\n  getNodeCenterCoordinate,\n  getRotatedCoordinate,\n  transformCoordinateOnNode\n} from '../common/utils'\nimport { checkIsAtDiamondEdge } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotDiamond } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Diamond extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtDiamondEdge(this, rp)\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    const { x, y, width, height, rotate }: any = this\n    const coordinates = [\n      [x + width / 2, y],\n      [x + width, y + height / 2],\n      [x + width / 2, y + height],\n      [x, y + height / 2]\n    ]\n    const center = getNodeCenterCoordinate(this)\n    return coordinates.map((coordinate) =>\n      getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        center.x,\n        center.y,\n        rotate\n      )\n    )\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotDiamond(this.app.ctx, -halfWidth, -halfHeight, width, height, true)\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtRectangleInner } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotImage } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Image extends BaseNode {\n  public url: string\n\n  public imageObj: null\n\n  public ratio: number\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app, {\n      lockRatio: true\n    })\n\n    const { url, imageObj, ratio }: any = options\n\n    this.url = url || ''\n\n    this.imageObj = imageObj || null\n\n    this.ratio = ratio || 1\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtRectangleInner(this, rp)\n  }\n\n  // Serialisation\n  serialize() {\n    const base = super.serialize()\n    return {\n      ...base,\n      url: this.url,\n      ratio: this.ratio\n    }\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotImage(this.app.ctx, this, -halfWidth, -halfHeight, width, height)\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtLineEdge } from '../common/utils/checkClick'\nimport BaseMultiplexCoordinateNode from '../support/BaseMultiplexCoordinateNode'\nimport DragNode from '../support/DragNode'\nimport { plotLine } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Line extends BaseMultiplexCoordinateNode {\n  public isSingle: boolean\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n\n    // Is it a single line segment, otherwise it is a folded line consisting of multiple line segments\n    const { isSingle = false }: any = options\n\n    this.isSingle = isSingle\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtLineEdge(this as any, rp)\n  }\n\n  render() {\n    const { coordinateArr, fictitiousCoordinate }: any = this\n    this.warpRender(({ cx, cy }: any) => {\n      // Plus the current live position of the mouse\n      let realtimeCoordinate: any[][] = []\n      if (coordinateArr.length > 0 && this.isCreate) {\n        const { x: fx, y: fy } = this.app.calculate.transform(\n          fictitiousCoordinate.x - cx,\n          fictitiousCoordinate.y - cy\n        )\n        realtimeCoordinate = [[fx, fy]]\n      }\n      plotLine(\n        this.app.ctx,\n        coordinateArr\n          .map((coordinate: any[]) => {\n            const { x, y } = this.app.calculate.transform(\n              coordinate[0],\n              coordinate[1]\n            )\n            return [x - cx, y - cy]\n          })\n          .concat(realtimeCoordinate)\n      )\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtRectangleEdge } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotRect } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Rectangle extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtRectangleEdge(this, rp)\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotRect(this.app.ctx, -halfWidth, -halfHeight, width, height, true)\n    })\n    this.renderDragNode()\n  }\n}\n","import { splitTextLines, transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtRectangleInner } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotText } from '../support/plot'\nimport { AppObject, Node } from '../types'\n\nexport default class Text extends BaseNode {\n  public text: string\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app, {\n      lockRatio: true\n    })\n\n    this.text = options?.text || ''\n\n    this.style.fillStyle = options?.style?.fillStyle || '#000000'\n\n    this.style.fontSize = options?.style?.fontSize || 18\n\n    this.style.lineHeightRatio = options?.style?.lineHeightRatio || 1.5\n\n    this.style.fontFamily =\n      options?.style?.fontFamily || 'Microsoft YaHei, sans-serif'\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtRectangleInner(this, rp)\n  }\n\n  // Update the wrap-around box\n  // @ts-ignore\n  updateRect(x: number, y: number, width: number, height: number) {\n    const { text, style } = this\n    this.style.fontSize = Math.floor(\n      height / splitTextLines(text).length / style.lineHeightRatio\n    )\n    super.updateRect(x, y, width, height)\n  }\n\n  serialize() {\n    const base = super.serialize()\n    return {\n      ...base,\n      text: this.text\n    }\n  }\n\n  render() {\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotText(this.app.ctx, this, -halfWidth, -halfHeight)\n    })\n    this.renderDragNode()\n  }\n}\n","import {\n  getNodeCenterCoordinate,\n  getRotatedCoordinate,\n  transformCoordinateOnNode\n} from '../common/utils'\nimport { checkIsAtTriangleEdge } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotTriangle } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Triangle extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    const { x, y, width, height, rotate }: any = this\n    const coordinates = [\n      [x + width / 2, y],\n      [x + width, y + height],\n      [x, y + height]\n    ]\n    const center = getNodeCenterCoordinate(this)\n    return coordinates.map((coordinate) =>\n      getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        center.x,\n        center.y,\n        rotate\n      )\n    )\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtTriangleEdge(this as any, rp)\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotTriangle(this.app.ctx, -halfWidth, -halfHeight, width, height, true)\n    })\n    this.renderDragNode()\n  }\n}\n","import { DRAG_NODE_PARTS } from '../common/constants'\nimport {\n  computedLineWidthBySpeed,\n  createImageObj,\n  getNodeID,\n  getTowCoordinateDistance,\n  throttle\n} from '../common/utils'\nimport ArbitraryPlot from '../components/ArbitraryPlot'\nimport Arrow from '../components/Arrow'\nimport Circle from '../components/Circle'\nimport Diamond from '../components/Diamond'\nimport Image from '../components/Image'\nimport Line from '../components/Line'\nimport Rectangle from '../components/Rectangle'\nimport Text from '../components/Text'\nimport Triangle from '../components/Triangle'\nimport { AppObject, Ctx, Node, NodeArray, PlotType } from '../types'\n\nexport default class Nodes {\n  public app: AppObject\n\n  public nodeList: NodeArray\n\n  activeNode: Node | undefined\n\n  public isCreateNode: boolean\n\n  public isResize: boolean\n\n  public resizeNode: Node | null\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    // All graphic objects\n    this.nodeList = []\n\n    // Currently active graphic object\n    this.activeNode = undefined\n\n    // A new graphic object is currently being created\n    this.isCreateNode = false\n\n    // The graphic object is currently being adjusted\n    this.isResize = false\n\n    // The graphic object currently being adjusted\n    this.resizeNode = null\n\n    // A little relief from lag\n    this.handleResize = throttle(this.handleResize, this as any, 15)\n  }\n\n  createNode(\n    options: any,\n    callback: (...args: any) => void = () => {},\n    ctx?: Ctx,\n    notActive?: boolean\n  ) {\n    if (this.hasActiveNode() || this.isCreateNode) {\n      return this\n    }\n    options.id = getNodeID()\n    const node: any = this.pureCreateNode(options)\n    if (!node) {\n      return this\n    }\n    this.addNode(node)\n    if (!notActive) {\n      this.setActiveNode(node)\n    }\n    this.isCreateNode = true\n    // @ts-ignore\n    callback.call(ctx, node)\n    return this\n  }\n\n  copyNode(node: Node, notActive?: boolean, pos?: { x: number; y: number }) {\n    return new Promise<any>(async (resolve) => {\n      if (!node) {\n        return\n      }\n      const data: any = node.serialize?.()\n      if (data.type === 'image' && data.url != null) {\n        data.imageObj = (await createImageObj(data.url)) as HTMLInputElement\n      }\n      this.createNode(\n        data,\n        (node: any) => {\n          node.startResize(DRAG_NODE_PARTS.BODY)\n          let ox = 20\n          let oy = 20\n          if (pos) {\n            ox = pos.x - node.x - node.width / 2\n            oy = pos.y - node.y - node.height / 2\n          }\n          const gridAdsorbentPos = this.app.calculate.gridAdsorbent(ox, oy)\n          node.resize(null, null, null, gridAdsorbentPos.x, gridAdsorbentPos.y)\n          node.isCreate = false\n          if (notActive) {\n            node.isActive = false\n          }\n          this.isCreateNode = false\n          resolve(node)\n        },\n        this as unknown as Ctx,\n        notActive\n      )\n    })\n  }\n\n  // Rectangle-like graphic object being created\n  createRectangleLikeNode(\n    type: PlotType,\n    x: number,\n    y: number,\n    offsetX: number,\n    offsetY: number\n  ) {\n    this.createNode({\n      type,\n      x,\n      y,\n      width: offsetX,\n      height: offsetY\n    })\n    this.activeNode?.updateSize?.(offsetX, offsetY)\n  }\n\n  // Circular graphic object being created\n  createCircle(x: number, y: number, e: { clientX: any; clientY: any }) {\n    this.createNode({\n      type: 'circle',\n      x,\n      y\n    })\n    const radius = getTowCoordinateDistance(e.clientX, e.clientY, x, y)\n    this.activeNode?.updateSize?.(radius, radius)\n  }\n\n  // Freehand brush graphic object being created\n  createArbitraryPlot(\n    e: { clientX: any; clientY: any },\n    event: { mouseSpeed: number; lastMousePos: { x: number; y: number } }\n  ) {\n    this.createNode({\n      type: 'arbitrary-plot'\n    })\n    const node = this.activeNode\n    // Calculating brush thickness\n    const lineWidth = computedLineWidthBySpeed(\n      event.mouseSpeed,\n      <number>node?.lastLineWidth\n    )\n    if (node?.lastLineWidth) {\n      node.lastLineWidth = lineWidth\n    }\n    node?.addCoordinate?.(e.clientX, e.clientY, lineWidth)\n    // The brush is not repainted and incremental painting is used, otherwise it will lag\n    const { calculate, ctx, state } = this.app\n    const tfp = calculate.transformToCanvasCalculate(\n      calculate.subScrollX(event.lastMousePos.x),\n      calculate.subScrollY(event.lastMousePos.y)\n    )\n    const ttp = calculate.transformToCanvasCalculate(\n      calculate.subScrollX(e.clientX),\n      calculate.subScrollY(e.clientY)\n    )\n    ctx.save()\n    ctx.scale(<number>state.scale, <number>state.scale)\n    node?.singleRender?.(tfp.x, tfp.y, ttp.x, ttp.y, lineWidth)\n    ctx.restore()\n  }\n\n  // Image graphic object being created\n  createImage(\n    e: { unGridClientX: number; unGridClientY: number },\n    {\n      width,\n      height,\n      imageObj,\n      url,\n      ratio\n    }: {\n      width: number\n      height: number\n      imageObj: HTMLInputElement\n      url: string\n      ratio: number\n    }\n  ) {\n    const gp = this.app.calculate.gridAdsorbent(\n      e.unGridClientX - width / 2,\n      e.unGridClientY - height / 2\n    )\n    this.createNode({\n      type: 'image',\n      x: gp.x,\n      y: gp.y,\n      url,\n      imageObj,\n      width,\n      height,\n      ratio\n    })\n  }\n\n  // Text graphic object being edited\n  editingText(node: Node) {\n    if (node.type !== 'text') {\n      return\n    }\n    node.noRender = true\n    this.setActiveNode(node)\n  }\n\n  // Complete editing of text graphic objects\n  completeEditingText() {\n    const node = this.activeNode\n    if (!node || node.type !== 'text') {\n      return\n    }\n    if (!node?.text?.trim()) {\n      this.deleteNode(node)\n      this.setActiveNode()\n      return\n    }\n    node.noRender = false\n  }\n\n  // Complete the creation of the arrow graphic object\n  completeCreateArrow(e: { clientX: number; clientY: number }) {\n    this.activeNode?.addCoordinate?.(e.clientX, e.clientY)\n  }\n\n  // Arrowhead graphic object being created\n  createArrow(x: number, y: number, e: { clientX: any; clientY: any }) {\n    this.createNode(\n      {\n        type: 'arrow',\n        x,\n        y\n      },\n      (node) => {\n        node.addCoordinate(x, y)\n      }\n    )\n    this.activeNode?.updateFictitiousCoordinate?.(e.clientX, e.clientY)\n  }\n\n  // Line/line graphical object being created\n  createLine(\n    x: number | undefined,\n    y: number | undefined,\n    e: { clientX: number; clientY: number },\n    isSingle = false,\n    notCreate = false\n  ) {\n    if (!notCreate) {\n      this.createNode(\n        {\n          type: 'line',\n          x,\n          y,\n          isSingle\n        },\n        (node) => {\n          node.addCoordinate(x, y)\n        }\n      )\n    }\n    const node = this.activeNode\n    if (node) {\n      node.updateFictitiousCoordinate?.(e.clientX, e.clientY)\n    }\n  }\n\n  insertNode(node: Node, index: number) {\n    this.nodeList.splice(index, 0, node)\n  }\n\n  addNode(node: Node) {\n    this.nodeList.push(node)\n    return this\n  }\n\n  getNodesNum() {\n    return this.nodeList.length\n  }\n\n  hasNodes() {\n    return this.nodeList.length > 0\n  }\n\n  unshiftNode(node: Node) {\n    this.nodeList.unshift(node)\n    return this\n  }\n\n  // Deleting graphic objects\n  deleteNode(node: Node) {\n    const index = this.getNodeIndex(node)\n    if (index !== -1) {\n      this.nodeList.splice(index, 1)\n      if (node.isActive) {\n        this.cancelActiveNode()\n      }\n    }\n    return this\n  }\n\n  // Delete all graphic objects\n  deleteAllNodes() {\n    this.activeNode = undefined\n    this.nodeList = []\n    this.isCreateNode = false\n    this.isResize = false\n    this.resizeNode = null\n    return this\n  }\n\n  // Get the index of the graphic object in the list of graphic objects\n  getNodeIndex(node: Node) {\n    return this.nodeList.findIndex((item) => item === node)\n  }\n\n  // Create graphic objects from graphic object data\n  createNodesFromData(nodes: NodeArray) {\n    this.app.oldData = this.app.getData()\n    nodes.forEach((node) => {\n      const nodeObject: any = this.pureCreateNode(node)\n      nodeObject.isActive = false\n      nodeObject.isCreate = false\n      this.addNode(nodeObject as Node)\n    })\n    return this\n  }\n\n  // Presence or absence of active graphic objects\n  hasActiveNode() {\n    return this.activeNode\n  }\n\n  // Setting the activation of graphic objects\n  setActiveNode(node?: Node) {\n    this.cancelActiveNode()\n    this.activeNode = node\n    if (node) {\n      node.isActive = true\n    }\n    this.app.emit('activeNodeChange', this.activeNode)\n    return this\n  }\n\n  // Cancel the currently active graphic object\n  cancelActiveNode() {\n    if (!this.hasActiveNode()) {\n      return this\n    }\n    if (this.activeNode) {\n      this.activeNode.isActive = false\n      this.activeNode = undefined\n    }\n    this.app.emit('activeNodeChange', this.activeNode)\n    return this\n  }\n\n  // Detects if a graphic object is selected by a coordinate click\n  checkIsClickNode(e: any) {\n    const x = e.unGridClientX\n    const y = e.unGridClientY\n    for (let i = this.nodeList.length - 1; i >= 0; i -= 1) {\n      const node = this.nodeList[i]\n      if (node.isClick?.(x, y)) {\n        return node\n      }\n    }\n    return null\n  }\n\n  pureCreateNode(options: any = {}) {\n    switch (options.type) {\n      case 'rectangle':\n        return new Rectangle(options, this.app)\n      case 'diamond':\n        return new Diamond(options, this.app)\n      case 'triangle':\n        return new Triangle(options, this.app)\n      case 'circle':\n        return new Circle(options, this.app)\n      case 'arbitrary-plot':\n        return new ArbitraryPlot(options, this.app)\n      case 'image':\n        return new Image(options, this.app)\n      case 'arrow':\n        return new Arrow(options, this.app)\n      case 'line':\n        return new Line(options, this.app)\n      case 'text':\n        return new Text(options, this.app)\n      default:\n        return null\n    }\n  }\n\n  // Complete the creation of line/dash graphical objects\n  completeCreateLine(\n    e: { clientX: number; clientY: number },\n    completeCallback = () => {}\n  ) {\n    let node = this.activeNode\n    const x = e.clientX\n    const y = e.clientY\n    if (node && node.isSingle) {\n      node.addCoordinate?.(x, y)\n      completeCallback()\n    } else {\n      this.createNode({\n        type: 'line',\n        isSingle: false\n      })\n      node = this.activeNode\n      node?.addCoordinate?.(x, y)\n      node?.updateFictitiousCoordinate?.(x, y)\n    }\n  }\n\n  // Creation of graphic objects complete\n  completeCreateNode() {\n    this.isCreateNode = false\n    const node: any = this.activeNode\n    if (!node) {\n      return this\n    }\n    if (['arbitrary-plot', 'arrow', 'line'].includes(node.type)) {\n      node.updateMultiplexCoordinateBoundingRect()\n    }\n    node.isCreate = false\n    this.app.emitChange()\n    return this\n  }\n\n  // Styling of active graphic objects\n  setActiveNodeStyle(style = {}) {\n    if (!this.hasActiveNode()) {\n      return this\n    }\n    Object.keys(style).forEach((key) => {\n      // @ts-ignore\n      this.activeNode.style[key] = style[key]\n    })\n    return this\n  }\n\n  // Detects if the specified position is on the graphic object adjustment handle\n  checkInResizeHand(x: any, y: any) {\n    const node = this.activeNode\n    const hand = node?.dragNode?.checkCoordinateInDragNodeWhere?.(x, y)\n    if (hand) {\n      return {\n        node,\n        hand\n      }\n    }\n    return null\n  }\n\n  // Check if a graphic object adjustment operation is required\n  checkIsResize(x: number, y: number, e: any) {\n    if (!this.hasActiveNode()) {\n      return false\n    }\n    const res = this.checkInResizeHand(x, y)\n    if (res) {\n      this.isResize = true\n      if (res.node) {\n        this.resizeNode = res.node\n        this.resizeNode.startResize?.(res.hand, e)\n      }\n      this.app.cursor.setResize(res.hand)\n      return true\n    }\n    return false\n  }\n\n  // Performing graphic object adjustment operations\n  handleResize(...args: any[]) {\n    if (!this.isResize) {\n      return\n    }\n    this.resizeNode?.resize?.(...args)\n  }\n\n  // Ending a graphic object adjustment operation\n  endResize() {\n    this.isResize = false\n    this.resizeNode?.endResize?.()\n    this.resizeNode = null\n  }\n\n  // Serialize all graphic objects on the current canvas\n  serialize(stringify = false) {\n    const data = this.nodeList.map((node) => node.serialize?.())\n    return stringify ? JSON.stringify(data) : data\n  }\n}\n","import { getMultiplexNodeRectInfo } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class Render {\n  public app: AppObject\n\n  public beingCopyActiveNode: null\n\n  public beingCopySelectedNodes: any[]\n\n  public beingCopyNode: undefined\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    // The active graphic object that will be copied\n    this.beingCopyActiveNode = null\n\n    // The selected graphic object that will be copied\n    this.beingCopySelectedNodes = []\n\n    this.registerShortcutKeys()\n  }\n\n  // Styling of active graphic objects\n  setActiveNodeStyle(style = {}) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.setActiveNodeStyle(style)\n    this.render()\n    if (!this.app.nodes.isCreateNode) {\n      this.app.emitChange()\n    }\n    return this\n  }\n\n  // Set the style for the currently active or selected graphic object\n  setCurrentNodesStyle(style = {}) {\n    this.setActiveNodeStyle(style)\n    this.app.selection.setSelectedNodeStyle(style)\n  }\n\n  clearCanvas() {\n    const { width, height } = this.app\n    this.app.ctx.clearRect(-width / 2, -height / 2, width, height)\n    return this\n  }\n\n  render() {\n    const { state } = this.app\n    this.clearCanvas()\n    this.app.ctx.save()\n    this.app.ctx.scale(<number>state.scale, <number>state.scale)\n    this.app.nodes.nodeList.forEach((node: any) => {\n      if (node.noRender) {\n        return\n      }\n      node.render()\n    })\n    this.app.ctx.restore()\n    return this\n  }\n\n  registerShortcutKeys() {\n    // Select all\n    this.app.keyCommand.addShortcut('Control+a', () => {\n      this.selectAll()\n    })\n    // Resetting scaling\n    this.app.keyCommand.addShortcut('Control+0', () => {\n      this.setZoom(1)\n    })\n    // Delete the currently active graphic object\n    this.app.keyCommand.addShortcut('Del|Backspace', () => {\n      this.deleteCurrentNodes()\n    })\n    // Copying graphic objects\n    this.app.keyCommand.addShortcut('Control+c', () => {\n      this.copyCurrentNode()\n    })\n    // Cutting graphic objects\n    this.app.keyCommand.addShortcut('Control+x', () => {\n      this.cutCurrentNode()\n    })\n    // Withdrawn\n    this.app.keyCommand.addShortcut('Control+z', () => {\n      this.app.history.undo()\n    })\n    // Show or hide the grid\n    this.app.keyCommand.addShortcut(\"Control+'\", () => {\n      if (this.app.state.showGrid) {\n        this.app.grid.hideGrid()\n      } else {\n        this.app.grid.showGrid()\n      }\n    })\n    // Redo\n    this.app.keyCommand.addShortcut('Control+y', () => {\n      this.app.history.redo()\n    })\n    // Paste graphic objects\n    this.app.keyCommand.addShortcut('Control+v', () => {\n      this.pasteCurrentNode(true)\n    })\n  }\n\n  // Copy the currently active or selected graphic object\n  copyCurrentNode() {\n    if (this.app.nodes.activeNode) {\n      this.beingCopySelectedNodes = []\n      this.beingCopyNode = this.app.nodes.activeNode\n    } else if (this.app.selection.hasSelectionNodes()) {\n      this.beingCopyNode = undefined\n      this.beingCopySelectedNodes = this.app.selection.getSelectionNodes()\n    }\n  }\n\n  // Cuts the currently active or selected graphic object\n  cutCurrentNode() {\n    if (this.app.nodes.activeNode) {\n      this.copyCurrentNode()\n      this.deleteCurrentNodes()\n    } else if (this.app.selection.hasSelectionNodes()) {\n      this.copyCurrentNode()\n      this.deleteCurrentNodes()\n      this.app.selection.setMultiplexSelectNodes(this.beingCopySelectedNodes)\n      this.app.selection.emitChange()\n    }\n  }\n\n  // Paste the copied or cut graphic object\n  pasteCurrentNode(useCurrentEventPos = false) {\n    let pos = null\n    if (useCurrentEventPos) {\n      const { x } = this.app.event.lastMousePos\n      const { y } = this.app.event.lastMousePos\n      pos = {\n        x,\n        y\n      }\n    }\n    if (this.beingCopyNode) {\n      this.copyNode(this.beingCopyNode, false, pos as any).then(() => {})\n    } else if (this.beingCopySelectedNodes.length > 0) {\n      this.app.selection.copySelectionNodes(useCurrentEventPos ? pos : null)\n    }\n  }\n\n  // Deleting graphic objects\n  deleteNode(node: any) {\n    this.app.nodes.deleteNode(node)\n    this.render()\n    this.app.emitChange()\n  }\n\n  // Copy and paste graphic objects\n  async copyNode(node: any, notActive?: boolean, pos?: { x: any; y: any }) {\n    this.app.nodes.cancelActiveNode()\n    await this.app.nodes.copyNode(node, notActive, pos)\n    this.render()\n    this.app.emitChange()\n  }\n\n  // Delete the currently active graphic object\n  deleteActiveNode() {\n    if (!this.app.nodes.hasActiveNode()) {\n      return\n    }\n    this.deleteNode(this.app.nodes.activeNode)\n  }\n\n  // Delete the currently active or selected graphic object\n  deleteCurrentNodes() {\n    this.deleteActiveNode()\n    this.app.selection.deleteSelectedNodes()\n  }\n\n  // Cancel the currently active graphic object\n  cancelActiveNode() {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.cancelActiveNode()\n    this.render()\n    return this\n  }\n\n  // Update the position of the currently active graphic object\n  updateActiveNodePosition(x: number, y: number) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.activeNode.updatePos(x, y)\n    this.render()\n    return this\n  }\n\n  // Update the size of the currently active graphic object\n  updateActiveNodeSize(width: number, height: number) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.activeNode.updateSize(width, height)\n    this.render()\n    return this\n  }\n\n  // Update the rotation angle of the currently active graphic object\n  updateActiveNodeRotate(rotate: number) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.activeNode.updateRotate(rotate)\n    this.render()\n    return this\n  }\n\n  // Emptying a graphic object\n  empty() {\n    this.app.nodes.deleteAllNodes()\n    this.render()\n    this.app.emitChange()\n  }\n\n  // Enlarge\n  zoomIn(num = 0.1) {\n    if (this.app.state.scale) {\n      this.app.updateState({\n        scale: this.app.state.scale + num\n      } as any)\n      this.render()\n      this.app.emit('zoomChange', this.app.state.scale)\n    }\n  }\n\n  // Reduction\n  zoomOut(num = 0.1) {\n    if (this.app.state.scale) {\n      this.app.updateState({\n        scale: this.app.state.scale - num > 0 ? this.app.state.scale - num : 0\n      } as any)\n      this.render()\n      this.app.emit('zoomChange', this.app.state.scale)\n    }\n  }\n\n  // Set the specified zoom value\n  setZoom(zoom: number) {\n    if (zoom < 0 || zoom > 1) {\n      return\n    }\n    this.app.updateState({\n      scale: zoom\n    } as any)\n    this.render()\n    this.app.emit('zoomChange', this.app.state.scale)\n  }\n\n  // Scaling to fit all graphic objects\n  fit() {\n    if (!this.app.nodes.hasNodes()) {\n      return\n    }\n    this.scrollToCenter()\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.app.nodes.nodeList\n    )\n    const width = maxX - minX\n    const height = maxY - minY\n    const maxScale = Math.min(this.app.width / width, this.app.height / height)\n    this.setZoom(maxScale)\n  }\n\n  // Scroll to the specified position\n  scrollTo(scrollX: number, scrollY: number) {\n    this.app.updateState({\n      scrollX,\n      scrollY\n    } as any)\n    this.render()\n    this.app.emit(\n      'scrollChange',\n      this.app.state.scrollX,\n      this.app.state.scrollY\n    )\n  }\n\n  // Scroll to centre, i.e. back to the centre of all graphic objects\n  scrollToCenter() {\n    if (!this.app.nodes.hasNodes()) {\n      this.scrollTo(0, 0)\n      return\n    }\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.app.nodes.nodeList\n    )\n    const width = maxX - minX\n    const height = maxY - minY\n    this.scrollTo(\n      minX - (this.app.width - width) / 2,\n      minY - (this.app.height - height) / 2\n    )\n  }\n\n  // Copy and paste the current graphic object\n  copyPasteCurrentNodes() {\n    this.copyCurrentNode()\n    this.pasteCurrentNode()\n  }\n\n  // Set the background colour\n  setBackgroundColor(color: string) {\n    this.app.updateState({\n      backgroundColor: color\n    } as any)\n    this.app.background.set()\n  }\n\n  // Select all graphic objects\n  selectAll() {\n    this.app.selection.selectNodes(this.app.nodes.nodeList)\n  }\n}\n","import { AppObject } from '../../types'\n\nexport default class Calculate {\n  private readonly app: AppObject\n\n  constructor(app: AppObject) {\n    this.app = app\n  }\n\n  // Conversion of screen coordinates to canvas coordinates\n  transformToCanvasCalculate(x: number, y: number) {\n    x -= this.app.width / 2\n    y -= this.app.height / 2\n    return {\n      x,\n      y\n    }\n  }\n\n  // Object position attached to grid\n  gridAdsorbent(x: number, y: number) {\n    const { gridConfig, showGrid } = this.app.state\n    if (typeof gridConfig === 'undefined') {\n      return {}\n    }\n    if (!showGrid) {\n      return {\n        x,\n        y\n      }\n    }\n    const gridSize = gridConfig.size\n    if (typeof gridSize === 'undefined') {\n      return {}\n    }\n    return {\n      x: x - (x % gridSize),\n      y: y - (y % gridSize)\n    }\n  }\n\n  // Add vertical scroll distance\n  addScrollY(y: number) {\n    if (typeof this.app.state.scrollY === 'undefined') {\n      return 0\n    }\n    return this.app.state.scrollY + y\n  }\n\n  // Add horizontal scroll distance\n  addScrollX(x: number) {\n    if (typeof this.app.state.scrollX === 'undefined') {\n      return 0\n    }\n    return this.app.state.scrollX + x\n  }\n\n  // minus vertical scroll distance\n  subScrollY(y: number) {\n    if (typeof this.app.state.scrollY === 'undefined') {\n      return 0\n    }\n    return y - this.app.state.scrollY\n  }\n\n  // minus horizontal rolling distance\n  subScrollX(x: number) {\n    if (typeof this.app.state.scrollX === 'undefined') {\n      return 0\n    }\n    return x - this.app.state.scrollX\n  }\n\n  // Canvas conversion to screen coordinates\n  transformToScreenCalculate(x: number, y: number) {\n    x += this.app.width / 2\n    y += this.app.height / 2\n    return {\n      x,\n      y\n    }\n  }\n\n  // Integrated conversion, screen coordinates to canvas coordinates minus scroll values\n  transform(x: number, y: number) {\n    const t = this.transformToCanvasCalculate(x, y)\n    return {\n      x: this.subScrollX(t.x),\n      y: this.subScrollY(t.y)\n    }\n  }\n\n  // For when the container is not full screen, convert coordinates relative to the container to relative to the window\n  mountELToWindow(x: number, y: number) {\n    return {\n      x: x + this.app.left,\n      y: y + this.app.top\n    }\n  }\n\n  // For when the container is not full screen, Convert coordinates relative to the window to relative to the container\n  windowToContainer(x: number, y: number) {\n    return {\n      x: x - this.app.left,\n      y: y - this.app.top\n    }\n  }\n\n  // The position of the screen coordinates after applying canvas scaling\n  scale(x: number, y: number) {\n    const { state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return {}\n    }\n    const wp = this.transformToCanvasCalculate(x, y)\n    const sp = this.transformToScreenCalculate(\n      wp.x * state.scale,\n      wp.y * state.scale\n    )\n    return {\n      x: sp.x,\n      y: sp.y\n    }\n  }\n\n  // The position of the screen coordinates after applying the canvas zoom in reverse\n  reverseScale(x: number, y: number) {\n    const { state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return {}\n    }\n    const tp = this.transformToCanvasCalculate(x, y)\n    const sp = this.transformToScreenCalculate(\n      tp.x / state.scale,\n      tp.y / state.scale\n    )\n    return {\n      x: sp.x,\n      y: sp.y\n    }\n  }\n}\n","import {\n  getMultiplexNodeRectInfo,\n  getNodeCenterCoordinate,\n  getTowCoordinateRotate\n} from '../common/utils'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { AppObject, Node, NodeArray } from '../types'\n\nexport default class MultiplexSelectNode extends BaseNode {\n  selectedNodeList: NodeArray\n\n  public wholeCenterPos: { x: number; y: number }\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this as any, this.app)\n\n    this.selectedNodeList = []\n\n    this.wholeCenterPos = { x: 0, y: 0 }\n  }\n\n  // Filtering out deleted graphic objects\n  updateNodes(nodes: NodeArray) {\n    const exists: NodeArray = []\n    this.selectedNodeList.forEach((node) => {\n      if (nodes.includes(node)) {\n        exists.push(node)\n      }\n    })\n    this.setSelectedNodeList(exists)\n  }\n\n  // Calculate size and position\n  // @ts-ignore\n  updateRect() {\n    if (this.selectedNodeList.length <= 0) {\n      super.updateRect(0, 0, 0, 0)\n      return\n    }\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.selectedNodeList\n    )\n    super.updateRect(minX, minY, maxX - minX, maxY - minY)\n  }\n\n  // In adjustment\n  // @ts-ignore\n  resize(...args: any) {\n    this.selectedNodeList.forEach((node: Node) => {\n      if (node.dragNode && node.dragNode.resizeType === 'rotate') {\n        // 旋转操作特殊处理\n        this.handleRotate(node, ...args)\n      } else {\n        node?.resize?.(...args)\n      }\n    })\n  }\n\n  // Rotating graphic objects\n  handleRotate(node: Node, e?: any, mx?: number, my?: number) {\n    const rotate = getTowCoordinateRotate(\n      this.wholeCenterPos.x,\n      this.wholeCenterPos.y,\n      e.clientX,\n      e.clientY,\n      <number>mx,\n      <number>my\n    )\n    node.rotateByCenter?.(rotate, this.wholeCenterPos.x, this.wholeCenterPos.y)\n  }\n\n  // End of adjustment\n  // @ts-ignore\n  endResize() {\n    this.selectedNodeList.forEach((node) => {\n      node.endResize?.()\n    })\n  }\n\n  // Set the selected graphic object list\n  setSelectedNodeList(list: NodeArray) {\n    this.selectedNodeList.forEach((node) => {\n      node.isSelected = false\n    })\n    this.selectedNodeList = list\n    this.selectedNodeList.forEach((node) => {\n      node.isSelected = true\n    })\n  }\n\n  // Start of adjustment\n  // @ts-ignore\n  startResize(...args: any) {\n    this.selectedNodeList.forEach((node) => {\n      if (args[0] === 'rotate') {\n        // 计算多选图形对象整体中心坐标\n        this.wholeCenterPos = getNodeCenterCoordinate(this as any)\n      }\n      node.startResize?.(...args)\n    })\n  }\n\n  render() {\n    if (this.width && this.height && this.selectedNodeList.length > 0) {\n      if (this.width <= 0 || this.height <= 0) {\n        return\n      }\n      this.dragNode.render()\n    }\n  }\n}\n","import { DRAG_NODE_PARTS } from '../common/constants'\nimport { getBoundingRect, throttle } from '../common/utils'\nimport Calculate from '../common/utils/Calculate'\nimport MultiplexSelectNode from '../components/MultiplexSelectNode'\nimport Rectangle from '../components/Rectangle'\nimport Canvas from '../support/Canvas'\nimport { AppObject, Ctx, Node, NodeArray, State } from '../types'\n\nexport default class Selection {\n  public app: AppObject\n\n  public canvas: any\n\n  public ctx: Ctx | undefined\n\n  public createSelection: boolean\n\n  hasSelection: boolean\n\n  public isResize: boolean\n\n  public state: State\n\n  public width: number\n\n  public height: number\n\n  public calculate: Calculate\n\n  public rectangle: Rectangle\n\n  public multiplexSelectNode: MultiplexSelectNode\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.canvas = null\n\n    this.ctx = undefined\n\n    // Is a selection currently being created\n    this.createSelection = false\n\n    // Whether there is currently a multiple selection of graphic objects\n    this.hasSelection = false\n\n    // Whether the selected graphic object is currently being adjusted\n    this.isResize = false\n\n    this.state = this.app.state\n\n    this.width = this.app.width\n\n    this.height = this.app.height\n\n    this.calculate = new Calculate(this as unknown as AppObject)\n\n    // Selection Rectangle\n    this.rectangle = new Rectangle(\n      {\n        type: 'rectangle',\n        style: {\n          strokeStyle: 'rgba(9,132,227,0.3)',\n          fillStyle: 'rgba(9,132,227,0.3)'\n        }\n      } as any,\n      this as any\n    )\n\n    // Virtual graphic object of the selected graphic object for displaying the drag and drop box\n    this.multiplexSelectNode = new MultiplexSelectNode(\n      {\n        type: 'multiplexSelectNode'\n      } as any,\n      this as any\n    )\n\n    // @ts-ignore\n    this.checkInNodes = throttle(this.checkInNodes, this, 20)\n\n    // A little relief from lag\n    this.handleResize = throttle(this.handleResize, this as any, 15)\n\n    this.init()\n\n    this.bindEvent()\n  }\n\n  // Detection of nodes in the selection\n  checkInNodes(e: any, event: any) {\n    const minX = Math.min(event.mousedownPos.x, e.clientX)\n    const minY = Math.min(event.mousedownPos.y, e.clientY)\n    const maxX = Math.max(event.mousedownPos.x, e.clientX)\n    const maxY = Math.max(event.mousedownPos.y, e.clientY)\n    const selectedNodeList: any[] | undefined = []\n    this.app.nodes.nodeList.forEach((node: Node) => {\n      let _minX = Infinity\n      let _maxX = -Infinity\n      let _minY = Infinity\n      let _maxY = -Infinity\n      const endCoordinateList = node?.getEndCoordinateList?.()\n      const rect: any = getBoundingRect(\n        endCoordinateList.map((coordinate: { x: number; y: number }) => [\n          coordinate.x,\n          coordinate.y\n        ]),\n        true\n      )\n      rect.forEach(({ x, y }: any) => {\n        if (x < _minX) {\n          _minX = x\n        }\n        if (x > _maxX) {\n          _maxX = x\n        }\n        if (y < _minY) {\n          _minY = y\n        }\n        if (y > _maxY) {\n          _maxY = y\n        }\n      })\n      if (_minX >= minX && _maxX <= maxX && _minY >= minY && _maxY <= maxY) {\n        selectedNodeList.push(node)\n      }\n    })\n    this.setMultiplexSelectNodes(selectedNodeList, true)\n    this.app.render.render()\n  }\n\n  // Detects if the specified position is on the graphic object adjustment handle\n  checkInResizeHand(x: any, y: any) {\n    return this.multiplexSelectNode.dragNode.checkCoordinateInDragNodeWhere(\n      x,\n      y\n    )\n  }\n\n  // Delete the currently selected graphic object\n  deleteSelectedNodes() {\n    this.getSelectionNodes().forEach((node: Node) => {\n      this.app.nodes.deleteNode(node)\n    })\n    this.selectNodes([])\n    this.app.emitChange()\n  }\n\n  // Whether the selected graphic object currently exists\n  hasSelectionNodes() {\n    return this.getSelectionNodes().length > 0\n  }\n\n  // Get the currently selected graphic object\n  getSelectionNodes() {\n    return this.multiplexSelectNode.selectedNodeList\n  }\n\n  // Copy the currently selected graphic objects\n  async copySelectionNodes(pos: { x: number; y: number }) {\n    const task = this.getSelectionNodes().map((node) =>\n      this.app.nodes.copyNode(node, true)\n    )\n    const nodes = await Promise.all(task)\n    this.setMultiplexSelectNodes(nodes)\n    // Paste to the specified location\n    if (pos) {\n      this.multiplexSelectNode.startResize(DRAG_NODE_PARTS.BODY)\n      if (\n        !this.multiplexSelectNode.x ||\n        !this.multiplexSelectNode.y ||\n        !this.multiplexSelectNode.width ||\n        !this.multiplexSelectNode.height\n      ) {\n        // eslint-disable-next-line no-console\n        console.error('multiplexSelectNode x or y or width or height is null')\n        return\n      }\n      const ox =\n        pos.x - this.multiplexSelectNode.x - this.multiplexSelectNode.width / 2\n      const oy =\n        pos.y - this.multiplexSelectNode.y - this.multiplexSelectNode.height / 2\n      // If the grid is turned on, then the coordinates are to be attached to the grid\n      const gridAdsorbentPos = this.app.calculate.gridAdsorbent(ox, oy)\n      this.multiplexSelectNode.resize(\n        null,\n        null,\n        null,\n        gridAdsorbentPos.x,\n        gridAdsorbentPos.y\n      )\n      this.multiplexSelectNode.endResize()\n      this.multiplexSelectNode.updateRect()\n    }\n    this.app.render.render()\n    this.renderSelection()\n    this.app.emitChange()\n  }\n\n  // Check if a graphic object adjustment operation is required\n  checkIsResize(x: number, y: number, e: any) {\n    if (!this.hasSelection) {\n      return false\n    }\n    const hand =\n      this.multiplexSelectNode.dragNode.checkCoordinateInDragNodeWhere(x, y)\n    if (hand) {\n      this.isResize = true\n      this.multiplexSelectNode.startResize(hand, e)\n      this.app.cursor.setResize(hand)\n      return true\n    }\n    return false\n  }\n\n  // Performing graphic object adjustment operations\n  handleResize(...args: any[]) {\n    if (!this.isResize) {\n      return\n    }\n    this.multiplexSelectNode.resize(...args)\n    this.app.render.render()\n    this.multiplexSelectNode.updateRect()\n    this.renderSelection()\n  }\n\n  // Ending a graphic object adjustment operation\n  endResize() {\n    this.isResize = false\n    this.multiplexSelectNode.endResize()\n  }\n\n  // Styling of multi-selected graphic objects\n  setSelectedNodeStyle(style = {}) {\n    if (!this.hasSelectionNodes()) {\n      return\n    }\n    Object.keys(style).forEach((key) => {\n      this.getSelectionNodes().forEach((node) => {\n        // @ts-ignore\n        node.style[key] = style[key]\n      })\n    })\n    this.app.render.render()\n    this.app.emitChange()\n  }\n\n  // Select the specified graphic object\n  selectNodes(nodes = []) {\n    this.hasSelection = nodes.length > 0\n    this.setMultiplexSelectNodes(nodes)\n    this.app.render.render()\n    this.renderSelection()\n    this.emitChange()\n  }\n\n  cancelSelectNodes() {\n    this.selectNodes([])\n  }\n\n  // Set the selected graphic object\n  setMultiplexSelectNodes(nodes: NodeArray = [], notUpdateRect?: boolean) {\n    this.multiplexSelectNode.setSelectedNodeList(nodes)\n    if (!notUpdateRect) {\n      this.multiplexSelectNode.updateRect()\n    }\n  }\n\n  emitChange() {\n    this.app.emit('multiplexSelectChange', this.getSelectionNodes())\n  }\n\n  bindEvent() {\n    this.app.on('change', () => {\n      this.state = this.app.state\n      this.multiplexSelectNode.updateNodes(this.app.nodes.nodeList)\n      this.renderSelection()\n    })\n    this.app.on('scrollChange', () => {\n      this.renderSelection()\n    })\n    this.app.on('zoomChange', () => {\n      this.renderSelection()\n    })\n  }\n\n  onMousedown(\n    e: { originEvent: { which: number } },\n    event: { mousedownPos: { x: number; y: number } }\n  ) {\n    if (e.originEvent.which !== 1) {\n      return\n    }\n    this.createSelection = true\n    this.rectangle.updatePos(event.mousedownPos.x, event.mousedownPos.y)\n  }\n\n  onMousemove(e: number, event: { mouseOffset: { x: number; y: number } }) {\n    if (\n      Math.abs(event.mouseOffset.x) <= 10 &&\n      Math.abs(event.mouseOffset.y) <= 10\n    ) {\n      return\n    }\n    this.onMove(e, event)\n  }\n\n  onMouseup() {\n    this.createSelection = false\n    this.rectangle.updateRect(0, 0, 0, 0)\n    // 判断是否有图形对象被选中\n    this.hasSelection = this.hasSelectionNodes()\n    this.multiplexSelectNode.updateRect()\n    this.renderSelection()\n    this.emitChange()\n  }\n\n  // Mouse movement events\n  onMove(e: number, event: { mouseOffset: { x: number; y: number } }) {\n    this.rectangle.updateSize(event.mouseOffset.x, event.mouseOffset.y)\n    this.renderSelection()\n    this.checkInNodes(e, event)\n  }\n\n  reset() {\n    this.setMultiplexSelectNodes([])\n    this.hasSelection = false\n    this.renderSelection()\n    this.emitChange()\n  }\n\n  renderSelection() {\n    this.canvas.clearCanvas()\n    this.ctx?.save()\n    if (this.app.state.scale) {\n      this.ctx?.scale(this.app.state.scale, this.app.state.scale)\n    }\n    this.rectangle.render()\n    this.multiplexSelectNode.render()\n    this.ctx?.restore()\n  }\n\n  init() {\n    if (this.canvas) {\n      this.app.mountEL.removeChild(this.canvas.el)\n    }\n    this.width = this.app.width\n    this.height = this.app.height\n    this.canvas = new Canvas(this.width, this.height, {\n      className: 'selection'\n    })\n    this.ctx = this.canvas.ctx\n    this.app.mountEL.appendChild(this.canvas.el)\n  }\n}\n","import EventEmitter from 'eventemitter3'\n\nimport { getFontString, getTextNodeSize } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class TextEdit extends EventEmitter {\n  private readonly app: AppObject\n\n  private editable: undefined | HTMLTextAreaElement\n\n  isEditing: boolean\n\n  constructor(app: AppObject) {\n    super()\n    this.app = app\n    this.editable = undefined\n    this.isEditing = false\n    this.onTextInput = this.onTextInput.bind(this)\n    this.onTextBlur = this.onTextBlur.bind(this)\n  }\n\n  // Show text edit box\n  showTextEdit() {\n    if (!this.editable) {\n      this.crateTextInputEl()\n    } else {\n      this.editable.style.display = 'block'\n    }\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    this.updateTextInputStyle()\n    this.editable.focus()\n    this.editable.select()\n    this.isEditing = true\n  }\n\n  // Text input events\n  onTextInput() {\n    const { activeNode } = this.app.nodes\n    if (!activeNode) {\n      return\n    }\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    activeNode.text = this.editable.value\n    const { width, height } = getTextNodeSize(activeNode)\n    activeNode.width = width\n    activeNode.height = height\n    this.updateTextInputStyle()\n  }\n\n  // Text box out-of-focus event\n  onTextBlur() {\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    this.editable.style.display = 'none'\n    this.editable.value = ''\n    this.emit('blur')\n    this.isEditing = false\n  }\n\n  // Create text input box graphic objects\n  crateTextInputEl() {\n    this.editable = document.createElement('textarea')\n    this.editable.dir = 'auto'\n    this.editable.tabIndex = 0\n    this.editable.wrap = 'off'\n    this.editable.className = 'textInput'\n    Object.assign(this.editable.style, {\n      position: 'fixed',\n      display: 'block',\n      minHeight: '1em',\n      backfaceVisibility: 'hidden',\n      margin: 0,\n      padding: 0,\n      border: 0,\n      outline: 0,\n      resize: 'none',\n      background: 'transparent',\n      overflow: 'hidden',\n      whiteSpace: 'pre'\n    })\n    this.editable.addEventListener('input', this.onTextInput)\n    this.editable.addEventListener('blur', this.onTextBlur)\n    document.body.appendChild(this.editable)\n  }\n\n  // Update the style of the text input box according to the style of the current text graphic object\n  updateTextInputStyle() {\n    const { activeNode } = this.app.nodes\n    if (!activeNode) {\n      return\n    }\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    let { x, y }: any = activeNode\n    const { width, height, style, text, rotate }: any = activeNode\n    const { calculate, state } = this.app\n    this.editable.value = text\n    x = calculate.subScrollX(x)\n    y = calculate.subScrollY(y)\n    if (typeof state.scale === 'undefined') {\n      return\n    }\n    // Screen coordinates to canvas coordinates\n    const sp = calculate.scale(x, y)\n    const tp = calculate.mountELToWindow(sp.x, sp.y)\n    const fontSize = style.fontSize * state.scale\n    const styles = {\n      font: getFontString(fontSize, style.fontFamily),\n      lineHeight: `${fontSize * style.lineHeightRatio}px`,\n      left: `${tp.x}px`,\n      top: `${tp.y}px`,\n      color: style.fillStyle,\n      width: `${Math.max(width, 100) * state.scale}px`,\n      height: `${height * state.scale}px`,\n      transform: `rotate(${rotate}deg)`,\n      opacity: style.globalAlpha\n    }\n    Object.assign(this.editable.style, styles)\n  }\n}\n","import {\n  DiffNodesRes,\n  DiffStateRes,\n  LocalData,\n  NodeArray,\n  State\n} from '../../types'\n\n// Depth-first traversal based on key to determine if equal\nexport function isEqual(oldData: any, nowData: any) {\n  if (typeof oldData !== typeof nowData) {\n    return false\n  }\n  if (typeof oldData !== 'object') {\n    return oldData === nowData\n  }\n  const oldKeys = Object.keys(oldData)\n  const nowKeys = Object.keys(nowData)\n  if (oldKeys.length !== nowKeys.length) {\n    return false\n  }\n  for (let i = 0; i < oldKeys.length; i += 1) {\n    const key = oldKeys[i]\n    if (!isEqual(oldData[key], nowData[key])) {\n      return false\n    }\n  }\n  return true\n}\n\n// diff nodes\nexport function getDiffData(\n  oldData: LocalData | undefined,\n  nowData: LocalData\n) {\n  const isUNOld = typeof oldData === 'undefined'\n  const isUNNow = typeof nowData === 'undefined'\n\n  if (isUNOld && isUNNow) {\n    return undefined\n  }\n  if (isUNOld) {\n    return {\n      type: 'cover-all',\n      nodes: nowData.nodes\n    }\n  }\n\n  if (isUNNow || (isUNOld && nowData.nodes.length === 0)) {\n    return {\n      type: 'delete-all'\n    }\n  }\n\n  if (isEqual(oldData.nodes, nowData.nodes)) {\n    return undefined\n  }\n  const oldNodes = oldData.nodes || []\n  const nowNodes = nowData.nodes || []\n  const oldLen = oldNodes.length\n  const nowLen = nowNodes.length\n  // Add｜Delete Operation\n  const isAdd = nowLen > oldLen\n  const isDelete = nowLen < oldLen\n  if (isAdd || isDelete) {\n    const ANodes = isAdd ? nowNodes : oldNodes\n    const PIDs = isAdd\n      ? oldNodes.map((item) => item.id)\n      : nowNodes.map((item) => item.id)\n    let diffNodes = ANodes.filter((item) => !PIDs.includes(item.id))\n    if (isDelete) {\n      diffNodes = diffNodes.map((item) => ({ id: item.id })) as any\n    }\n    return {\n      type: isAdd ? 'add' : 'delete',\n      nodes: diffNodes\n    }\n  }\n  if (nowLen === oldLen) {\n    const updateNodes = []\n    // Determine which attributes have changed and store those that have changed, but not those that have not\n    for (let i = 0; i < nowLen; i += 1) {\n      if (!isEqual(oldNodes[i], nowNodes[i])) {\n        if ('coordinateArr' in nowNodes[i] || 'coordinateArr' in oldNodes[i]) {\n          break\n        }\n        const diff: any = {}\n        Object.keys(nowNodes[i]).forEach((key) => {\n          // @ts-ignore\n          if (!isEqual(oldNodes[i][key], nowNodes[i][key])) {\n            // @ts-ignore\n            diff[key] = nowNodes[i][key]\n          }\n        })\n        diff.id = nowNodes[i].id\n        updateNodes.push(diff)\n      }\n    }\n    if (updateNodes.length > 0) {\n      return {\n        type: 'update',\n        nodes: updateNodes\n      }\n    }\n  }\n  return undefined\n}\n\nexport function parseDiffNodes(\n  oldNodes: NodeArray,\n  { type, nodes }: DiffNodesRes\n): NodeArray {\n  const fns = {\n    add: () => {\n      oldNodes.push(...nodes)\n    },\n    delete: () => {\n      nodes.forEach((item) => {\n        const index = oldNodes.findIndex((node) => node.id === item.id)\n        oldNodes.splice(index, 1)\n      })\n    },\n    update: () => {\n      nodes.forEach((item) => {\n        const index = oldNodes.findIndex((node) => node.id === item.id)\n        oldNodes[index] = { ...oldNodes[index], ...item }\n      })\n    },\n    'cover-all': () => {\n      oldNodes.splice(0, oldNodes.length, ...nodes)\n    },\n    'delete-all': () => {\n      oldNodes.splice(0, oldNodes.length)\n    }\n  }\n  fns[type]()\n  return oldNodes\n}\n\n// diff state att: ( backgroundColor / showGrid / showGrid )\nexport function getDiffState(\n  oldData: LocalData | undefined,\n  nowData: LocalData\n) {\n  const oldState = oldData?.state\n  if (typeof oldState === 'undefined') {\n    return undefined\n  }\n  const nowState = nowData?.state\n  const isDiffBac = oldState.backgroundColor !== nowState.backgroundColor\n  const isDiffGrid = oldState.showGrid !== nowState.showGrid\n  const isDiffReadonly = oldState.readonly !== nowState.readonly\n  const isDiffScrollY = oldState.scrollY !== nowState.scrollY\n  const isDiffScrollX = oldState.scrollX !== nowState.scrollX\n  const isDiffScale = oldState.scale !== nowState.scale\n\n  if (isDiffBac || isDiffGrid || isDiffReadonly) {\n    const state: any = {}\n    if (isDiffBac) {\n      state.backgroundColor = nowState.backgroundColor\n    }\n    if (isDiffGrid) {\n      state.showGrid = nowState.showGrid\n    }\n    if (isDiffReadonly) {\n      state.readonly = nowState.readonly\n    }\n    if (isDiffScrollY) {\n      state.scrollY = nowState.scrollY\n    }\n    if (isDiffScrollX) {\n      state.scrollX = nowState.scrollX\n    }\n    if (isDiffScale) {\n      state.scale = nowState.scale\n    }\n    return {\n      type: 'update-state',\n      state\n    }\n  }\n  return undefined\n}\n\nexport function parseDiffState(oldState: State, { state }: DiffStateRes) {\n  Object.keys(state).forEach((key) => {\n    // @ts-ignore\n    oldState[key] = state[key]\n  })\n  return oldState\n}\n","import EventEmitter from 'eventemitter3'\n\nimport Author from './classFile/Author'\nimport Background from './classFile/Background'\nimport Cursor from './classFile/Cursor'\nimport Event from './classFile/Event'\nimport Export from './classFile/Export'\nimport Grid from './classFile/Grid'\nimport History from './classFile/History'\nimport ImageEdit from './classFile/ImageEdit'\nimport KeyCommand from './classFile/KeyCommand'\nimport Nodes from './classFile/Nodes'\nimport Render from './classFile/Render'\nimport Selection from './classFile/Selection'\nimport TextEdit from './classFile/TextEdit'\nimport {\n  createCanvas,\n  createImageObj,\n  getTowCoordinateDistance,\n  throttle\n} from './common/utils'\nimport Calculate from './common/utils/Calculate'\nimport {\n  getDiffData,\n  getDiffState,\n  parseDiffNodes,\n  parseDiffState\n} from './common/utils/diffData'\nimport {\n  Ctx,\n  DiffNodesRes,\n  DiffStateRes,\n  LocalData,\n  Node,\n  OnCallBack,\n  PlotType,\n  State\n} from './types'\n\ntype Options = {\n  mountEL: HTMLElement | HTMLDivElement\n  plotType?: PlotType\n  state?: State\n}\n\nclass CreatLoader extends EventEmitter {\n  public options: Options\n\n  public readonly mountEL: HTMLElement | HTMLDivElement\n\n  public plotType: any\n\n  public width: number\n\n  public height: number\n\n  public left: number\n\n  public top: number\n\n  public canvas: HTMLCanvasElement | undefined\n\n  public ctx: Ctx | undefined\n\n  public state: State\n\n  public calculate: Calculate\n\n  public event: Event\n\n  public keyCommand: KeyCommand\n\n  public imageEdit: ImageEdit\n\n  public textEdit: TextEdit\n\n  public cursor: Cursor\n\n  public history: History\n\n  public export: Export\n\n  public background: Background\n\n  public selection: Selection\n\n  public grid: Grid\n\n  public author: Author\n\n  public nodes: any\n\n  public render: Render\n\n  public watch: any\n\n  static utils: any\n\n  static checkClick: any\n\n  static plot: any\n\n  static nodes: any\n\n  public oldData: undefined\n\n  constructor(options: Options) {\n    super()\n\n    this.options = options\n\n    this.mountEL = options.mountEL\n\n    this.plotType = options.plotType || 'selection'\n\n    // Container width and height position information\n    this.width = 0\n    this.height = 0\n    this.left = 0\n    this.top = 0\n\n    // Main rendering canvas graphics objects\n    this.canvas = undefined\n\n    // canvas drawing context\n    this.ctx = undefined\n\n    // Canvas state\n    this.state = {\n      // resizing\n      scale: 1,\n      // Scroll offset in horizontal direction\n      scrollX: 0,\n      // Scroll offset in vertical direction\n      scrollY: 0,\n      // Rolling step\n      scrollStep: 25,\n      // Background colour\n      backgroundColor: '',\n      // Whether to display the grid or not\n      showGrid: false,\n      // Is it read-only mode\n      readonly: false,\n      // Default colour\n      defaultColor: '#000000',\n      // Grid configuration\n      gridConfig: {\n        // Grid size\n        size: 20,\n        // Grid line colours\n        strokeStyle: '#dfe0e1',\n        // Mesh line width\n        lineWidth: 1\n      },\n      // Coverage\n      ...(options.state || {})\n    } as any\n\n    this.initCanvas()\n\n    this.calculate = new Calculate(this as any)\n\n    this.event = new Event(this as any)\n    this.event.on('mousedown', this.onMousedown, this)\n    this.event.on('mousemove', this.onMousemove, this)\n    this.event.on('mouseup', this.onMouseup, this)\n    this.event.on('dblclick', this.onDblclick, this)\n    this.event.on('mousewheel', this.onMousewheel, this)\n    this.event.on('contextmenu', this.onContextmenu, this)\n\n    this.keyCommand = new KeyCommand(this as any)\n\n    this.imageEdit = new ImageEdit(this as any)\n    this.imageEdit.on('imageSelectChange', this.onImageSelectChange, this)\n\n    this.textEdit = new TextEdit(this as any)\n    this.textEdit.on('blur', this.onTextInputBlur, this)\n\n    this.cursor = new Cursor(this as any)\n\n    this.history = new History(this as any)\n\n    this.export = new Export(this as any)\n\n    this.background = new Background(this as any)\n\n    this.selection = new Selection(this as any)\n\n    this.grid = new Grid(this as any)\n\n    this.nodes = new Nodes(this as any)\n\n    this.render = new Render(this as any)\n\n    this.author = new Author(this as any)\n\n    this.mountFunction()\n\n    this.checkIsOnNode = throttle(this.checkIsOnNode, this as any)\n\n    this.emitChange()\n\n    this.helpUpdate()\n\n    this.watch = {\n      zoomChange: (callback: OnCallBack) => this.on('zoomChange', callback),\n      scrollChange: (callback: OnCallBack) => this.on('scrollChange', callback),\n      currentTypeChange: (callback: OnCallBack) =>\n        this.on('currentTypeChange', callback),\n      shuttle: (callback: OnCallBack) => this.on('shuttle', callback),\n      activeNodeChange: (callback: OnCallBack) =>\n        this.on('activeNodeChange', callback),\n      multiplexSelectChange: (callback: OnCallBack) =>\n        this.on('multiplexSelectChange', callback),\n      contextmenu: (callback: OnCallBack) => this.on('contextmenu', callback),\n      diffNodesChange: (callback: OnCallBack) =>\n        this.on('diffNodesChange', callback),\n      diffStateChange: (callback: OnCallBack) =>\n        this.on('diffStateChange', callback),\n      localDataChange: (callback: OnCallBack) => this.on('change', callback),\n      nodeRotateChange: (callback: OnCallBack) =>\n        this.on('nodeRotateChange', callback)\n    }\n  }\n\n  mountFunction() {\n    ;['exportImage', 'exportJson'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.export[method].bind(this.export)\n    })\n    ;['showGrid', 'hideGrid', 'updateGrid'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.grid[method].bind(this.grid)\n    })\n    ;['setEditAuthor', 'setReadonlyAuthor'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.author[method].bind(this.author)\n    })\n    ;['undo', 'redo'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.history[method].bind(this.history)\n    })\n    ;['unBindEvent', 'bindEvent'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.keyCommand[method].bind(this.keyCommand)\n    })\n    ;['setSelectedNodeStyle', 'cancelSelectNodes'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.selection[method].bind(this.selection)\n    })\n    ;[\n      'updateActiveNodeRotate',\n      'updateActiveNodeSize',\n      'updateActiveNodePosition',\n      'cancelActiveNode',\n      'scrollToCenter',\n      'copyPasteCurrentNodes',\n      'empty',\n      'zoomIn',\n      'zoomOut',\n      'setZoom',\n      'selectAll',\n      'fit',\n      'deleteActiveNode',\n      'deleteCurrentNodes',\n      'setBackgroundColor',\n      'copyNode',\n      'copyCurrentNode',\n      'deleteNode',\n      'setActiveNodeStyle',\n      'setCurrentNodesStyle',\n      'scrollTo',\n      'cutCurrentNode',\n      'pasteCurrentNode'\n    ].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.render[method].bind(this.render)\n    })\n  }\n\n  // Access to data, including state data and graphical object data\n  getData() {\n    return {\n      state: {\n        ...this.state\n      },\n      nodes: this.nodes.serialize()\n    }\n  }\n\n  // Image selection events\n  onImageSelectChange() {\n    this.cursor.hide()\n  }\n\n  // Get container size location information\n  getContainerRectInfo() {\n    const { width, height, left, top } = this.mountEL.getBoundingClientRect()\n    this.width = width\n    this.height = height\n    this.left = left\n    this.top = top\n  }\n\n  // Rendering as necessary\n  helpUpdate() {\n    if (this.state.readonly) {\n      // @ts-ignore\n      this.setReadonlyAuthor()\n    }\n    if (this.state.showGrid) {\n      this.grid.showGrid()\n    }\n    this.background.set()\n  }\n\n  // Setting data, including status data and graphic object data\n  async setData(\n    { state = {}, nodes = [] }: any,\n    noEmitChange: boolean,\n    noDiffData?: boolean\n  ) {\n    this.state = state\n\n    const nowNs = nodes.map(async (node: Node) => {\n      if (node.type === 'image') {\n        return {\n          ...node,\n          imageObj: await createImageObj(<string>node.url)\n        }\n      }\n      return node\n    })\n\n    const nNS: any[] = []\n\n    for (const n of nowNs) {\n      // eslint-disable-next-line no-await-in-loop\n      nNS.push(await n)\n    }\n\n    this.helpUpdate()\n    this.nodes.deleteAllNodes().createNodesFromData(nNS)\n    this.render.render()\n    if (!noEmitChange) {\n      this.emitChange(noDiffData)\n    }\n  }\n\n  initCanvas() {\n    this.getContainerRectInfo()\n    if (this.canvas) {\n      this.mountEL.removeChild(this.canvas)\n    }\n    const { canvas, ctx }: any = createCanvas(this.width, this.height, {\n      className: 'main'\n    })\n    this.canvas = canvas\n    this.ctx = ctx\n    this.mountEL.appendChild(this.canvas as any)\n    console.log('a')\n  }\n\n  // Container resizing\n  resize() {\n    this.initCanvas()\n    this.render.render()\n    this.selection.init()\n    this.grid.init()\n    this.grid.renderGrid()\n  }\n\n  // Updating the state data only updates the state data and does not trigger a render\n  updateState(data = {}) {\n    this.state = {\n      ...this.state,\n      ...data\n    }\n    this.emitChange(undefined, true)\n  }\n\n  // Update current drawing type\n  updateCurrentType(plotType: PlotType) {\n    this.plotType = plotType\n    if (this.plotType === 'image') {\n      this.imageEdit.selectImage()\n    }\n    if (this.plotType === 'eraser') {\n      this.cursor.setEraser()\n      // @ts-ignore\n      this.cancelActiveNode()\n    } else if (this.plotType === 'text') {\n      this.cursor.setText()\n    } else if (this.plotType !== 'selection') {\n      this.cursor.setCrossHair()\n    } else {\n      this.cursor.reset()\n    }\n    this.emit('currentTypeChange', this.plotType)\n  }\n\n  // Mouse press event\n  onMousedown(\n    e: {\n      unGridClientX?: number\n      unGridClientY?: number\n      originEvent?: { which: number }\n    },\n    event: { mousedownPos: any }\n  ) {\n    if (this.state.readonly || this.author.isDragAuthor) {\n      this.author.onStart()\n      return\n    }\n    if (!this.nodes.isCreateNode && !this.textEdit.isEditing) {\n      const clickNode = this.nodes.checkIsClickNode(e)\n      if (this.plotType === 'selection') {\n        if (this.nodes.hasActiveNode()) {\n          const isResize = this.nodes.checkIsResize(\n            event.mousedownPos.unGridClientX,\n            event.mousedownPos.unGridClientY,\n            e\n          )\n          if (!isResize) {\n            this.nodes.setActiveNode(clickNode as any)\n            this.render.render()\n          }\n        } else if (this.selection.hasSelection) {\n          const isResize = this.selection.checkIsResize(\n            event.mousedownPos.unGridClientX,\n            event.mousedownPos.unGridClientY,\n            e\n          )\n          if (!isResize) {\n            this.selection.reset()\n            this.nodes.setActiveNode(clickNode as any)\n            this.render.render()\n          }\n        } else if (clickNode) {\n          this.nodes.setActiveNode(clickNode)\n          this.render.render()\n          this.onMousedown(e, event)\n        } else {\n          this.selection.onMousedown(e as any, event)\n        }\n      } else if (this.plotType === 'eraser') {\n        // @ts-ignore\n        this.deleteNode(clickNode)\n      }\n    }\n  }\n\n  // Mouse movement events\n  onMousemove(e: any, event: any) {\n    // TODO : Real-time synchronisation, currently on mouse up, expected to be on mouse over\n    if (this.state.readonly || this.author.isDragAuthor) {\n      if (event.isMousedown) {\n        this.author.onMove(e, event)\n      }\n      return\n    }\n    if (event.isMousedown) {\n      const mx = event.mousedownPos.x\n      const my = event.mousedownPos.y\n      const offsetX = Math.max(event.mouseOffset.x, 0)\n      const offsetY = Math.max(event.mouseOffset.y, 0)\n      if (this.plotType === 'selection') {\n        if (this.selection.isResize) {\n          this.selection.handleResize(\n            e,\n            mx,\n            my,\n            event.mouseOffset.x,\n            event.mouseOffset.y\n          )\n        } else if (this.selection.createSelection) {\n          this.selection.onMousemove(e, event)\n        } else {\n          this.nodes.handleResize(\n            e,\n            mx,\n            my,\n            event.mouseOffset.x,\n            event.mouseOffset.y\n          )\n          this.render.render()\n        }\n      } else if (['rectangle', 'diamond', 'triangle'].includes(this.plotType)) {\n        this.nodes.createRectangleLikeNode(\n          this.plotType,\n          mx,\n          my,\n          offsetX,\n          offsetY\n        )\n        this.render.render()\n      } else if (this.plotType === 'circle') {\n        this.nodes.createCircle(mx, my, e)\n        this.render.render()\n      } else if (this.plotType === 'arbitrary-plot') {\n        this.nodes.createArbitraryPlot(e, event)\n      } else if (this.plotType === 'arrow') {\n        this.nodes.createArrow(mx, my, e)\n        this.render.render()\n      } else if (this.plotType === 'line') {\n        if (getTowCoordinateDistance(mx, my, e.clientX, e.clientY) > 3) {\n          this.nodes.createLine(mx, my, e, true)\n          this.render.render()\n        }\n      }\n    } else if (this.imageEdit.isReady) {\n      this.cursor.hide()\n      this.imageEdit.updatePreviewElPos(\n        e.originEvent.clientX,\n        e.originEvent.clientY\n      )\n    } else if (this.plotType === 'selection') {\n      if (this.nodes.hasActiveNode()) {\n        const handData: any = ''\n        const h = this.nodes.checkInResizeHand(e.unGridClientX, e.unGridClientY)\n        if (h) {\n          this.cursor.setResize(handData.hand)\n        } else {\n          // @ts-ignore\n          this.checkIsOnNode(e)\n        }\n      } else if (this.selection.hasSelection) {\n        const hand = this.selection.checkInResizeHand(\n          e.unGridClientX,\n          e.unGridClientY\n        )\n        if (hand) {\n          this.cursor.setResize(hand)\n        } else {\n          // @ts-ignore\n          this.checkIsOnNode(e)\n        }\n      } else {\n        // @ts-ignore\n        this.checkIsOnNode(e)\n      }\n    } else if (this.plotType === 'line') {\n      this.nodes.createLine(undefined, undefined, e, false, true)\n      this.render.render()\n    }\n  }\n\n  // Detects if a graphic object has been slid over\n  checkIsOnNode(e: { unGridClientX: number; unGridClientY: number }) {\n    const clickNode = this.nodes.checkIsClickNode(e)\n    if (clickNode) {\n      this.cursor.setMove()\n    } else {\n      this.cursor.reset()\n    }\n  }\n\n  // Reset current type to selection mode\n  resetCurrentType() {\n    if (this.plotType !== 'selection') {\n      this.plotType = 'selection'\n      this.emit('currentTypeChange', 'selection')\n    }\n  }\n\n  // Creation of new graphic objects complete\n  completeCreateNewNode() {\n    this.resetCurrentType()\n    this.nodes.completeCreateNode()\n    this.render.render()\n  }\n\n  // Mouse release event\n  onMouseup(e: any) {\n    if (this.state.readonly || this.author.isDragAuthor) {\n      return\n    }\n    if (this.plotType === 'text') {\n      if (!this.textEdit.isEditing) {\n        this.createTextNode(e)\n        this.resetCurrentType()\n      }\n    } else if (this.imageEdit.isReady) {\n      this.nodes.createImage(e, this.imageEdit.imageData as any)\n      this.completeCreateNewNode()\n      this.cursor.reset()\n      this.imageEdit.reset()\n    } else if (this.plotType === 'arrow') {\n      this.nodes.completeCreateArrow(e)\n      this.completeCreateNewNode()\n    } else if (this.plotType === 'line') {\n      this.nodes.completeCreateLine(e, () => {\n        this.completeCreateNewNode()\n      })\n      this.render.render()\n    } else if (this.nodes.isCreateNode) {\n      if (this.plotType === 'arbitrary-plot') {\n        this.nodes.completeCreateNode()\n        this.nodes.setActiveNode()\n      } else {\n        this.completeCreateNewNode()\n      }\n    } else if (this.nodes.isResize) {\n      this.nodes.endResize()\n      this.emitChange()\n    } else if (this.selection.createSelection) {\n      this.selection.onMouseup()\n    } else if (this.selection.isResize) {\n      this.selection.endResize()\n      this.emitChange()\n    }\n  }\n\n  // Double click event\n  onDblclick(e: { unGridClientX: number; unGridClientY: number }) {\n    if (this.plotType === 'line') {\n      this.completeCreateNewNode()\n    } else {\n      const clickNode = this.nodes.checkIsClickNode(e)\n      if (clickNode) {\n        if (clickNode.type === 'text') {\n          this.nodes.editingText(clickNode)\n          this.render.render()\n          this.keyCommand.unBindEvent()\n          this.textEdit.showTextEdit()\n        }\n      } else if (!this.textEdit.isEditing) {\n        // @ts-ignore\n        this.createTextNode(e)\n      }\n    }\n  }\n\n  // Text box out-of-focus event\n  onTextInputBlur() {\n    this.keyCommand.bindEvent()\n    this.nodes.completeEditingText()\n    this.render.render()\n    this.emitChange()\n  }\n\n  // Creating text graphic objects\n  createTextNode(e: { clientX: any; clientY: any }) {\n    this.nodes.createNode({\n      type: 'text',\n      x: e.clientX,\n      y: e.clientY\n    })\n    this.keyCommand.unBindEvent()\n    this.textEdit.showTextEdit()\n  }\n\n  // Mouse scroll event\n  onMousewheel(dir: string) {\n    if (\n      typeof this.state.scrollStep === 'undefined' ||\n      typeof this.state.scale === 'undefined'\n    ) {\n      return\n    }\n    const stepNum = this.state.scrollStep / this.state.scale\n    const step = dir === 'down' ? stepNum : -stepNum\n    // @ts-ignore\n    this.scrollTo(this.state.scrollX, this.state.scrollY + step)\n  }\n\n  // Right-click menu events\n  onContextmenu(e: { originEvent: any }) {\n    let el: any\n    if (this.nodes.hasActiveNode()) {\n      el = [this.nodes.activeNode]\n    } else if (this.selection.hasSelectionNodes()) {\n      el = this.selection.getSelectionNodes()\n    }\n    this.emit('contextmenu', e.originEvent, el)\n  }\n\n  unBindEvent() {\n    this.keyCommand.unBindEvent()\n  }\n\n  bindEvent() {\n    this.keyCommand.bindEvent()\n  }\n\n  emitNodeRotateChange(rotate: number) {\n    this.emit('nodeRotateChange', rotate)\n  }\n\n  // Triggering update events\n  emitChange(noDiffData?: boolean, noHistory?: boolean) {\n    const data = this.getData()\n    const oldData = this.history.now()\n    if (\n      ((typeof oldData === 'undefined' && data.nodes.length !== 0) ||\n        typeof oldData !== 'undefined') &&\n      !noHistory\n    ) {\n      this.history.add(<LocalData>data)\n    }\n    if (!noDiffData) {\n      this.emitDiffNodesChange(oldData, data)\n      this.emitDiffStateChange(oldData, data)\n    }\n    this.emit('change', data)\n  }\n\n  // Customised data object update triggers with diff algorithm processing\n  emitDiffNodesChange(oldData: LocalData, nowData: LocalData) {\n    const diffRes = getDiffData(oldData, nowData)\n    if (typeof diffRes === 'object') {\n      this.emit('diffNodesChange', diffRes)\n    }\n  }\n\n  // Customised data state update triggers with diff algorithm processing\n  emitDiffStateChange(oldData: LocalData, nowData: LocalData) {\n    const diffRes = getDiffState(oldData, nowData)\n    if (typeof diffRes !== 'undefined') {\n      this.emit('diffStateChange', diffRes)\n    }\n  }\n\n  async parseSetDiffData(config: DiffNodesRes | DiffStateRes) {\n    const oldData = this.getData()\n    const newData: any = {}\n    if (config.type === 'update-state') {\n      newData.nodes = oldData.nodes\n      newData.state = parseDiffState(oldData.nodes, config)\n    } else {\n      newData.state = oldData.state\n      newData.nodes = parseDiffNodes(oldData.nodes, config)\n    }\n    await this.setData(newData, false, true)\n  }\n}\n\nexport default CreatLoader\n","import CreatLoader from './API'\nimport { AppResponse, AppState } from './types'\n\nexport default function creatLoader(state: AppState) {\n  function mount(mountEl: string | Object | HTMLElement): AppResponse {\n    // get DOM\n    const el =\n      typeof mountEl === 'string' ? document.querySelector(mountEl) : mountEl\n    // check\n    if (!el || !(el instanceof HTMLElement)) {\n      throw new Error('mountEl is not a HTMLElement !')\n    }\n    if (\n      !['absolute', 'fixed', 'relative'].includes(\n        window.getComputedStyle(<HTMLElement>el).position\n      )\n    ) {\n      throw new Error(\n        'The DOM being mounted needs to be set to absolute/fixed/relative positioning!'\n      )\n    }\n    // init\n    return new CreatLoader({\n      mountEL: el as any,\n      plotType: state.plotType,\n      state\n    }) as unknown as AppResponse\n  }\n  return { mount }\n}\n"],"names":["keyPosit","0","1","2","3","4","5","6","7","8","9","Backspace","Tab","Enter","Shift","Control","Alt","CapsLock","Esc","Space","PageUp","PageDown","End","Home","Insert","Left","Up","Right","Down","Del","NumLock","Cmd","CmdFF","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","`","=","+","-","'","/",".","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CLICK_DISTANCE","FOUR_CORNER","TOP_LEFT","TOP_RIGHT","BOTTOM_RIGHT","BOTTOM_LEFT","DRAG_NODE_PARTS","BODY","ROTATE","TOP_LEFT_BUTTON","TOP_RIGHT_BUTTON","BOTTOM_RIGHT_BUTTON","BOTTOM_LEFT_BUTTON","getNodeID","Math","floor","random","Date","getTime","toString","let","nodeKeyIndex","createNodeKey","deepCopy","JSON","parse","stringify","obj","throttle","fn","ctx","time","_timer","args","setTimeout","call","getFontString","fontSize","fontFamily","splitTextLines","text","replace","split","radToDeg","rad","PI","degToRad","deg","createCanvas","width","height","option","noStyle","noTranslate","className","canvas","document","createElement","style","cssText","getContext","translate","getTowCoordinateDistance","x1","y1","x2","y2","sqrt","getCoordinateToLineDistance","abs","A","B","checkIsAtSegment","dis","dis1","dis2","dis3","max","getTowCoordinateRotate","cx","cy","tx","ty","fx","fy","atan2","getRotatedCoordinate","rotate","del","cos","sin","getNodeCenterCoordinate","node","transformCoordinateReverseRotate","rp","transformCoordinateOnNode","center","getNodeFourCornerCoordinate","dir","getBoundingRect","coordinateArr","returnFourCorners","minX","Infinity","maxX","minY","maxY","forEach","coordinate","getNodeRotatedFourCornerCoordinate","dirPos","checkCoordinateIsInRectangle","rx","ry","rw","rh","getMultiplexNodeRectInfo","nodeList","length","getEndCoordinateList","textCheckEl","getTextActWidth","position","left","body","appendChild","innerText","getBoundingClientRect","getNodeFourCorners","bottomRight","createImageObj","Promise","img","Image","setAttribute","onload","resolve","onerror","src","url","getWrapTextActWidth","textArr","maxWidth","textRow","getTextNodeSize","lineHeightRatio","computedLineWidthBySpeed","speed","lastLineWidth","baseLineWidth","lineWidth","maxLineWidth","Author","app","startScrollX","startScrollY","isDragAuthor","constructor","this","onMove","bindEvent","onStart","state","scrollX","scrollY","event","scale","scrollTo","mouseOffset","originX","originY","on","keyCode","cursor","set","setEditAuthor","updateState","readonly","setReadonlyAuthor","cancelActiveNode","Background","backgroundColor","addBackgroundColor","remove","mountEL","canvasAddBackgroundColor","save","rect","fillStyle","fill","restore","Cursor","currentType","type","setEraser","setText","setMove","hide","reset","setCrossHair","setResize","direction","Event","EventEmitter","calculate","lastMousePos","mouseDistance","lastMouseTime","mouseDuration","mouseSpeed","isMousedown","mousedownPos","super","now","unGridClientX","unGridClientY","originClientX","originClientY","onMousedown","bind","onMousemove","onMouseup","onDblclick","onMousewheel","onKeydown","onKeyup","onContextmenu","transformEvent","emit","originEvent","wheelDelta","stopPropagation","preventDefault","clientX","clientY","curTime","wp","windowToContainer","reverseScale","addScrollX","addScrollY","gp","gridAdsorbent","addEventListener","window","unbindEvent","removeEventListener","Export","openPreview","saveState","exportJson","getData","render","onlySelected","getNodeList","cacheActive","cacheSelected","noRender","isActive","isSelected","saveAppState","exportImage","renderBg","useBlob","paddingX","paddingY","show","changeAppState","recoveryAppState","reject","toBlob","blob","toDataURL","console","error","nodes","selectedNodes","activeNode","push","selection","hasSelectionNodes","getSelectionNodes","filter","includes","Canvas","el","opt","clearCanvas","clearRect","Grid","init","renderGrid","renderVerticalLines","gridConfig","maxRight","size","plotVerticalLine","subScrollX","renderHorizontalLines","maxBottom","plotHorizontalLine","subScrollY","showGrid","strokeStyle","_i","beginPath","moveTo","lineTo","stroke","hideGrid","updateGrid","config","removeChild","insertBefore","children","History","historyStack","index","fixIndex","emitChange","clear","add","data","prev","copyData","shuttle","oldData","fixLength","setData","then","emitDiffNodesChange","emitDiffStateChange","catch","undo","redo","ImageEdit","isReady","previewEl","imageData","maxHeight","maxRatio","onImageSelectChange","updatePreviewElPos","ratio","backgroundImage","backgroundSize","pointerEvents","tp","mountELToWindow","top","value","getImageUrl","file","reader","FileReader","onloadend","result","readAsDataURL","getImageSize","imageObj","await","target","files","selectImage","accept","click","KeyCommand","shortcutMap","getKeyCodeArr","key","keyArr","map","item","arr","getOriginEventCodeArr","ctrlKey","metaKey","altKey","shiftKey","checkKey","findIndex","splice","Object","keys","addShortcut","removeShortcut","unBindEvent","off","checkIsAtRectangleInner","getCircleRadius","min","checkIsAtMultiplexSegment","segments","res","seg","checkIsAtCircleEdge","radius","checkIsAtRectangleEdge","checkIsAtTriangleEdge","checkIsAtDiamondEdge","checkIsAtArrowEdge","checkIsAtArbitraryPlotLineEdge","checkIsAtLineEdge","len","BaseNode","id","isCreate","startX","startY","startRotate","dragNode","options","defaultColor","lineDash","globalAlpha","undefined","isClick","Error","offsetRotate","or","updateRotate","setStyle","_style","setLineDash","warpRender","renderFn","transform","halfWidth","halfHeight","move","ox","oy","emitNodeRotateChange","rotateByCenter","np","updatePos","startResize","resizeType","endResize","resize","handleResizeNode","updateRect","updateSize","serialize","renderDragNode","showAll","onlyShowBody","BaseMultiplexCoordinateNode","startCoordinateArr","startWidth","startHeight","fictitiousCoordinate","opts","scaleX","scaleY","slice","offsetX","offsetY","updateMultiplexCoordinateBoundingRect","addCoordinate","Array","isArray","updateFictitiousCoordinate","plotWrap","plotCircle","arc","plotArrow","lineDeg","plusDeg","_x","_y","plotRect","fillRect","plotDiamond","closePath","transformArbitraryLineCoordinate","plotLineSegment","mx","my","lineCap","lineJoin","plotTriangle","plotArbitraryLine","coordinates","nextCoordinate","plotText","textObj","lineHeight","font","textBaseline","fillText","plotImage","showWidth","showHeight","drawImage","plotLine","first","DragNode","offset","diagonalCoordinate","mousedownPosAndNodePosOffset","nodeRatio","hideParts","notNeedDragNode","lockRatio","handleDragMousedown","corner","centerPos","pos","handleMoveNode","handleRotateNode","handleStretchNode","newCenter","newRatio","newRect","newSize","setHideParts","parts","update","stretchCalc","calcSize","calcPos","isWidthReverse","isHeightReverse","newPos","fixPos","actClientX","actClientY","fixStretch","fp","fixNewRect","checkCoordinateInDragNodeWhere","part","_checkCoordinateIsInButton","ArbitraryPlot","singleRender","Arrow","realtimeCoordinate","concat","Circle","Diamond","Line","isSingle","Rectangle","Text","Triangle","Nodes","isCreateNode","isResize","resizeNode","handleResize","createNode","callback","notActive","hasActiveNode","pureCreateNode","addNode","setActiveNode","copyNode","async","gridAdsorbentPos","createRectangleLikeNode","createCircle","createArbitraryPlot","tfp","transformToCanvasCalculate","ttp","createImage","editingText","completeEditingText","trim","deleteNode","completeCreateArrow","createArrow","createLine","notCreate","insertNode","getNodesNum","hasNodes","unshiftNode","unshift","getNodeIndex","deleteAllNodes","createNodesFromData","nodeObject","checkIsClickNode","completeCreateLine","completeCallback","completeCreateNode","setActiveNodeStyle","checkInResizeHand","hand","checkIsResize","Render","beingCopyActiveNode","beingCopySelectedNodes","beingCopyNode","registerShortcutKeys","setCurrentNodesStyle","setSelectedNodeStyle","keyCommand","selectAll","setZoom","deleteCurrentNodes","copyCurrentNode","cutCurrentNode","history","grid","pasteCurrentNode","setMultiplexSelectNodes","useCurrentEventPos","copySelectionNodes","deleteActiveNode","deleteSelectedNodes","updateActiveNodePosition","updateActiveNodeSize","updateActiveNodeRotate","empty","zoomIn","num","zoomOut","zoom","fit","maxScale","scrollToCenter","copyPasteCurrentNodes","setBackgroundColor","color","background","selectNodes","Calculate","gridSize","transformToScreenCalculate","sp","MultiplexSelectNode","selectedNodeList","wholeCenterPos","updateNodes","exists","setSelectedNodeList","handleRotate","list","Selection","createSelection","hasSelection","rectangle","multiplexSelectNode","checkInNodes","_minX","_maxX","_minY","_maxY","endCoordinateList","task","all","renderSelection","cancelSelectNodes","notUpdateRect","which","TextEdit","editable","isEditing","onTextInput","onTextBlur","showTextEdit","display","crateTextInputEl","updateTextInputStyle","focus","select","tabIndex","wrap","assign","minHeight","backfaceVisibility","margin","padding","border","outline","overflow","whiteSpace","styles","opacity","isEqual","nowData","oldKeys","nowKeys","getDiffData","isUNOld","isUNNow","oldNodes","nowNodes","oldLen","nowLen","isAdd","isDelete","ANodes","PIDs","diffNodes","diff","parseDiffNodes","delete","cover-all","delete-all","getDiffState","isDiffBac","isDiffGrid","isDiffReadonly","isDiffScrollY","isDiffScrollX","oldState","nowState","isDiffScale","parseDiffState","CreatLoader","plotType","imageEdit","textEdit","export","author","watch","utils","checkClick","plot","scrollStep","initCanvas","onTextInputBlur","mountFunction","checkIsOnNode","helpUpdate","zoomChange","scrollChange","currentTypeChange","activeNodeChange","multiplexSelectChange","contextmenu","diffNodesChange","diffStateChange","localDataChange","nodeRotateChange","method","getContainerRectInfo","noEmitChange","noDiffData","nNS","log","updateCurrentType","clickNode","resetCurrentType","completeCreateNewNode","createTextNode","stepNum","noHistory","diffRes","parseSetDiffData","newData","creatLoader","mount","mountEl","querySelector","HTMLElement","getComputedStyle"],"mappings":"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"}