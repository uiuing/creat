{"version":3,"file":"creat-loader.global.js","sources":["src/common/constants.ts","src/common/utils/index.ts","src/classFile/Author.ts","src/classFile/Background.ts","src/classFile/Cursor.ts","src/classFile/Event.ts","src/classFile/Export.ts","src/support/Canvas.ts","src/classFile/Grid.ts","src/classFile/History.ts","src/classFile/ImageEdit.ts","src/classFile/KeyCommand.ts","src/common/utils/checkClick.ts","src/support/BaseNode.ts","src/support/BaseMultiplexCoordinateNode.ts","src/support/plot.ts","src/support/DragNode.ts","src/components/ArbitraryPlot.ts","src/components/Arrow.ts","src/components/Circle.ts","src/components/Diamond.ts","src/components/Image.ts","src/components/Line.ts","src/components/Rectangle.ts","src/components/Text.ts","src/components/Triangle.ts","src/classFile/Nodes.ts","src/classFile/Render.ts","src/common/utils/Calculate.ts","src/components/MultiplexSelectNode.ts","src/classFile/Selection.ts","src/classFile/TextEdit.ts","src/common/utils/diffData.ts","src/API.ts","src/index.ts"],"sourcesContent":["import { KeyPosit } from '../types'\n\n// The number key corresponding to the key position\nexport const keyPosit: KeyPosit = {\n  '0': 48,\n  '1': 49,\n  '2': 50,\n  '3': 51,\n  '4': 52,\n  '5': 53,\n  '6': 54,\n  '7': 55,\n  '8': 56,\n  '9': 57,\n  Backspace: 8,\n  Tab: 9,\n  Enter: 13,\n  Shift: 16,\n  Control: 17,\n  Alt: 18,\n  CapsLock: 20,\n  Esc: 27,\n  Space: 32,\n  PageUp: 33,\n  PageDown: 34,\n  End: 35,\n  Home: 36,\n  Insert: 45,\n  Left: 37,\n  Up: 38,\n  Right: 39,\n  Down: 40,\n  Del: 46,\n  NumLock: 144,\n  Cmd: 91,\n  CmdFF: 224,\n  F1: 112,\n  F2: 113,\n  F3: 114,\n  F4: 115,\n  F5: 116,\n  F6: 117,\n  F7: 118,\n  F8: 119,\n  F9: 120,\n  F10: 121,\n  F11: 122,\n  F12: 123,\n  '`': 192,\n  '=': 187,\n  '+': 187,\n  '-': 189,\n  \"'\": 222,\n  '/': 191,\n  '.': 190,\n  a: 65,\n  b: 66,\n  c: 67,\n  d: 68,\n  e: 69,\n  f: 70,\n  g: 71,\n  h: 72,\n  i: 73,\n  j: 74,\n  k: 75,\n  l: 76,\n  m: 77,\n  n: 78,\n  o: 79,\n  p: 80,\n  q: 81,\n  r: 82,\n  s: 83,\n  t: 84,\n  u: 85,\n  v: 86,\n  w: 87,\n  x: 88,\n  y: 89,\n  z: 90\n}\n// Click on the applicable trigger pixel range\nexport const CLICK_DISTANCE = 10\n\n// Four corners of a graphical object\nexport const FOUR_CORNER = {\n  TOP_LEFT: 'topLeft',\n  TOP_RIGHT: 'topRight',\n  BOTTOM_RIGHT: 'bottomRight',\n  BOTTOM_LEFT: 'bottomLeft'\n}\n\n// Drag and drop a part of a graphic object\nexport const DRAG_NODE_PARTS = {\n  BODY: 'body',\n  ROTATE: 'rotate',\n  TOP_LEFT_BUTTON: 'topLeftButton',\n  TOP_RIGHT_BUTTON: 'topRightButton',\n  BOTTOM_RIGHT_BUTTON: 'bottomRightButton',\n  BOTTOM_LEFT_BUTTON: 'bottomLeftButton'\n}\n","import { Ctx, LocalData, Node, NodeArray, Style } from '../../types'\n\n// Generate an ID, seeded with a timestamp + random number, with the first half random and the second half incremental\nexport function getNodeID() {\n  const seed = Math.floor(Math.random() * 1e12) * 1e7 + new Date().getTime()\n  return seed.toString(36)\n}\n\n// Unique key for graphical objects\nlet nodeKeyIndex = 0\nexport function createNodeKey() {\n  nodeKeyIndex += 1\n  return nodeKeyIndex\n}\n\nexport const deepCopy = (obj: LocalData) => JSON.parse(JSON.stringify(obj))\n\n// Download the file\nexport const downloadFile = (file: string, fileName: string) => {\n  const a = document.createElement('a')\n  a.href = file\n  a.download = fileName\n  a.click()\n}\n\n// Throttling\nexport const throttle = (fn: any, ctx: Ctx, time = 20) => {\n  let _timer: any = null\n  return (...args: any) => {\n    if (_timer) {\n      return\n    }\n    _timer = setTimeout(() => {\n      fn.call(ctx, ...args)\n      _timer = null\n    }, time)\n  }\n}\n\n// Spliced text font size string\nexport const getFontString = (fontSize: number, fontFamily: string) =>\n  `${fontSize}px ${fontFamily}`\n\n// Text cut into lines\nexport const splitTextLines = (text: string) =>\n  text.replace(/\\r\\n?/g, '\\n').split('\\n')\n\n// Curvature to angle\nexport const radToDeg = (rad: number) => rad * (180 / Math.PI)\n\n// Angle to radians\nexport const degToRad = (deg: number) => deg * (Math.PI / 180)\n\nexport const createCanvas = (\n  width: number,\n  height: number,\n  option: { noStyle?: boolean; noTranslate?: boolean; className?: string } = {\n    noStyle: false,\n    noTranslate: false,\n    className: ''\n  }\n) => {\n  const canvas = document.createElement('canvas')\n  if (!option.noStyle) {\n    canvas.style.cssText = `position: absolute;left: 0;top: 0;`\n  }\n  if (option.className) {\n    canvas.className = option.className\n  }\n  // Get Drawing Context\n  const ctx = canvas.getContext('2d')\n  canvas.width = width\n  canvas.height = height\n  // Move the canvas origin to the centre of the canvas\n  if (!option.noTranslate) {\n    ctx?.translate(canvas.width / 2, canvas.height / 2)\n  }\n  return {\n    canvas,\n    ctx\n  }\n}\n\n// Calculate the distance between two coordinates\nexport const getTowCoordinateDistance = (\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number\n) => Math.sqrt((x1 - x2) ** 2 + (y1 - y2) ** 2)\n\n// Calculate the distance from a point to a line\nexport const getCoordinateToLineDistance = (\n  x: number,\n  y: number,\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number\n) => {\n  // Straight line perpendicular to x-axis\n  if (x1 === x2) {\n    return Math.abs(x - x1)\n  }\n  const B = 1\n  const A = (y1 - y2) / (x2 - x1)\n  const C = 0 - B * y1 - A * x1\n  return Math.abs((A * x + B * y + C) / Math.sqrt(A * A + B * B))\n}\n\n// Check if you have clicked on a line segment\nexport const checkIsAtSegment = (\n  x: number,\n  y: number,\n  x1: number,\n  y1: number,\n  x2: number | undefined,\n  y2: number | undefined,\n  dis = 10\n) => {\n  if (typeof x2 === 'undefined' || typeof y2 === 'undefined') {\n    return false\n  }\n  if (getCoordinateToLineDistance(x, y, x1, y1, x2, y2) > dis) {\n    return false\n  }\n  const dis1 = getTowCoordinateDistance(x, y, x1, y1)\n  const dis2 = getTowCoordinateDistance(x, y, x2, y2)\n  const dis3 = getTowCoordinateDistance(x1, y1, x2, y2)\n  const max = Math.sqrt(dis * dis + dis3 * dis3)\n  return dis1 <= max && dis2 <= max\n}\n\n// Calculate the angle of difference between two coordinates with the same centre point\nexport const getTowCoordinateRotate = (\n  cx: number,\n  cy: number,\n  tx: number,\n  ty: number,\n  fx: number,\n  fy: number\n) => radToDeg(Math.atan2(ty - cy, tx - cx) - Math.atan2(fy - cy, fx - cx))\n\n// Get coordinates rotated by a specified angle from a specified centre, clockwise or anti-clockwise rotate by passing positive or negative\nexport const getRotatedCoordinate = (\n  x: number,\n  y: number,\n  cx: number,\n  cy: number,\n  rotate: number\n) => {\n  const deg = radToDeg(Math.atan2(y - cy, x - cx))\n  const del = deg + rotate\n  const dis = getTowCoordinateDistance(x, y, cx, cy)\n  return {\n    x: Math.cos(degToRad(del)) * dis + cx,\n    y: Math.sin(degToRad(del)) * dis + cy\n  }\n}\n\n// Get the coordinates of the element's centroid\nexport const getNodeCenterCoordinate = (node: any) => {\n  const { x, y, width, height }: any = node as Node\n  return {\n    x: x + width / 2,\n    y: y + height / 2\n  }\n}\n\n// Rotate the coordinates by the specified angle at the specified centre point\nexport const transformCoordinateReverseRotate = (\n  x: number,\n  y: number,\n  cx: number,\n  cy: number,\n  rotate: number\n) => {\n  if (rotate !== 0) {\n    const rp = getRotatedCoordinate(x, y, cx, cy, -rotate)\n    x = rp.x\n    y = rp.y\n  }\n  return {\n    x,\n    y\n  }\n}\n\n//  Handles mouse coordinates according to whether the element is rotated or not, if the element is rotated, then the mouse coordinates are rotated backwards\nexport const transformCoordinateOnNode = (x: number, y: number, node: any) => {\n  const center = getNodeCenterCoordinate(node as Node)\n  return transformCoordinateReverseRotate(\n    x,\n    y,\n    center.x,\n    center.y,\n    <number>node.rotate\n  )\n}\n\n// Get the four corner coordinates of the object\nexport const getNodeFourCornerCoordinate = (node: Node, dir: string) => {\n  const { x, y, width, height }: any = node\n  switch (dir) {\n    case 'topLeft':\n      return {\n        x,\n        y\n      }\n    case 'topRight':\n      return {\n        x: x + width,\n        y\n      }\n    case 'bottomRight':\n      return {\n        x: x + width,\n        y: y + height\n      }\n    case 'bottomLeft':\n      return {\n        x,\n        y: y + height\n      }\n    default:\n      break\n  }\n  return {}\n}\n\n// Get the outer bounding box for multiple coordinates\nexport const getBoundingRect = (\n  coordinateArr = [],\n  returnFourCorners = false\n) => {\n  let minX = Infinity\n  let maxX = -Infinity\n  let minY = Infinity\n  let maxY = -Infinity\n  coordinateArr.forEach((coordinate) => {\n    const [x, y]: Array<number> = coordinate\n    if (x < minX) {\n      minX = x\n    }\n    if (x > maxX) {\n      maxX = x\n    }\n    if (y < minY) {\n      minY = y\n    }\n    if (y > maxY) {\n      maxY = y\n    }\n  })\n  const x = minX\n  const y = minY\n  const width = maxX - minX\n  const height = maxY - minY\n  // Return in four corner coordinates\n  if (returnFourCorners) {\n    return [\n      {\n        x,\n        y\n      },\n      {\n        x: x + width,\n        y\n      },\n      {\n        x: x + width,\n        y: y + height\n      },\n      {\n        x,\n        y: y + height\n      }\n    ]\n  }\n  return {\n    x,\n    y,\n    width,\n    height\n  }\n}\n\n// Get the coordinates of the four corners of a rotated graphic object\nexport const getNodeRotatedFourCornerCoordinate = (node: Node, dir: string) => {\n  const center = getNodeCenterCoordinate(node)\n  const dirPos = getNodeFourCornerCoordinate(node, dir)\n  if (!dirPos || !dirPos.x || !dirPos.y) {\n    return 0\n  }\n  return getRotatedCoordinate(\n    dirPos.x,\n    dirPos.y,\n    center.x,\n    center.y,\n    <number>node.rotate\n  )\n}\n\n// Determines whether a coordinate is within a rectangle. rx can be a graphical object with x, y, width, height\nexport const checkCoordinateIsInRectangle = (\n  x: number,\n  y: number,\n  rx: number | Node,\n  ry?: number | undefined,\n  rw?: number | undefined,\n  rh?: number | undefined\n) => {\n  if (typeof rx === 'object') {\n    const node = rx\n    rx = node.x as number\n    ry = node.y\n    rw = node.width\n    rh = node.height\n  }\n  if (\n    typeof ry === 'undefined' ||\n    typeof rw === 'undefined' ||\n    typeof rh === 'undefined'\n  ) {\n    return false\n  }\n  return x >= rx && x <= rx + rw && y >= ry && y <= ry + rh\n}\n\n// Get the outermost bounding box information of multiple graphic objects\nexport const getMultiplexNodeRectInfo = (nodeList: NodeArray = []) => {\n  if (nodeList.length <= 0) {\n    return {\n      minX: 0,\n      maxX: 0,\n      minY: 0,\n      maxY: 0\n    }\n  }\n  let minX = Infinity\n  let maxX = -Infinity\n  let minY = Infinity\n  let maxY = -Infinity\n  nodeList.forEach((node) => {\n    const coordinateList = node?.getEndCoordinateList?.()\n    coordinateList.forEach(({ x, y }: { x: number; y: number }) => {\n      if (x < minX) {\n        minX = x\n      }\n      if (x > maxX) {\n        maxX = x\n      }\n      if (y < minY) {\n        minY = y\n      }\n      if (y > maxY) {\n        maxY = y\n      }\n    })\n  })\n  return {\n    minX,\n    maxX,\n    minY,\n    maxY\n  }\n}\n\n// Calculate the actual rendering width of the text\nlet textCheckEl: HTMLDivElement | null = null\nexport const getTextActWidth = (text: string, style: Style) => {\n  if (!textCheckEl) {\n    textCheckEl = document.createElement('div')\n    textCheckEl.style.position = 'fixed'\n    textCheckEl.style.left = '-99999px'\n    document.body.appendChild(textCheckEl)\n  }\n  const { fontSize, fontFamily } = style\n  textCheckEl.innerText = text\n  textCheckEl.style.fontSize = `${fontSize}px`\n  textCheckEl.style.fontFamily = fontFamily\n  const { width } = textCheckEl.getBoundingClientRect()\n  return width\n}\n\n//  Gets the coordinates of the four corners of the graphical object, after applying the rotation\nexport const getNodeFourCorners = (node: Node) => {\n  const bottomRight = getNodeRotatedFourCornerCoordinate(node, 'bottomRight')\n  const topLeft = getNodeRotatedFourCornerCoordinate(node, 'topLeft')\n  const topRight = getNodeRotatedFourCornerCoordinate(node, 'topRight')\n  const bottomLeft = getNodeRotatedFourCornerCoordinate(node, 'bottomLeft')\n  return [topLeft, topRight, bottomLeft, bottomRight]\n}\n\n// Creating picture objects\nexport const createImageObj = (url: string) =>\n  new Promise((resolve) => {\n    const img = new Image()\n    img.setAttribute('crossOrigin', 'anonymous')\n    img.onload = () => {\n      resolve(img)\n    }\n    img.onerror = () => {\n      resolve(null)\n    }\n    img.src = url\n  })\n\n// Calculate the maximum font size that will fit all text within a fixed width\nexport const getMaxFontSizeInWidth = (\n  text: string,\n  width: number,\n  style: { fontSize: number; fontFamily: string }\n) => {\n  let fontSize = 12\n  while (\n    getTextActWidth(text, {\n      ...style,\n      fontSize: fontSize + 1\n    }) < width\n  ) {\n    fontSize += 1\n  }\n  return fontSize\n}\n\n// Calculating the actual width of line feed text\nexport const getWrapTextActWidth = (node: Node) => {\n  const { text }: any = node\n  const textArr = splitTextLines(text)\n  let maxWidth = -Infinity\n  textArr.forEach((textRow) => {\n    const width = getTextActWidth(textRow, <any>node.style)\n    if (width > maxWidth) {\n      maxWidth = width\n    }\n  })\n  return maxWidth\n}\n\n// Calculate the number of words in the longest line of newline text\nexport const getWrapTextMaxRowTextNumber = (text: string) => {\n  const textArr = splitTextLines(text)\n  let maxNumber = -Infinity\n  textArr.forEach((textRow) => {\n    if (textRow.length > maxNumber) {\n      maxNumber = textRow.length\n    }\n  })\n  return maxNumber\n}\n\n// Calculate the width and height of a text graphic object\nexport const getTextNodeSize = (node: Node) => {\n  const { text, style }: any = node\n  const width = getWrapTextActWidth(node)\n  const lines = Math.max(splitTextLines(text).length, 1)\n  const lineHeight = style.fontSize * style.lineHeightRatio\n  const height = lines * lineHeight\n  return {\n    width,\n    height\n  }\n}\n\n// Calculate brush thickness based on speed\nexport const computedLineWidthBySpeed = (\n  speed: number,\n  lastLineWidth: number,\n  baseLineWidth = 2\n) => {\n  let lineWidth = 0\n  const maxLineWidth = baseLineWidth + 2\n  const maxSpeed = 10\n  const minSpeed = 0.5\n  if (speed >= maxSpeed) {\n    lineWidth = baseLineWidth\n  } else if (speed <= minSpeed) {\n    lineWidth = maxLineWidth + 1\n  } else {\n    lineWidth =\n      maxLineWidth - ((speed - minSpeed) / (maxSpeed - minSpeed)) * maxLineWidth\n  }\n  if (lastLineWidth === -1) {\n    lastLineWidth = maxLineWidth\n  }\n  return lineWidth * 0.5 + lastLineWidth * 0.3\n}\n","import { keyPosit } from '../common/constants'\nimport { throttle } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class Author {\n  public app: AppObject\n\n  public startScrollX: number | undefined\n\n  public startScrollY: number | undefined\n\n  isDragAuthor: boolean\n\n  constructor(app: AppObject) {\n    this.app = app\n    // Save the scroll offset when dragging is about to start\n    this.startScrollX = 0\n    this.startScrollY = 0\n    // Canvas drag and drop Author\n    this.isDragAuthor = false\n    // A little relief from lag\n    this.onMove = throttle(this.onMove, this as any, 15)\n    this.bindEvent()\n  }\n\n  // Save the current scroll offset\n  onStart() {\n    this.startScrollX = this.app.state.scrollX\n    this.startScrollY = this.app.state.scrollY\n  }\n\n  // Update scroll offset and re-render\n  onMove(e: any, event: { mouseOffset: { originX: number; originY: number } }) {\n    if (\n      typeof this.startScrollX !== 'undefined' &&\n      typeof this.startScrollY !== 'undefined' &&\n      typeof this.app.state.scale !== 'undefined'\n    ) {\n      this.app.scrollTo(\n        this.startScrollX - event.mouseOffset.originX / this.app.state.scale,\n        this.startScrollY - event.mouseOffset.originY / this.app.state.scale\n      )\n    }\n  }\n\n  bindEvent() {\n    this.app.event.on('keydown', (e: { keyCode: number }) => {\n      if (e.keyCode === keyPosit.Space) {\n        this.isDragAuthor = true\n        this.app.cursor.set('grab')\n      }\n    })\n    this.app.event.on('keyup', () => {\n      if (this.isDragAuthor) {\n        this.isDragAuthor = false\n        this.app.cursor.set('default')\n      }\n    })\n  }\n\n  // Set to edit Author\n  setEditAuthor() {\n    this.app.cursor.set('default')\n    this.app.updateState({\n      readonly: false\n    })\n  }\n\n  // Set to read-only Author\n  setReadonlyAuthor() {\n    this.app.cursor.set('grab')\n    this.app.cancelActiveNode()\n    this.app.updateState({\n      readonly: true\n    })\n  }\n}\n","import { AppObject, Ctx } from '../types'\n\nexport default class Background {\n  public app: AppObject\n\n  constructor(app: AppObject) {\n    this.app = app\n  }\n\n  // Setting the background\n  set() {\n    if (this.app.state.backgroundColor) {\n      this.addBackgroundColor()\n    } else {\n      this.remove()\n    }\n  }\n\n  // Add background colour\n  addBackgroundColor() {\n    this.app.mountEL.style.backgroundColor = <string>(\n      this.app.state.backgroundColor\n    )\n  }\n\n  // Remove background colour\n  remove() {\n    this.app.mountEL.style.backgroundColor = ''\n  }\n\n  // Set background colour inside canvas, not css style\n  static canvasAddBackgroundColor(\n    ctx: Ctx,\n    width: number,\n    height: number,\n    backgroundColor: string\n  ) {\n    ctx.save()\n    ctx.rect(0, 0, width, height)\n    ctx.fillStyle = backgroundColor\n    ctx.fill()\n    ctx.restore()\n  }\n}\n","import { DRAG_NODE_PARTS } from '../common/constants'\nimport { AppObject } from '../types'\n\nexport default class Cursor {\n  public app: AppObject\n\n  public currentType: string\n\n  constructor(app: AppObject) {\n    this.app = app\n    this.currentType = 'default'\n  }\n\n  // Set the mouse pointer style\n  set(type = 'default') {\n    this.currentType = type\n    let style = type\n    if (type === 'eraser') {\n      style = `url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAbZJREFUSEvNlL1rVEEUxc95uwvCVjYKNnZa2ATEXrALNhaKiBgQDabQwt13hlQbi30w8x4oNhaCkYBFElAhoJXaip2FRfIX2FhY2c2VJy5skn0fERacbphzf3Pv5dxLzOlwTlz8H2Dv/VqSJF/NbFHS3bpqW2ec5/mqmWUk1wC8iTFmzrnLVfBWYO/9gGQxBVkl+c7M1iWdnwVvBIcQ7gN4OiP4IckPZrYj6fTB91pwURT3YozPqso1sxWSnwF8knR8WlcJDiHcAfC8yY5mdgvAT5KvJXUn+plg7/0SyZdN0Kn3bQA/JK1UgvM8v2Fmr44A/SMleSlN048zwSGEqwC2jgpNkmRxOBy+r+yx9/4xyQUAF9vCzeyKc+5trStCCCaJRVFciDF+aQG/Lmmz1schhHKKXkg6UQqzLDvT7XZ3a+BLkjZaTV6ZcafTOTsYDPbKgPF4fLLX630/VCa5nKZprRX32a1cMiRHZTsmsNFodKzf7/+a3M3stnNuvalNh3w8gQO4Jmn7r1OeADhlZjedc62sWDUgyyQfADgH4BuAR2WG5UdNmdZOXtvgOl3jdvvXT+YG/g3VNZQXhpoDKQAAAABJRU5ErkJggg==) 10 10, auto`\n    }\n    if (type === 'text') {\n      style = `url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAWZJREFUSEvNlLFOwzAQhi+5iaUrDDwBHekDNHtZEOorMFk5JQ8APEAsJyOPwAjsZEZ0LAMrCzwBUxx0kVM5adI4RZXwlMj2p///fXceHGh5B+LC/wPHcXxWFMWSHSulbtvO91JsoA8AMDXAXCkV2PC9wAwgIlZ5Y8HubOWjwLX9GtCCN1Q7g1v2N+oM/Mr3/Usp5UftwAlsoG8AcNRlnfeTJHkflbGBrnvqvZGrM5iI5gDw0gNdI+KyrXQwigHoDyLO+qAM78w4DMNjz/O++todEae7oJ1gIcQpIn7+BboFHrDP5wOlVO4yuBpREBGX1HnPRWdoQ3EURQut9VMXtCzLkzRNv12UblUFET0CwEX7stZ6lmXZagx0o1gIMTEPNrEAK631dQ01rVuNyPobAHg+5PZeQ7HVXWz31ff9eynls62SiEoDCqzhU+Vu73VFMd/14qZiWDGDuCOrZf/b952G0Nh8+fwvoNqzF6HDmhsAAAAASUVORK5CYII=) 10 10, auto`\n    }\n    this.app.mountEL.style.cursor = style\n  }\n\n  setEraser() {\n    this.set('eraser')\n  }\n\n  setText() {\n    this.set('text')\n  }\n\n  setMove() {\n    this.set('move')\n  }\n\n  hide() {\n    this.set('none')\n  }\n\n  reset() {\n    this.set()\n  }\n\n  setCrossHair() {\n    this.set('crosshair')\n  }\n\n  // Set to a movable state in a certain direction\n  setResize(direction: string) {\n    let type = ''\n    switch (direction) {\n      case DRAG_NODE_PARTS.BODY:\n        type = 'move'\n        break\n      case DRAG_NODE_PARTS.ROTATE:\n        type = 'grab'\n        break\n      case DRAG_NODE_PARTS.TOP_LEFT_BUTTON:\n        type = 'nw-resize'\n        break\n      case DRAG_NODE_PARTS.TOP_RIGHT_BUTTON:\n        type = 'ne-resize'\n        break\n      case DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON:\n        type = 'se-resize'\n        break\n      case DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON:\n        type = 'sw-resize'\n        break\n      default:\n        break\n    }\n    this.set(type)\n  }\n}\n","import EventEmitter from 'eventemitter3'\n\nimport { getTowCoordinateDistance } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class Event extends EventEmitter {\n  public app: AppObject\n\n  public calculate: any\n\n  public lastMousePos: { x: number; y: number }\n\n  public mouseDistance: number\n\n  public lastMouseTime: number\n\n  public mouseDuration: number\n\n  public mouseSpeed: number\n\n  public isMousedown: boolean\n\n  public mousedownPos: {\n    originClientY: number\n    x: number\n    y: number\n    unGridClientX: number\n    unGridClientY: number\n    originClientX: number\n  }\n\n  public mouseOffset: {\n    originX: number\n    originY: number\n    x: number\n    y: number\n  }\n\n  constructor(app: AppObject) {\n    super()\n    this.app = app\n    this.calculate = app.calculate\n\n    // Record the mouse position at the previous moment\n    this.lastMousePos = {\n      x: 0,\n      y: 0\n    }\n\n    // Distance of mouse movement in the previous instant\n    this.mouseDistance = 0\n\n    // Record the time of the previous moment\n    this.lastMouseTime = Date.now()\n\n    // The moment before\n    this.mouseDuration = 0\n\n    // Mouse movement speed in the previous instant\n    this.mouseSpeed = 0\n\n    // Is the mouse pressed\n    this.isMousedown = false\n\n    // Mouse position when pressed\n    this.mousedownPos = {\n      x: 0,\n      y: 0,\n      unGridClientX: 0,\n      unGridClientY: 0,\n      originClientX: 0,\n      originClientY: 0\n    }\n\n    // The difference between the current position of the mouse and the position when it is pressed\n    this.mouseOffset = {\n      x: 0,\n      y: 0,\n      originX: 0,\n      originY: 0\n    }\n\n    this.onMousedown = this.onMousedown.bind(this)\n    this.onMousemove = this.onMousemove.bind(this)\n    this.onMouseup = this.onMouseup.bind(this)\n    this.onDblclick = this.onDblclick.bind(this)\n    this.onMousewheel = this.onMousewheel.bind(this)\n    this.onKeydown = this.onKeydown.bind(this)\n    this.onKeyup = this.onKeyup.bind(this)\n    this.onContextmenu = this.onContextmenu.bind(this)\n    this.bindEvent()\n  }\n\n  onMouseup(e: any) {\n    e = this.transformEvent(e)\n    this.isMousedown = false\n    this.mousedownPos.x = 0\n    this.mousedownPos.y = 0\n    this.emit('mouseup', e, this)\n  }\n\n  onDblclick(e: any) {\n    e = this.transformEvent(e)\n    this.emit('dblclick', e, this)\n  }\n\n  onMousewheel(e: any) {\n    e = this.transformEvent(e)\n    this.emit('mousewheel', e.originEvent.wheelDelta < 0 ? 'down' : 'up')\n  }\n\n  onContextmenu(e: any) {\n    e.stopPropagation()\n    e.preventDefault()\n    e = this.transformEvent(e)\n    this.emit('contextmenu', e, this)\n  }\n\n  onKeydown(e: any) {\n    this.emit('keydown', e, this)\n  }\n\n  onKeyup(e: any) {\n    this.emit('keyup', e, this)\n  }\n\n  onMousedown(e: any) {\n    e = this.transformEvent(e)\n    this.isMousedown = true\n    this.mousedownPos.x = e.clientX\n    this.mousedownPos.y = e.clientY\n    this.mousedownPos.unGridClientX = e.unGridClientX\n    this.mousedownPos.unGridClientY = e.unGridClientY\n    this.mousedownPos.originClientX = e.originEvent.clientX\n    this.mousedownPos.originClientY = e.originEvent.clientY\n    this.emit('mousedown', e, this)\n  }\n\n  onMousemove(e: any) {\n    e = this.transformEvent(e)\n    const x = e.clientX\n    const y = e.clientY\n    if (this.isMousedown) {\n      this.mouseOffset.x = x - this.mousedownPos.x\n      this.mouseOffset.y = y - this.mousedownPos.y\n      this.mouseOffset.originX =\n        e.originEvent.clientX - this.mousedownPos.originClientX\n      this.mouseOffset.originY =\n        e.originEvent.clientY - this.mousedownPos.originClientY\n    }\n    const curTime = Date.now()\n    this.mouseDuration = curTime - this.lastMouseTime\n    this.mouseDistance = getTowCoordinateDistance(\n      x,\n      y,\n      this.lastMousePos.x,\n      this.lastMousePos.y\n    )\n    this.mouseSpeed = this.mouseDistance / this.mouseDuration\n    this.emit('mousemove', e, this)\n    this.lastMouseTime = curTime\n    this.lastMousePos.x = x\n    this.lastMousePos.y = y\n  }\n\n  // events into coordinates, and adsorption if grid is turned on\n  transformEvent(e: { clientX: any; clientY: any }) {\n    const { calculate } = this.app\n    const wp = calculate.windowToContainer(e.clientX, e.clientY)\n    let { x, y } = calculate.reverseScale(wp.x, wp.y)\n    x = calculate.addScrollX(x)\n    y = calculate.addScrollY(y)\n    const unGridClientX = x\n    const unGridClientY = y\n    const gp = calculate.gridAdsorbent(x, y)\n    return {\n      originEvent: e,\n      unGridClientX,\n      unGridClientY,\n      clientX: gp.x,\n      clientY: gp.y\n    }\n  }\n\n  bindEvent() {\n    this.app.mountEL.addEventListener('mousedown', this.onMousedown)\n    this.app.mountEL.addEventListener('mousemove', this.onMousemove)\n    this.app.mountEL.addEventListener('mouseup', this.onMouseup)\n    this.app.mountEL.addEventListener('dblclick', this.onDblclick)\n    this.app.mountEL.addEventListener('mousewheel', this.onMousewheel)\n    this.app.mountEL.addEventListener('contextmenu', this.onContextmenu)\n    window.addEventListener('keydown', this.onKeydown)\n    window.addEventListener('keyup', this.onKeyup)\n  }\n\n  unbindEvent() {\n    this.app.mountEL.removeEventListener('mousedown', this.onMousedown)\n    this.app.mountEL.removeEventListener('mousemove', this.onMousemove)\n    this.app.mountEL.removeEventListener('mouseup', this.onMouseup)\n    this.app.mountEL.removeEventListener('dblclick', this.onDblclick)\n    this.app.mountEL.removeEventListener('mousewheel', this.onMousewheel)\n    this.app.mountEL.removeEventListener('contextmenu', this.onContextmenu)\n    window.removeEventListener('keydown', this.onKeydown)\n    window.removeEventListener('keyup', this.onKeyup)\n  }\n}\n","import { createCanvas, getMultiplexNodeRectInfo } from '../common/utils'\nimport { AppObject, Ctx, Node, NodeArray } from '../types'\nimport Background from './Background'\n\nexport default class Export {\n  public app: AppObject\n\n  public openPreview: boolean\n\n  public saveState: {\n    width: number\n    scale: number\n    scrollY: number\n    scrollX: number\n    height: number\n    ctx?: Ctx\n  }\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.openPreview = false\n\n    this.saveState = {\n      scale: 0,\n      scrollX: 0,\n      scrollY: 0,\n      width: 0,\n      height: 0\n    }\n  }\n\n  // Export as json data\n  exportJson() {\n    return this.app.getData()\n  }\n\n  // Draw all graphic objects\n  render(ctx: Ctx, onlySelected: boolean) {\n    ctx.save()\n    this.getNodeList(onlySelected).forEach((node: Node) => {\n      if (node.noRender) {\n        return\n      }\n      const cacheActive = node.isActive\n      const cacheSelected = node.isSelected\n      node.isActive = false\n      node.isSelected = false\n      node.render()\n      node.isActive = cacheActive\n      node.isSelected = cacheSelected\n    })\n    ctx.restore()\n  }\n\n  // Save the current state data of the app class\n  saveAppState() {\n    const { width, height, state, ctx } = this.app\n    this.saveState.width = width\n    this.saveState.height = height\n    if (state.scale) {\n      this.saveState.scale = state.scale\n    }\n    if (state.scrollX) {\n      this.saveState.scrollX = state.scrollX\n    }\n    if (state.scrollY) {\n      this.saveState.scrollY = state.scrollY\n    }\n    this.saveState.ctx = ctx\n  }\n\n  // Export as image\n  exportImage({\n    type = 'image/png',\n    renderBg = true,\n    useBlob = false,\n    paddingX = 10,\n    paddingY = 10,\n    onlySelected = true\n  } = {}) {\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.getNodeList(onlySelected)\n    )\n    const width = maxX - minX + paddingX * 2\n    const height = maxY - minY + paddingY * 2\n    // Creating an export canvas\n    const { canvas, ctx } = createCanvas(width, height, {\n      noStyle: true,\n      noTranslate: true\n    })\n    if (!ctx) {\n      // eslint-disable-next-line no-console\n      console.error('Create Export Canvas Error')\n      return ''\n    }\n    this.show(canvas)\n    this.saveAppState()\n    this.changeAppState(minX - paddingX, minY - paddingY, ctx)\n    // Painting background colours\n    if (renderBg && this.app.state.backgroundColor && ctx) {\n      Background.canvasAddBackgroundColor(\n        ctx,\n        width,\n        height,\n        this.app.state.backgroundColor\n      )\n    }\n    // Drawing graphic objects to exported canvas\n    this.render(ctx, onlySelected)\n    this.recoveryAppState()\n\n    if (useBlob) {\n      return new Promise((resolve, reject) => {\n        canvas.toBlob((blob) => {\n          if (blob) {\n            resolve(blob)\n          } else {\n            reject()\n          }\n        }, type)\n      })\n    }\n    return canvas.toDataURL(type)\n  }\n\n  show(canvas: HTMLCanvasElement) {\n    if (this.openPreview) {\n      canvas.style.cssText = `position: absolute;left: 0;top: 0;background-color: #FFFFFF;`\n      document.body.appendChild(canvas)\n    }\n  }\n\n  // Recovery of app class status data\n  recoveryAppState() {\n    const { width, height, scale, scrollX, scrollY, ctx } = this.saveState\n    this.app.state.scale = scale\n    this.app.state.scrollX = scrollX\n    this.app.state.scrollY = scrollY\n    this.app.width = width\n    this.app.height = height\n    if (ctx) {\n      this.app.ctx = ctx\n    }\n  }\n\n  // Temporary modification of app class status data\n  changeAppState(minX: number, minY: number, ctx: Ctx) {\n    this.app.ctx = ctx\n    this.app.width = minX * 2\n    this.app.height = minY * 2\n    this.app.state.scale = 1\n    this.app.state.scrollX = 0\n    this.app.state.scrollY = 0\n  }\n\n  // Get the graphic object to be exported\n  getNodeList(onlySelected = true) {\n    // Exporting all graphic objects\n    if (!onlySelected) {\n      return this.app.nodes.nodeList\n    }\n    // Export only active or selected graphic objects\n    let selectedNodes: NodeArray = []\n    if (this.app.nodes.activeNode) {\n      selectedNodes.push(this.app.nodes.activeNode)\n    } else if (this.app.selection.hasSelectionNodes()) {\n      selectedNodes = this.app.selection.getSelectionNodes()\n    }\n    return this.app.nodes.nodeList.filter((node: Node) =>\n      selectedNodes.includes(node)\n    )\n  }\n}\n","import { createCanvas } from '../common/utils'\nimport { Ctx } from '../types'\n\nexport default class Canvas {\n  public width: number\n\n  public height: number\n\n  public el: HTMLCanvasElement | undefined\n\n  public ctx: Ctx | undefined\n\n  constructor(\n    width: number,\n    height: number,\n    opt?: { noStyle?: boolean; noTranslate?: boolean; className?: string }\n  ) {\n    this.width = width\n    this.height = height\n    const { canvas, ctx } = createCanvas(width, height, opt)\n    if (ctx) {\n      this.el = canvas\n      this.ctx = ctx\n    }\n  }\n\n  clearCanvas() {\n    const { width, height } = this\n    this.ctx?.clearRect(-width / 2, -height / 2, width, height)\n  }\n}\n","import Canvas from '../support/Canvas'\nimport { AppObject, Ctx } from '../types'\n\nexport default class Grid {\n  public app: AppObject\n\n  public canvas: any\n\n  public ctx: Ctx | null\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.canvas = null\n\n    this.ctx = null\n\n    this.init()\n\n    this.app.on('zoomChange', this.renderGrid, this)\n\n    this.app.on('scrollChange', this.renderGrid, this)\n  }\n\n  // plot vertical lines\n  renderVerticalLines() {\n    const { calculate, width, state } = this.app\n    const { gridConfig, scale } = state\n    let maxRight = 0\n    if (\n      typeof gridConfig === 'undefined' ||\n      typeof scale === 'undefined' ||\n      typeof gridConfig.size === 'undefined'\n    ) {\n      // eslint-disable-next-line no-console\n      console.error('gridConfig or scale or gridConfig.size is undefined')\n      return\n    }\n    for (let i = -width / 2; i < width / 2; i += gridConfig.size) {\n      this.plotVerticalLine(i)\n      maxRight = i\n    }\n    // Draws the line beyond the left side when rolling to the right\n    for (\n      let i = -width / 2 - gridConfig.size;\n      i > -calculate.subScrollX(width / scale / 2);\n      i -= gridConfig.size\n    ) {\n      this.plotVerticalLine(i)\n    }\n    // Draws the line beyond the right when rolling to the left\n    for (\n      let i = maxRight + gridConfig.size;\n      i < calculate.addScrollX(width / scale / 2);\n      i += gridConfig.size\n    ) {\n      this.plotVerticalLine(i)\n    }\n  }\n\n  // Rendering of horizontal lines\n  renderHorizontalLines() {\n    const { calculate, height, state } = this.app\n    const { gridConfig, scale } = state\n    if (\n      typeof gridConfig === 'undefined' ||\n      typeof scale === 'undefined' ||\n      typeof gridConfig.size === 'undefined'\n    ) {\n      return\n    }\n    let maxBottom = 0\n    for (let i = -height / 2; i < height / 2; i += gridConfig.size) {\n      this.plotHorizontalLine(i)\n      maxBottom = i\n    }\n    // Draws the line beyond the top when rolling downwards\n    for (\n      let i = -height / 2 - gridConfig.size;\n      i > -calculate.subScrollY(height / scale / 2);\n      i -= gridConfig.size\n    ) {\n      this.plotHorizontalLine(i)\n    }\n    // Draws the line beyond the bottom when rolling upwards\n    for (\n      let i = maxBottom + gridConfig.size;\n      i < calculate.addScrollY(height / scale / 2);\n      i += gridConfig.size\n    ) {\n      this.plotHorizontalLine(i)\n    }\n  }\n\n  renderGrid() {\n    this.canvas.clearCanvas()\n    const { gridConfig, scale, showGrid } = this.app.state\n    if (!showGrid) {\n      return\n    }\n    if (\n      this.ctx &&\n      scale &&\n      gridConfig &&\n      this.ctx.strokeStyle &&\n      this.ctx.lineWidth\n    ) {\n      this.ctx.save()\n      this.ctx.scale(scale, scale)\n      // @ts-ignore\n      this.ctx.strokeStyle = gridConfig.strokeStyle\n      // @ts-ignore\n      this.ctx.lineWidth = gridConfig.lineWidth\n    }\n\n    this.renderVerticalLines()\n\n    this.renderHorizontalLines()\n\n    this.ctx?.restore()\n  }\n\n  // Drawing horizontal lines\n  plotHorizontalLine(i: number) {\n    const { calculate, width, state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return\n    }\n    const _i = calculate.subScrollY(i)\n    this.ctx?.beginPath()\n    this.ctx?.moveTo(-width / state.scale / 2, _i)\n    this.ctx?.lineTo(width / state.scale / 2, _i)\n    this.ctx?.stroke()\n  }\n\n  // plot the reset line\n  plotVerticalLine(i: number) {\n    const { calculate, height, state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return\n    }\n    const _i = calculate.subScrollX(i)\n    this.ctx?.beginPath()\n    this.ctx?.moveTo(_i, -height / state.scale / 2)\n    this.ctx?.lineTo(_i, height / state.scale / 2)\n    this.ctx?.stroke()\n  }\n\n  showGrid() {\n    this.app.updateState({\n      showGrid: true\n    } as any)\n    this.renderGrid()\n  }\n\n  hideGrid() {\n    this.app.updateState({\n      showGrid: false\n    } as any)\n    this.canvas.clearCanvas()\n  }\n\n  updateGrid(config = {}) {\n    this.app.updateState({\n      gridConfig: {\n        ...this.app.state.gridConfig,\n        ...config\n      }\n    } as any)\n    if (this.app.state.showGrid) {\n      this.hideGrid()\n      this.showGrid()\n    }\n  }\n\n  init() {\n    if (this.canvas) {\n      this.app.mountEL.removeChild(this.canvas.el)\n    }\n    const { width, height } = this.app\n    this.canvas = new Canvas(width, height, {\n      className: 'grid'\n    })\n    this.ctx = this.canvas.ctx\n    this.app.mountEL.insertBefore(this.canvas.el, this.app.mountEL.children[0])\n  }\n}\n","import { deepCopy } from '../common/utils'\nimport { AppObject, LocalData } from '../types'\n\nexport default class History {\n  public app: AppObject\n\n  public historyStack: Array<LocalData>\n\n  public length: number\n\n  public index: number\n\n  public fixIndex: number\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.historyStack = []\n\n    this.length = 0\n\n    this.index = -1\n\n    this.fixIndex = -1\n  }\n\n  emitChange() {\n    this.app.emit('shuttle', this.index, this.length)\n  }\n\n  now() {\n    return this.historyStack[this.length - 1]\n  }\n\n  clear() {\n    this.index = -1\n    this.length = 0\n    this.historyStack = []\n    this.emitChange()\n  }\n\n  add(data: LocalData) {\n    const prev = this.length > 0 ? this.historyStack[this.length - 1] : null\n    const copyData = deepCopy(data)\n    if (copyData === prev) {\n      return\n    }\n    this.historyStack.push(copyData)\n    this.length += 1\n    this.index = this.length - 1\n    this.emitChange()\n  }\n\n  shuttle() {\n    const oldData = this.app.getData()\n    const data = this.historyStack[this.index]\n    // Avoid interference and enforce correction\n    this.fixIndex = this.index\n    const fixLength = this.length\n    this.app\n      .setData(data, true)\n      .then(() => {\n        this.index = this.fixIndex\n        this.length = fixLength\n        this.emitChange()\n        this.app.emit('change', data)\n        this.app.emitDiffNodesChange(oldData, data)\n        this.app.emitDiffStateChange(oldData, data)\n      })\n      .catch(() => {\n        // eslint-disable-next-line no-console\n        console.error('History shuttle setData error')\n      })\n  }\n\n  undo() {\n    if (this.index <= 0) {\n      return\n    }\n    this.index -= 1\n    this.shuttle()\n  }\n\n  redo() {\n    if (this.index >= this.length - 1) {\n      return\n    }\n    this.index += 1\n    this.shuttle()\n  }\n}\n","import EventEmitter from 'eventemitter3'\n\nimport { AppObject } from '../types'\n\nexport default class ImageEdit extends EventEmitter {\n  public app: AppObject\n\n  public el: HTMLInputElement | null\n\n  isReady: boolean\n\n  public previewEl: HTMLDivElement | null\n\n  public imageData: {\n    url: string\n    width: number\n    height: number\n    ratio: number\n    imageObj: HTMLInputElement\n  } | null\n\n  public maxWidth: number\n\n  public maxHeight: number\n\n  public maxRatio: number\n\n  constructor(app: AppObject) {\n    super()\n\n    this.app = app\n\n    this.el = null\n\n    this.isReady = false\n\n    this.previewEl = null\n\n    this.imageData = null\n\n    this.maxWidth = 750\n\n    this.maxHeight = 450\n\n    this.maxRatio = this.maxWidth / this.maxHeight\n\n    this.onImageSelectChange = this.onImageSelectChange.bind(this)\n  }\n\n  updatePreviewElPos(x: number, y: number) {\n    const width = 100\n    if (!this.imageData) {\n      // eslint-disable-next-line no-console\n      console.error('imageData is null')\n      return\n    }\n    const height = width / this.imageData.ratio\n    if (!this.previewEl) {\n      this.previewEl = document.createElement('div')\n      this.previewEl.style.position = 'fixed'\n      this.previewEl.style.width = `${width}px`\n      this.previewEl.style.height = `${height}px`\n      this.previewEl.style.backgroundImage = `url('${this.imageData.url}')`\n      this.previewEl.style.backgroundSize = 'cover'\n      this.previewEl.style.pointerEvents = 'none'\n      document.body.appendChild(this.previewEl)\n    }\n    const tp = this.app.calculate.mountELToWindow(x, y)\n    this.previewEl.style.left = `${tp.x - width / 2}px`\n    this.previewEl.style.top = `${tp.y - height / 2}px`\n  }\n\n  reset() {\n    if (this.el) {\n      this.el.value = ''\n    }\n    this.isReady = false\n    if (this.previewEl) {\n      document.body.removeChild(this.previewEl)\n    }\n    this.previewEl = null\n    this.imageData = null\n  }\n\n  async getImageUrl(file: Blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        resolve(reader.result)\n      }\n      reader.onerror = () => {\n        reject()\n      }\n      reader.readAsDataURL(file)\n    })\n  }\n\n  async getImageSize(url: string): Promise<{\n    imageObj: HTMLInputElement\n    size: {\n      width: number\n      height: number\n    }\n    ratio: number\n  }> {\n    return new Promise((resolve, reject) => {\n      const img = new Image()\n      img.setAttribute('crossOrigin', 'anonymous')\n      img.onload = () => {\n        let { width } = img\n        let { height } = img\n        const ratio = img.width / img.height\n        if (img.width > this.maxWidth || img.height > this.maxHeight) {\n          if (ratio > this.maxRatio) {\n            width = this.maxWidth\n            height = this.maxWidth / ratio\n          } else {\n            height = this.maxHeight\n            width = this.maxHeight * ratio\n          }\n        }\n        resolve({\n          imageObj: img,\n          size: {\n            width,\n            height\n          },\n          ratio\n        } as any)\n      }\n      img.onerror = () => {\n        reject()\n      }\n      img.src = url\n    })\n  }\n\n  async onImageSelectChange(e: any) {\n    const url = await this.getImageUrl(e.target.files[0])\n    if (typeof url !== 'string') {\n      // eslint-disable-next-line no-console\n      console.error('url is not string')\n      return\n    }\n    const { imageObj, size, ratio } = await this.getImageSize(url)\n    this.isReady = true\n    this.imageData = {\n      url,\n      ...size,\n      ratio,\n      imageObj\n    }\n    this.emit('imageSelectChange', this.imageData)\n  }\n\n  selectImage() {\n    if (!this.el) {\n      this.el = document.createElement('input')\n      this.el.style.position = 'fixed'\n      this.el.style.left = '-9999999px'\n      this.el.type = 'file'\n      this.el.accept = 'image/*'\n      this.el.addEventListener('change', this.onImageSelectChange)\n      document.body.appendChild(this.el)\n    }\n    this.el.click()\n  }\n}\n","import { keyPosit } from '../common/constants'\nimport { AppObject, KeyPosit } from '../types'\n\nexport default class KeyCommand {\n  public app: AppObject\n\n  public keyPosit: KeyPosit\n\n  public shortcutMap: any\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.keyPosit = keyPosit\n\n    this.shortcutMap = {}\n\n    this.bindEvent()\n  }\n\n  // Get the array of key values corresponding to the shortcut keys\n  getKeyCodeArr(key: string) {\n    key = key.replace(/\\+\\+/, '+add')\n    const keyArr = key\n      .split(/\\s*\\+\\s*/)\n      .map((item) => (item === 'add' ? '+' : item))\n    const arr: any[] = []\n    keyArr.forEach((item) => {\n      // @ts-ignore\n      arr.push(keyPosit[item])\n    })\n    return arr\n  }\n\n  // Get an array of key values in an event object\n  getOriginEventCodeArr(e: {\n    stopPropagation?: () => void\n    preventDefault?: () => void\n    ctrlKey?: any\n    metaKey?: any\n    altKey?: any\n    shiftKey?: any\n    keyCode?: any\n  }) {\n    const arr = []\n    if (e.ctrlKey || e.metaKey) {\n      arr.push(keyPosit.Control)\n    }\n    if (e.altKey) {\n      arr.push(keyPosit.Alt)\n    }\n    if (e.shiftKey) {\n      arr.push(keyPosit.Shift)\n    }\n    if (!arr.includes(e.keyCode)) {\n      arr.push(e.keyCode)\n    }\n    return arr\n  }\n\n  // Check if the key value matches\n  checkKey(\n    e: { stopPropagation: () => void; preventDefault: () => void },\n    key: string\n  ) {\n    const o = this.getOriginEventCodeArr(e)\n    const k = this.getKeyCodeArr(key)\n    if (o.length !== k.length) {\n      return false\n    }\n    for (let i = 0; i < o.length; i += 1) {\n      const index = k.findIndex((item) => item === o[i])\n      if (index === -1) {\n        return false\n      }\n      k.splice(index, 1)\n    }\n    return true\n  }\n\n  onKeydown(e: { stopPropagation: () => void; preventDefault: () => void }) {\n    Object.keys(this.shortcutMap).forEach((key) => {\n      if (this.checkKey(e, key)) {\n        e.stopPropagation()\n        e.preventDefault()\n        this.shortcutMap[key].forEach(\n          (f: { fn: { call: (arg0: any) => void }; ctx: any }) => {\n            f.fn.call(f.ctx)\n          }\n        )\n      }\n    })\n  }\n\n  // Add shortcut command\n  addShortcut(key: string, fn: any, ctx?: any) {\n    key.split(/\\s*\\|\\s*/).forEach((item) => {\n      if (this.shortcutMap[item]) {\n        this.shortcutMap[item].push({\n          fn,\n          ctx\n        })\n      } else {\n        this.shortcutMap[item] = [\n          {\n            fn,\n            ctx\n          }\n        ]\n      }\n    })\n  }\n\n  // Remove shortcut command\n  removeShortcut(key: string, fn: any) {\n    key.split(/\\s*\\|\\s*/).forEach((item) => {\n      if (this.shortcutMap[item]) {\n        if (fn) {\n          const index = this.shortcutMap[item].findIndex(\n            (f: { fn: any }) => f.fn === fn\n          )\n          if (index !== -1) {\n            this.shortcutMap[item].splice(index, 1)\n          }\n        } else {\n          this.shortcutMap[item] = []\n          delete this.shortcutMap[item]\n        }\n      }\n    })\n  }\n\n  bindEvent() {\n    this.app.event.on('keydown', this.onKeydown, this)\n  }\n\n  unBindEvent() {\n    this.app.event.off('keydown', this.onKeydown)\n  }\n}\n","import { Node } from '../../types'\nimport { CLICK_DISTANCE } from '../constants'\nimport {\n  checkCoordinateIsInRectangle,\n  checkIsAtSegment,\n  getTowCoordinateDistance\n} from './index'\n\ntype Segments = Array<[x1: number, y1: number, x2: number, y2: number]>\ntype Rp = { xs?: number; ys?: number; x: number; y: number }\n\n// Detects if a click is inside a rectangle\nexport const checkIsAtRectangleInner = (node: any, rp: Rp) =>\n  checkCoordinateIsInRectangle(rp.x, rp.y, node as Node) ? node : null\n\n// Calculate the radius of the circle from the width and height\nexport const getCircleRadius = (width: number, height: number) =>\n  Math.min(Math.abs(width), Math.abs(height)) / 2\n\n// Detects if a click is made on the fold\nexport const checkIsAtMultiplexSegment = (segments: Segments, rp: Rp) => {\n  let res = false\n  segments.forEach((seg) => {\n    if (res) return\n    if (checkIsAtSegment(rp.x, rp.y, ...seg, CLICK_DISTANCE)) {\n      res = true\n    }\n  })\n  return res\n}\n\n// Calculate the radius of the circle from the width and height\nexport const checkIsAtCircleEdge = (node: any, rp: Rp) => {\n  const { width, height, x, y } = node as Node\n  const radius = getCircleRadius(width, height)\n  const dis = getTowCoordinateDistance(rp.x, rp.y, x + radius, y + radius)\n  const onCircle =\n    dis >= radius - CLICK_DISTANCE && dis <= radius + CLICK_DISTANCE\n  return onCircle ? node : null\n}\n\n// Detects if you click on the edge of a rectangle\nexport const checkIsAtRectangleEdge = (node: any, rp: Rp) => {\n  const { x, y, width, height } = node as Node\n  const segments: Segments = [\n    [x, y, x + width, y],\n    [x + width, y, x + width, y + height],\n    [x + width, y + height, x, y + height],\n    [x, y + height, x, y]\n  ]\n  return checkIsAtMultiplexSegment(segments, rp) ? node : null\n}\n\n// Detects if a triangle edge is clicked on\nexport const checkIsAtTriangleEdge = (node: Node, rp: Rp) => {\n  const { x, y, width, height } = node\n  const segments = [\n    [x + width / 2, y, x + width, y + height],\n    [x + width, y + height, x, y + height],\n    [x, y + height, x + width / 2, y]\n  ]\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n\n// Detects if a diamond edge is clicked on\nexport const checkIsAtDiamondEdge = (node: any, rp: Rp) => {\n  const { x, y, width, height } = node as Node\n  const segments = [\n    [x + width / 2, y, x + width, y + height / 2],\n    [x + width, y + height / 2, x + width / 2, y + height],\n    [x + width / 2, y + height, x, y + height / 2],\n    [x, y + height / 2, x + width / 2, y]\n  ]\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n\n// Detects if you click on the edge of the arrow\nexport const checkIsAtArrowEdge = (node: any, rp: Rp) => {\n  const { coordinateArr } = node as Node\n  if (typeof coordinateArr === 'undefined') {\n    return null\n  }\n  const x = coordinateArr[0][0]\n  const y = coordinateArr[0][1]\n  const tx = coordinateArr[coordinateArr.length - 1][0]\n  const ty = coordinateArr[coordinateArr.length - 1][1]\n  const segments = [[x, y, tx, ty]]\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n\n// Detects if a click is made on the edge of a free line segment\nexport const checkIsAtArbitraryPlotLineEdge = (node: Node, rp: Rp) => {\n  let res: Node | null = null\n  if (typeof node.coordinateArr === 'undefined') {\n    return null\n  }\n  node.coordinateArr.forEach((coordinate) => {\n    if (res) return\n    const dis = getTowCoordinateDistance(\n      rp.x,\n      rp.y,\n      coordinate[0],\n      coordinate[1]\n    )\n    if (dis <= CLICK_DISTANCE) {\n      res = node\n    }\n  })\n  return res\n}\n\n// Detects if a click is made on the edge of a line segment\nexport const checkIsAtLineEdge = (node: Node, rp: Rp) => {\n  const segments = []\n  if (typeof node.coordinateArr === 'undefined') {\n    return null\n  }\n  const len = node.coordinateArr.length\n  const arr = node.coordinateArr\n  for (let i = 0; i < len - 1; i += 1) {\n    segments.push([...arr[i], ...arr[i + 1]])\n  }\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n","import EventEmitter from 'eventemitter3'\n\nimport {\n  createNodeKey,\n  degToRad,\n  getNodeFourCorners,\n  getRotatedCoordinate\n} from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class BaseNode extends EventEmitter {\n  public app: AppObject\n\n  public id: string\n\n  public type: string\n\n  public key: number\n\n  public isCreate: boolean\n\n  public isActive: boolean\n\n  public isSelected: boolean\n\n  public startX: number\n\n  public startY: number\n\n  x: number\n\n  y: number\n\n  width: number\n\n  height: number\n\n  public startRotate: number\n\n  public rotate: number\n\n  public noRender: boolean\n\n  public style: any\n\n  dragNode: any\n\n  constructor(options: any, app: AppObject) {\n    super()\n    this.app = app\n    // Graphical object id\n    this.id = options.id\n    // Type\n    this.type = options.type || ''\n    // key\n    this.key = createNodeKey()\n    // Is it being created\n    this.isCreate = true\n    // Activated or not\n    this.isActive = true\n    // Whether selected by multiple choice\n    this.isSelected = false\n    // Record initial position for use when dragging\n    this.startX = 0\n    this.startY = 0\n    // Real-time position, which is the coordinate of the upper left corner of the graphic object\n    this.x = options.x || 0\n    this.y = options.y || 0\n    // Width and height\n    this.width = options.width || 0\n    this.height = options.height || 0\n    // Records the initial angle for use when rotating\n    this.startRotate = 0\n    // Angle\n    this.rotate = options.rotate || 0\n    // Does not need to be rendered\n    this.noRender = false\n    // style\n    this.style = {\n      strokeStyle: this.app.state.defaultColor,\n      fillStyle: 'transparent',\n      lineWidth: 2,\n      lineDash: 0,\n      globalAlpha: 1,\n      ...(options.style || {})\n    }\n    // Example of dragging and dropping a graphic object\n    this.dragNode = undefined\n  }\n\n  // Detects if a graphic object has been hit\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  isClick(x: number, y: number) {\n    throw new Error('Subclasses need to implement this method!')\n  }\n\n  // Offsetting the angle of a graphic object\n  offsetRotate(or: number) {\n    this.updateRotate(this.startRotate + or)\n    return this\n  }\n\n  // Setting the drawing style\n  setStyle(style = {}) {\n    const _style = style as any\n    Object.keys(_style).forEach((key) => {\n      if (key === 'lineDash') {\n        if (_style.lineDash > 0) {\n          this.app.ctx.setLineDash([_style.lineDash])\n        }\n      } else if (\n        _style[key] !== undefined &&\n        _style[key] !== '' &&\n        _style[key] !== null\n      ) {\n        // @ts-ignore\n        this.app.ctx[key] = _style[key]\n      }\n    })\n    return this\n  }\n\n  // Public rendering operations\n  warpRender(renderFn: any) {\n    const { x, y, width, height, rotate, style } = this\n    const { x: tx, y: ty } = this.app.calculate.transform(x, y)\n    const halfWidth = width / 2\n    const halfHeight = height / 2\n    const cx = tx + halfWidth\n    const cy = ty + halfHeight\n    this.app.ctx.save()\n    this.app.ctx.translate(cx, cy)\n    this.app.ctx.rotate(degToRad(rotate))\n    this.setStyle(style)\n    renderFn({\n      halfWidth,\n      halfHeight,\n      tx,\n      ty,\n      cx,\n      cy\n    })\n    this.app.ctx.restore()\n    return this\n  }\n\n  // Save the initial state of the graphic object\n  saveState() {\n    const { rotate, x, y } = this\n    this.startRotate = rotate\n    this.startX = x\n    this.startY = y\n    return this\n  }\n\n  // Moving graphic objects\n  move(ox: number, oy: number) {\n    const { startX, startY } = this\n    this.x = startX + ox\n    this.y = startY + oy\n    this.emit('nodePositionChange', this.x, this.y)\n    return this\n  }\n\n  // Updating the angle of a graphic object\n  updateRotate(rotate: number) {\n    rotate %= 360\n    if (rotate < 0) {\n      rotate = 360 + rotate\n    }\n    this.rotate = rotate\n    this.app.emitNodeRotateChange(this.rotate)\n  }\n\n  // Rotate the individual coordinates of a graphic object according to the specified centre coordinates\n  rotateByCenter(rotate: number, cx: number, cy: number) {\n    this.offsetRotate(rotate)\n    const np = getRotatedCoordinate(this.startX, this.startY, cx, cy, rotate)\n    this.updatePos(np.x, np.y)\n  }\n\n  // Start adjusting graphic objects\n  startResize(resizeType: string, e: any) {\n    this.dragNode.startResize(resizeType, e)\n    return this\n  }\n\n  // Ending the adjustment of graphic objects\n  endResize() {\n    this.dragNode.endResize()\n    return this\n  }\n\n  // Adjustment in graphic objects\n  resize(...args: any[]) {\n    this.dragNode.handleResizeNode(...args)\n    return this\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    return getNodeFourCorners(this as any)\n  }\n\n  // Update graphic object enclosures\n  updateRect(x: number, y: number, width: number, height: number) {\n    this.updatePos(x, y)\n    this.updateSize(width, height)\n    return this\n  }\n\n  // Update activation of graphic object sizes\n  updateSize(width: number, height: number) {\n    this.width = width\n    this.height = height\n    this.emit('nodeSizeChange', this.width, this.height)\n    return this\n  }\n\n  // Update coordinates of active graphic objects\n  updatePos(x: number, y: number) {\n    this.x = x\n    this.y = y\n    this.emit('nodePositionChange', this.x, this.y)\n    return this\n  }\n\n  // Serialisation\n  serialize() {\n    return {\n      id: this.id,\n      type: this.type,\n      width: this.width,\n      height: this.height,\n      x: this.x,\n      y: this.y,\n      rotate: this.rotate,\n      style: {\n        ...this.style\n      }\n    }\n  }\n\n  // Rendering drag-and-drop graphic objects\n  renderDragNode() {\n    if (this.isActive && !this.isCreate) {\n      this.dragNode.showAll()\n      this.dragNode.render()\n    } else if (this.isSelected) {\n      // Selected by multiple choice\n      this.dragNode.onlyShowBody()\n      this.dragNode.render()\n    }\n  }\n\n  // Rendering methods, which need to be implemented\n  render() {\n    throw new Error('Subclasses need to implement this method！')\n  }\n}\n","import {\n  deepCopy,\n  getBoundingRect,\n  getNodeCenterCoordinate,\n  getRotatedCoordinate\n} from '../common/utils'\nimport { AppObject } from '../types'\nimport BaseNode from './BaseNode'\n\nexport default class BaseMultiplexCoordinateNode extends BaseNode {\n  public startCoordinateArr: any[]\n\n  public coordinateArr: any\n\n  public startWidth: number | undefined\n\n  public startHeight: number | undefined\n\n  public fictitiousCoordinate: { x: number; y: number }\n\n  constructor(opts: any, app: AppObject) {\n    super(opts, app)\n    // Record initial coordinates when dragging\n    this.startCoordinateArr = []\n    // Coordinates\n    this.coordinateArr = opts.coordinateArr || []\n    // Record initial size for use when scaling\n    this.startWidth = 0\n    this.startHeight = 0\n    // The current live position of the mouse, used to display the virtual line from the last coordinate of the line segment to the current mouse when drawing\n    this.fictitiousCoordinate = {\n      x: 0,\n      y: 0\n    }\n  }\n\n  // Update graphic object enclosures\n  updateRect(x: number, y: number, width: number, height: number) {\n    const { startWidth, startHeight, startCoordinateArr } = this\n    if (\n      typeof startWidth === 'undefined' ||\n      typeof startHeight === 'undefined'\n    ) {\n      return this\n    }\n    const scaleX = width / startWidth\n    const scaleY = height / startHeight\n    this.coordinateArr = startCoordinateArr.map((coordinate) => {\n      const nx = coordinate[0] * scaleX\n      const ny = coordinate[1] * scaleY\n      return [nx, ny, ...coordinate.slice(2)]\n    })\n    const rect: any = getBoundingRect(this.coordinateArr)\n    const offsetX = rect.x - x\n    const offsetY = rect.y - y\n    this.coordinateArr = this.coordinateArr.map(\n      (coordinate: string | any[]) => [\n        coordinate[0] - offsetX,\n        coordinate[1] - offsetY,\n        ...coordinate.slice(2)\n      ]\n    )\n    this.updatePos(x, y)\n    this.updateSize(width, height)\n    return this\n  }\n\n  // Rotate the individual coordinates of a graphic object according to the specified centre coordinates\n  rotateByCenter(rotate: number, cx: number, cy: number) {\n    this.coordinateArr = this.startCoordinateArr.map((coordinate) => {\n      const np = getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        cx,\n        cy,\n        rotate\n      )\n      return [np.x, np.y, ...coordinate.slice(2)]\n    })\n    this.updateMultiplexCoordinateBoundingRect()\n  }\n\n  // Serialisation\n  serialize() {\n    const base = super.serialize()\n    return {\n      ...base,\n      coordinateArr: [...this.coordinateArr]\n    }\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    return this.coordinateArr.map((coordinate: number[]) => {\n      const center = getNodeCenterCoordinate(this as any)\n      const np = getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        center.x,\n        center.y,\n        this.rotate as number\n      )\n      return {\n        x: np.x,\n        y: np.y\n      }\n    })\n  }\n\n  // Adding coordinates, graphs with multiple coordinate data, e.g. line segments, free lines\n  addCoordinate(x: number, y: number, ...args: any[]) {\n    if (!Array.isArray(this.coordinateArr)) {\n      return undefined\n    }\n    this.coordinateArr.push([x, y, ...args])\n    return this\n  }\n\n  // Update of graphical object enclosures for graphs with multiple coordinate data\n  updateMultiplexCoordinateBoundingRect() {\n    const rect: any = getBoundingRect(this.coordinateArr)\n    this.x = rect.x\n    this.y = rect.y\n    this.width = rect.width\n    this.height = rect.height\n    return this\n  }\n\n  // Update virtual coordinates coordinates\n  updateFictitiousCoordinate(x: number, y: number) {\n    this.fictitiousCoordinate.x = x\n    this.fictitiousCoordinate.y = y\n  }\n\n  // Moving graphic objects\n  move(ox: number, oy: number) {\n    this.coordinateArr = this.startCoordinateArr.map((coordinate) => [\n      coordinate[0] + ox,\n      coordinate[1] + oy,\n      ...coordinate.slice(2)\n    ])\n    const { startX, startY } = this\n    if (startX && startY) {\n      this.x = startX + ox\n      this.y = startY + oy\n    }\n    return this\n  }\n\n  // Save the initial state of the graphic object\n  saveState() {\n    const { rotate, x, y, width, height, coordinateArr } = this\n    this.startRotate = rotate\n    this.startX = x\n    this.startY = y\n    this.startCoordinateArr = deepCopy(coordinateArr)\n    this.startWidth = width\n    this.startHeight = height\n    return this\n  }\n}\n","import {\n  degToRad,\n  getFontString,\n  radToDeg,\n  splitTextLines\n} from '../common/utils'\nimport { Ctx } from '../types'\n\n// Drawing public operations\nexport const plotWrap = (ctx: Ctx, fn: any, fill = false) => {\n  ctx.beginPath()\n  fn()\n  ctx.stroke()\n  if (fill) {\n    ctx.fill()\n  }\n}\n\n// Drawing circle\nexport const plotCircle = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  r: number,\n  fill = false\n) => {\n  plotWrap(\n    ctx,\n    () => {\n      ctx.arc(x, y, r, 0, 2 * Math.PI)\n    },\n    fill\n  )\n}\n\n// Drawing arrows\nexport const plotArrow = (ctx: Ctx, coordinateArr: any[]) => {\n  const x = coordinateArr[0][0]\n  const y = coordinateArr[0][1]\n  const tx = coordinateArr[coordinateArr.length - 1][0]\n  const ty = coordinateArr[coordinateArr.length - 1][1]\n  plotWrap(\n    ctx,\n    () => {\n      ctx.moveTo(x, y)\n      ctx.lineTo(tx, ty)\n    },\n    true\n  )\n  const l = 30\n  const deg = 30\n  const lineDeg = radToDeg(Math.atan2(ty - y, tx - x))\n  plotWrap(\n    ctx,\n    () => {\n      const plusDeg = deg - lineDeg\n      const _x = tx - l * Math.cos(degToRad(plusDeg))\n      const _y = ty + l * Math.sin(degToRad(plusDeg))\n      ctx.moveTo(_x, _y)\n      ctx.lineTo(tx, ty)\n    },\n    true\n  )\n  plotWrap(ctx, () => {\n    const plusDeg = 90 - lineDeg - deg\n    const _x = tx - l * Math.sin(degToRad(plusDeg))\n    const _y = ty - l * Math.cos(degToRad(plusDeg))\n    ctx.moveTo(_x, _y)\n    ctx.lineTo(tx, ty)\n  })\n}\n\n// Drawing rectangles\nexport const plotRect = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  fill = false\n) => {\n  plotWrap(ctx, () => {\n    ctx.rect(x, y, width, height)\n    if (fill) {\n      ctx.fillRect(x, y, width, height)\n    }\n  })\n}\n\n// Drawing a diamond\nexport const plotDiamond = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  fill = false\n) => {\n  plotWrap(\n    ctx,\n    () => {\n      ctx.moveTo(x + width / 2, y)\n      ctx.lineTo(x + width, y + height / 2)\n      ctx.lineTo(x + width / 2, y + height)\n      ctx.lineTo(x, y + height / 2)\n      ctx.closePath()\n    },\n    fill\n  )\n}\n\n// Convert the coordinates of the brush to the coordinates of the canvas\nconst transformArbitraryLineCoordinate = (\n  coordinate: string | any[],\n  opt: {\n    app: {\n      calculate: { transform: (arg0: any, arg1: any) => { x: any; y: any } }\n    }\n    cx: number\n    cy: number\n  }\n) => {\n  const { x, y } = opt.app.calculate.transform(coordinate[0], coordinate[1])\n  return [x - opt.cx, y - opt.cy, ...coordinate.slice(2)]\n}\n\n// Drawing line segments\nexport const plotLineSegment = (\n  ctx: Ctx,\n  mx: number,\n  my: number,\n  tx: number,\n  ty: number,\n  lineWidth = 0\n) => {\n  plotWrap(ctx, () => {\n    if (lineWidth > 0) {\n      ctx.lineWidth = lineWidth\n    }\n    ctx.moveTo(mx, my)\n    ctx.lineTo(tx, ty)\n    ctx.lineCap = 'round'\n    ctx.lineJoin = 'round'\n  })\n}\n\n// Drawing triangles\nexport const plotTriangle = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  width: number,\n  height: any,\n  fill = false\n) => {\n  plotWrap(\n    ctx,\n    () => {\n      ctx.moveTo(x + width / 2, y)\n      ctx.lineTo(x + width, y + height)\n      ctx.lineTo(x, y + height)\n      ctx.closePath()\n    },\n    fill\n  )\n}\n\n// Drawing free line segments (Also known as a paintbrush)\nexport const plotArbitraryLine = (\n  ctx: Ctx,\n  coordinates: string | any[],\n  opt: any\n) => {\n  for (let i = 0; i < coordinates.length - 1; i += 1) {\n    plotWrap(\n      ctx,\n      () => {\n        const coordinate = transformArbitraryLineCoordinate(coordinates[i], opt)\n        const nextCoordinate = transformArbitraryLineCoordinate(\n          coordinates[i + 1],\n          opt\n        )\n        plotLineSegment(\n          ctx,\n          coordinate[0],\n          coordinate[1],\n          nextCoordinate[0],\n          nextCoordinate[1],\n          nextCoordinate[2]\n        )\n      },\n      true\n    )\n  }\n}\n\n// Drawing text\nexport const plotText = (ctx: Ctx, textObj: any, x: number, y: number) => {\n  const { text, style } = textObj\n  const lineHeight = style.fontSize * style.lineHeightRatio\n  plotWrap(ctx, () => {\n    ctx.font = getFontString(style.fontSize, style.fontFamily)\n    ctx.textBaseline = 'middle'\n    const textArr = splitTextLines(text)\n    textArr.forEach((textRow, index) => {\n      ctx.fillText(textRow, x, y + (index * lineHeight + lineHeight / 2))\n    })\n  })\n}\n\n// Drawing pictures\nexport const plotImage = (\n  ctx: Ctx,\n  node: any,\n  x: number,\n  y: number,\n  width: number,\n  height: number\n) => {\n  plotWrap(ctx, () => {\n    const ratio = width / height\n    let showWidth = 0\n    let showHeight = 0\n    if (ratio > node.ratio) {\n      showHeight = height\n      showWidth = node.ratio * height\n    } else {\n      showWidth = width\n      showHeight = width / node.ratio\n    }\n    ctx.drawImage(node.imageObj, x, y, showWidth, showHeight)\n  })\n}\n\n// Draw the line\nexport const plotLine = (ctx: Ctx, coordinates: any[]) => {\n  plotWrap(ctx, () => {\n    let first = true\n    coordinates.forEach((coordinate) => {\n      if (first) {\n        first = false\n        ctx.moveTo(coordinate[0], coordinate[1])\n      } else {\n        ctx.lineTo(coordinate[0], coordinate[1])\n      }\n    })\n  })\n}\n","import { DRAG_NODE_PARTS, FOUR_CORNER } from '../common/constants'\nimport {\n  checkCoordinateIsInRectangle,\n  getNodeCenterCoordinate,\n  getNodeRotatedFourCornerCoordinate,\n  getRotatedCoordinate,\n  getTowCoordinateDistance,\n  getTowCoordinateRotate,\n  transformCoordinateOnNode,\n  transformCoordinateReverseRotate\n} from '../common/utils'\nimport { AppObject, Node } from '../types'\nimport BaseNode from './BaseNode'\nimport { plotCircle, plotRect } from './plot'\n\nexport default class DragNode extends BaseNode {\n  public options: Node\n\n  public node: any\n\n  public offset: number\n\n  public size: number\n\n  public resizeType: string\n\n  public diagonalCoordinate: { x: number; y: number }\n\n  public mousedownPosAndNodePosOffset: { x: number; y: number }\n\n  public nodeRatio: number\n\n  public hideParts: any[]\n\n  constructor(node: any, app: AppObject, options = {}) {\n    super(\n      {\n        type: 'dragNode',\n        notNeedDragNode: true\n      },\n      app\n    )\n\n    // @ts-ignore\n    this.options = {\n      lockRatio: false,\n      ...options\n    }\n\n    this.style = {\n      strokeStyle: '#666',\n      fillStyle: 'transparent',\n      lineWidth: 'small',\n      lineDash: 0,\n      globalAlpha: 1\n    }\n\n    // Attribution Nodes\n    this.node = node\n\n    // Distance to graphic objects\n    this.offset = 5\n\n    // Drag handle size\n    this.size = 10\n\n    // What adjustment operation is currently in progress\n    this.resizeType = ''\n\n    // Diagonal coordinates of the coordinates of the graphical object currently dragged with the mouse held down\n    this.diagonalCoordinate = {\n      x: 0,\n      y: 0\n    }\n\n    // The difference between the coordinates of the current mouse press and the coordinates of the dragged graphic object\n    this.mousedownPosAndNodePosOffset = {\n      x: 0,\n      y: 0\n    }\n\n    // Aspect ratio of graphical objects\n    this.nodeRatio = 0\n\n    // The hidden part\n    this.hideParts = []\n\n    this.x = 0\n    this.y = 0\n  }\n\n  // Start adjusting graphic objects\n  // @ts-ignore\n  startResize(resizeType: string, e: any) {\n    this.resizeType = resizeType\n    if (this.options.lockRatio) {\n      this.nodeRatio = this.node.width / this.node.height\n    }\n    if (resizeType === DRAG_NODE_PARTS.BODY) {\n      this.node.saveState()\n    } else if (resizeType === DRAG_NODE_PARTS.ROTATE) {\n      this.node.saveState()\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_LEFT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.TOP_LEFT)\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_RIGHT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.TOP_RIGHT)\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.BOTTOM_RIGHT)\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.BOTTOM_LEFT)\n    }\n  }\n\n  // Ending the adjustment of graphic objects\n  // @ts-ignore\n  endResize() {\n    this.resizeType = ''\n    this.diagonalCoordinate = {\n      x: 0,\n      y: 0\n    }\n    this.mousedownPosAndNodePosOffset = {\n      x: 0,\n      y: 0\n    }\n    this.nodeRatio = 0\n  }\n\n  // Handling of four retractable handle events for dragging graphic objects by pressing\n  handleDragMousedown(e: { clientX: number; clientY: number }, corner: string) {\n    const centerPos = getNodeCenterCoordinate(this.node)\n    const pos: any = getNodeRotatedFourCornerCoordinate(this.node, corner)\n    this.diagonalCoordinate.x = 2 * centerPos.x - pos.x\n    this.diagonalCoordinate.y = 2 * centerPos.y - pos.y\n    this.mousedownPosAndNodePosOffset.x = e.clientX - pos.x\n    this.mousedownPosAndNodePosOffset.y = e.clientY - pos.y\n    this.node.saveState()\n  }\n\n  // Adjusting graphic objects\n  handleResizeNode(\n    e: any,\n    mx: number,\n    my: number,\n    offsetX: number,\n    offsetY: number\n  ) {\n    const { resizeType } = this\n    if (resizeType === DRAG_NODE_PARTS.BODY) {\n      this.handleMoveNode(offsetX, offsetY)\n    } else if (resizeType === DRAG_NODE_PARTS.ROTATE) {\n      this.handleRotateNode(e, mx, my)\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_LEFT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (newCenter.x - rp.x) * 2,\n          height: (newCenter.y - rp.y) * 2\n        }),\n        (rp: { x: any; y: any }) => ({\n          x: rp.x,\n          y: rp.y\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; width?: any; height?: any; y?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + newRect.width - this.nodeRatio * newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            y = newRect.y + (newRect.height - newRect.width / this.nodeRatio)\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_RIGHT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (rp.x - newCenter.x) * 2,\n          height: (newCenter.y - rp.y) * 2\n        }),\n        (rp: { x: number; y: any }, newSize: { width: number }) => ({\n          x: rp.x - newSize.width,\n          y: rp.y\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; height?: any; width?: any; y?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + this.nodeRatio * newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            x = newRect.x + newRect.width\n            y = newRect.y + (newRect.height - newRect.width / this.nodeRatio)\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (rp.x - newCenter.x) * 2,\n          height: (rp.y - newCenter.y) * 2\n        }),\n        (\n          rp: { x: number; y: number },\n          newSize: { width: number; height: number }\n        ) => ({\n          x: rp.x - newSize.width,\n          y: rp.y - newSize.height\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; height?: any; y?: any; width?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + this.nodeRatio * newRect.height\n            y = newRect.y + newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            x = newRect.x + newRect.width\n            y = newRect.y + newRect.width / this.nodeRatio\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (newCenter.x - rp.x) * 2,\n          height: (rp.y - newCenter.y) * 2\n        }),\n        (rp: { x: number; y: number }, newSize: { height: number }) => ({\n          x: rp.x,\n          y: rp.y - newSize.height\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; width?: any; height?: any; y?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + newRect.width - this.nodeRatio * newRect.height\n            y = newRect.y + newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            y = newRect.y + newRect.width / this.nodeRatio\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    }\n  }\n\n  // Move the graphic object as a whole\n  handleMoveNode(offsetX: number, offsetY: number) {\n    this.node.move(offsetX, offsetY)\n  }\n\n  // Rotating graphic objects\n  handleRotateNode(\n    e: { clientX: number; clientY: number },\n    mx: number,\n    my: number\n  ) {\n    const centerPos = getNodeCenterCoordinate(this.node)\n    const rotate = getTowCoordinateRotate(\n      centerPos.x,\n      centerPos.y,\n      e.clientX,\n      e.clientY,\n      mx,\n      my\n    )\n    this.node.offsetRotate(rotate)\n  }\n\n  // Set the hidden section\n  setHideParts(parts = []) {\n    this.hideParts = parts\n  }\n\n  // Show all sections\n  showAll() {\n    this.setHideParts([])\n  }\n\n  // Only the main part is displayed\n  onlyShowBody() {\n    this.setHideParts([\n      DRAG_NODE_PARTS.ROTATE,\n      DRAG_NODE_PARTS.TOP_LEFT_BUTTON,\n      DRAG_NODE_PARTS.TOP_RIGHT_BUTTON,\n      DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON,\n      DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON\n    ] as any)\n  }\n\n  // Update data\n  update() {\n    this.x = this.node.x - this.offset\n    this.y = this.node.y - this.offset\n    this.width = this.node.width + this.offset * 2\n    this.height = this.node.height + this.offset * 2\n    this.rotate = this.node.rotate\n  }\n\n  // Scaling calculations\n  stretchCalc(\n    x: number,\n    y: number,\n    calcSize: (\n      arg0: { x: number; y: number },\n      arg1: { x: number; y: number }\n    ) => any,\n    calcPos: (arg0: { x: number; y: number }, arg1: any) => any\n  ) {\n    const newCenter = {\n      x: (x + this.diagonalCoordinate.x) / 2,\n      y: (y + this.diagonalCoordinate.y) / 2\n    }\n    const rp = transformCoordinateReverseRotate(\n      x,\n      y,\n      newCenter.x,\n      newCenter.y,\n      this.node.rotate\n    )\n    const newSize = calcSize(newCenter, rp)\n    let isWidthReverse = false\n    if (newSize.width < 0) {\n      newSize.width = 0\n      isWidthReverse = true\n    }\n    let isHeightReverse = false\n    if (newSize.height < 0) {\n      newSize.height = 0\n      isHeightReverse = true\n    }\n    const newPos = calcPos(rp, newSize)\n    const newRect = {\n      x: newPos.x,\n      y: newPos.y,\n      width: newSize.width,\n      height: newSize.height\n    }\n    if (isWidthReverse || isHeightReverse) {\n      newRect.x = this.node.x\n      newRect.y = this.node.y\n    }\n    return {\n      newRect,\n      newCenter\n    }\n  }\n\n  // Stretching graphic objects\n  handleStretchNode(\n    e: { clientX: number; clientY: number },\n    calcSize: any,\n    calcPos: any,\n    fixPos: any\n  ) {\n    const actClientX = e.clientX - this.mousedownPosAndNodePosOffset.x\n    const actClientY = e.clientY - this.mousedownPosAndNodePosOffset.y\n    const { newRect, newCenter } = this.stretchCalc(\n      actClientX,\n      actClientY,\n      calcSize,\n      calcPos\n    )\n    if (this.options.lockRatio) {\n      this.fixStretch(newRect, newCenter, calcSize, calcPos, fixPos)\n      return\n    }\n    this.node.updateRect(newRect.x, newRect.y, newRect.width, newRect.height)\n  }\n\n  // Correction of new graphics when aspect ratio is locked\n  fixStretch(\n    newRect: { x?: any; y?: any; width: any; height: any },\n    newCenter: { x: any; y: any },\n    calcSize: {\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (arg0: { x: number; y: number }, arg1: { x: number; y: number }): any\n      (arg0: { x: number; y: number }, arg1: { x: number; y: number }): any\n    },\n    calcPos: {\n      (rp: { x: any; y: any }): { x: any; y: any }\n      (rp: { x: number; y: any }, newSize: { width: number }): {\n        x: number\n        y: any\n      }\n      (\n        rp: { x: number; y: number },\n        newSize: { width: number; height: number }\n      ): { x: number; y: number }\n      (rp: { x: number; y: number }, newSize: { height: number }): {\n        x: number\n        y: number\n      }\n      (arg0: { x: number; y: number }, arg1: any): any\n      (arg0: { x: number; y: number }, arg1: any): any\n    },\n    fixPos: {\n      (\n        newRatio: number,\n        newRect: { x?: any; width?: any; height?: any; y?: any }\n      ): { x: any; y: any }\n      (\n        newRatio: number,\n        newRect: { x?: any; height?: any; width?: any; y?: any }\n      ): { x: any; y: any }\n      (\n        newRatio: number,\n        newRect: { x?: any; height?: any; y?: any; width?: any }\n      ): { x: any; y: any }\n      (\n        newRatio: number,\n        newRect: { x?: any; width?: any; height?: any; y?: any }\n      ): { x: any; y: any }\n      (arg0: number, arg1: any): any\n    }\n  ) {\n    const newRatio = newRect.width / newRect.height\n    const fp = fixPos(newRatio, newRect)\n    const rp = getRotatedCoordinate(\n      fp.x,\n      fp.y,\n      newCenter.x,\n      newCenter.y,\n      this.node.rotate\n    )\n    const fixNewRect = this.stretchCalc(rp.x, rp.y, calcSize, calcPos).newRect\n    if (fixNewRect.width === 0 && fixNewRect.height === 0) {\n      return\n    }\n    this.node.updateRect(\n      fixNewRect.x,\n      fixNewRect.y,\n      fixNewRect.width,\n      fixNewRect.height\n    )\n  }\n\n  render() {\n    this.update()\n    const { width, height } = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      this.app.ctx.save()\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.BODY)) {\n        this.app.ctx.setLineDash([5])\n        plotRect(this.app.ctx, -halfWidth, -halfHeight, width, height)\n        this.app.ctx.restore()\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.TOP_LEFT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth - this.size,\n          -halfHeight - this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.TOP_RIGHT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth + this.node.width + this.size,\n          -halfHeight - this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth + this.node.width + this.size,\n          -halfHeight + this.node.height + this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth - this.size,\n          -halfHeight + this.node.height + this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.ROTATE)) {\n        plotCircle(\n          this.app.ctx,\n          -halfWidth + this.node.width / 2 + this.size / 2,\n          -halfHeight - this.size * 2,\n          this.size\n        )\n      }\n    })\n  }\n\n  // Detects which part of a dragged graphic object a coordinate is on\n  checkCoordinateInDragNodeWhere(x: number, y: number) {\n    let part = ''\n    const rp = transformCoordinateOnNode(x, y, this.node)\n    if (checkCoordinateIsInRectangle(rp.x, rp.y, this as any)) {\n      part = DRAG_NODE_PARTS.BODY\n    } else if (\n      getTowCoordinateDistance(\n        rp.x,\n        rp.y,\n        this.x + this.width / 2,\n        this.y - this.size * 2\n      ) <= this.size\n    ) {\n      part = DRAG_NODE_PARTS.ROTATE\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.TOP_LEFT)\n    ) {\n      part = DRAG_NODE_PARTS.TOP_LEFT_BUTTON\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.TOP_RIGHT)\n    ) {\n      part = DRAG_NODE_PARTS.TOP_RIGHT_BUTTON\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.BOTTOM_RIGHT)\n    ) {\n      part = DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.BOTTOM_LEFT)\n    ) {\n      part = DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON\n    }\n    if (this.hideParts.includes(part)) {\n      part = ''\n    }\n    return part\n  }\n\n  // Detects if the coordinates are within a drag and drop button\n  _checkCoordinateIsInButton(x: number, y: number, dir: string) {\n    let _x = 0\n    let _y = 0\n    switch (dir) {\n      case FOUR_CORNER.TOP_LEFT:\n        _x = this.x - this.size\n        _y = this.y - this.size\n        break\n      case FOUR_CORNER.TOP_RIGHT:\n        _x = this.x + this.width\n        _y = this.y - this.size\n        break\n      case FOUR_CORNER.BOTTOM_RIGHT:\n        _x = this.x + this.width\n        _y = this.y + this.height\n        break\n      case FOUR_CORNER.BOTTOM_LEFT:\n        _x = this.x - this.size\n        _y = this.y + this.height\n        break\n      default:\n        break\n    }\n    return checkCoordinateIsInRectangle(x, y, _x, _y, this.size, this.size)\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtArbitraryPlotLineEdge } from '../common/utils/checkClick'\nimport BaseMultiplexCoordinateNode from '../support/BaseMultiplexCoordinateNode'\nimport DragNode from '../support/DragNode'\nimport { plotArbitraryLine, plotLineSegment } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class ArbitraryPlot extends BaseMultiplexCoordinateNode {\n  public lastLineWidth: number\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n\n    // The third number of the coordinates [x,y,speed] is the line width\n    this.lastLineWidth = -1\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtArbitraryPlotLineEdge(this as any, rp)\n  }\n\n  // Rendering of a single line segment\n  singleRender(\n    mx: number,\n    my: number,\n    tx: number,\n    ty: number,\n    lineWidth: number | undefined\n  ) {\n    this.app.ctx.save()\n    plotLineSegment(this.app.ctx, mx, my, tx, ty, lineWidth)\n    this.app.ctx.restore()\n  }\n\n  render() {\n    const { coordinateArr }: any = this\n    this.warpRender(({ cx, cy }: any) => {\n      plotArbitraryLine(this.app.ctx, coordinateArr, {\n        app: this.app,\n        cx,\n        cy\n      })\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtArrowEdge } from '../common/utils/checkClick'\nimport BaseMultiplexCoordinateNode from '../support/BaseMultiplexCoordinateNode'\nimport DragNode from '../support/DragNode'\nimport { plotArrow } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Arrow extends BaseMultiplexCoordinateNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, app)\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtArrowEdge(this, rp)\n  }\n\n  render() {\n    const { coordinateArr, fictitiousCoordinate }: any = this\n    this.warpRender(({ cx, cy }: { cx: number; cy: number }) => {\n      // Plus the current live position of the mouse\n      let realtimeCoordinate: any[][] = []\n      if (coordinateArr.length > 0 && this.isCreate) {\n        const { x: fx, y: fy } = this.app.calculate.transform(\n          fictitiousCoordinate.x - cx,\n          fictitiousCoordinate.y - cy\n        )\n        realtimeCoordinate = [[fx, fy]]\n      }\n      plotArrow(\n        this.app.ctx,\n        coordinateArr\n          .map((coordinate: any[]) => {\n            const { x, y } = this.app.calculate.transform(\n              coordinate[0],\n              coordinate[1]\n            )\n            return [x - cx, y - cy]\n          })\n          .concat(realtimeCoordinate)\n      )\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport {\n  checkIsAtCircleEdge,\n  getCircleRadius\n} from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotCircle } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Circle extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app, {\n      lockRatio: true\n    })\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtCircleEdge(this, rp)\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(() => {\n      plotCircle(this.app.ctx, 0, 0, getCircleRadius(width, height), true)\n    })\n    this.renderDragNode()\n  }\n}\n","import {\n  getNodeCenterCoordinate,\n  getRotatedCoordinate,\n  transformCoordinateOnNode\n} from '../common/utils'\nimport { checkIsAtDiamondEdge } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotDiamond } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Diamond extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtDiamondEdge(this, rp)\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    const { x, y, width, height, rotate }: any = this\n    const coordinates = [\n      [x + width / 2, y],\n      [x + width, y + height / 2],\n      [x + width / 2, y + height],\n      [x, y + height / 2]\n    ]\n    const center = getNodeCenterCoordinate(this)\n    return coordinates.map((coordinate) =>\n      getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        center.x,\n        center.y,\n        rotate\n      )\n    )\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotDiamond(this.app.ctx, -halfWidth, -halfHeight, width, height, true)\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtRectangleInner } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotImage } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Image extends BaseNode {\n  public url: string\n\n  public imageObj: null\n\n  public ratio: number\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app, {\n      lockRatio: true\n    })\n\n    const { url, imageObj, ratio }: any = options\n\n    this.url = url || ''\n\n    this.imageObj = imageObj || null\n\n    this.ratio = ratio || 1\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtRectangleInner(this, rp)\n  }\n\n  // Serialisation\n  serialize() {\n    const base = super.serialize()\n    return {\n      ...base,\n      url: this.url,\n      ratio: this.ratio\n    }\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotImage(this.app.ctx, this, -halfWidth, -halfHeight, width, height)\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtLineEdge } from '../common/utils/checkClick'\nimport BaseMultiplexCoordinateNode from '../support/BaseMultiplexCoordinateNode'\nimport DragNode from '../support/DragNode'\nimport { plotLine } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Line extends BaseMultiplexCoordinateNode {\n  public isSingle: boolean\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n\n    // Is it a single line segment, otherwise it is a folded line consisting of multiple line segments\n    const { isSingle = false }: any = options\n\n    this.isSingle = isSingle\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtLineEdge(this as any, rp)\n  }\n\n  render() {\n    const { coordinateArr, fictitiousCoordinate }: any = this\n    this.warpRender(({ cx, cy }: any) => {\n      // Plus the current live position of the mouse\n      let realtimeCoordinate: any[][] = []\n      if (coordinateArr.length > 0 && this.isCreate) {\n        const { x: fx, y: fy } = this.app.calculate.transform(\n          fictitiousCoordinate.x - cx,\n          fictitiousCoordinate.y - cy\n        )\n        realtimeCoordinate = [[fx, fy]]\n      }\n      plotLine(\n        this.app.ctx,\n        coordinateArr\n          .map((coordinate: any[]) => {\n            const { x, y } = this.app.calculate.transform(\n              coordinate[0],\n              coordinate[1]\n            )\n            return [x - cx, y - cy]\n          })\n          .concat(realtimeCoordinate)\n      )\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtRectangleEdge } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotRect } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Rectangle extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtRectangleEdge(this, rp)\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotRect(this.app.ctx, -halfWidth, -halfHeight, width, height, true)\n    })\n    this.renderDragNode()\n  }\n}\n","import { splitTextLines, transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtRectangleInner } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotText } from '../support/plot'\nimport { AppObject, Node } from '../types'\n\nexport default class Text extends BaseNode {\n  public text: string\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app, {\n      lockRatio: true\n    })\n\n    this.text = options?.text || ''\n\n    this.style.fillStyle = options?.style?.fillStyle || '#000000'\n\n    this.style.fontSize = options?.style?.fontSize || 18\n\n    this.style.lineHeightRatio = options?.style?.lineHeightRatio || 1.5\n\n    this.style.fontFamily =\n      options?.style?.fontFamily || 'Microsoft YaHei, sans-serif'\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtRectangleInner(this, rp)\n  }\n\n  // Update the wrap-around box\n  // @ts-ignore\n  updateRect(x: number, y: number, width: number, height: number) {\n    const { text, style } = this\n    this.style.fontSize = Math.floor(\n      height / splitTextLines(text).length / style.lineHeightRatio\n    )\n    super.updateRect(x, y, width, height)\n  }\n\n  serialize() {\n    const base = super.serialize()\n    return {\n      ...base,\n      text: this.text\n    }\n  }\n\n  render() {\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotText(this.app.ctx, this, -halfWidth, -halfHeight)\n    })\n    this.renderDragNode()\n  }\n}\n","import {\n  getNodeCenterCoordinate,\n  getRotatedCoordinate,\n  transformCoordinateOnNode\n} from '../common/utils'\nimport { checkIsAtTriangleEdge } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotTriangle } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Triangle extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    const { x, y, width, height, rotate }: any = this\n    const coordinates = [\n      [x + width / 2, y],\n      [x + width, y + height],\n      [x, y + height]\n    ]\n    const center = getNodeCenterCoordinate(this)\n    return coordinates.map((coordinate) =>\n      getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        center.x,\n        center.y,\n        rotate\n      )\n    )\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtTriangleEdge(this as any, rp)\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotTriangle(this.app.ctx, -halfWidth, -halfHeight, width, height, true)\n    })\n    this.renderDragNode()\n  }\n}\n","import { DRAG_NODE_PARTS } from '../common/constants'\nimport {\n  computedLineWidthBySpeed,\n  createImageObj,\n  getNodeID,\n  getTowCoordinateDistance,\n  throttle\n} from '../common/utils'\nimport ArbitraryPlot from '../components/ArbitraryPlot'\nimport Arrow from '../components/Arrow'\nimport Circle from '../components/Circle'\nimport Diamond from '../components/Diamond'\nimport Image from '../components/Image'\nimport Line from '../components/Line'\nimport Rectangle from '../components/Rectangle'\nimport Text from '../components/Text'\nimport Triangle from '../components/Triangle'\nimport { AppObject, Ctx, Node, NodeArray, PlotType } from '../types'\n\nexport default class Nodes {\n  public app: AppObject\n\n  public nodeList: NodeArray\n\n  activeNode: Node | undefined\n\n  public isCreateNode: boolean\n\n  public isResize: boolean\n\n  public resizeNode: Node | null\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    // All graphic objects\n    this.nodeList = []\n\n    // Currently active graphic object\n    this.activeNode = undefined\n\n    // A new graphic object is currently being created\n    this.isCreateNode = false\n\n    // The graphic object is currently being adjusted\n    this.isResize = false\n\n    // The graphic object currently being adjusted\n    this.resizeNode = null\n\n    // A little relief from lag\n    this.handleResize = throttle(this.handleResize, this as any, 15)\n  }\n\n  createNode(\n    options: any,\n    callback: (...args: any) => void = () => {},\n    ctx?: Ctx,\n    notActive?: boolean\n  ) {\n    if (this.hasActiveNode() || this.isCreateNode) {\n      return this\n    }\n    options.id = getNodeID()\n    const node: any = this.pureCreateNode(options)\n    if (!node) {\n      return this\n    }\n    this.addNode(node)\n    if (!notActive) {\n      this.setActiveNode(node)\n    }\n    this.isCreateNode = true\n    // @ts-ignore\n    callback.call(ctx, node)\n    return this\n  }\n\n  copyNode(node: Node, notActive?: boolean, pos?: { x: number; y: number }) {\n    return new Promise<any>(async (resolve) => {\n      if (!node) {\n        return\n      }\n      const data: any = node.serialize?.()\n      if (data.type === 'image' && data.url != null) {\n        data.imageObj = (await createImageObj(data.url)) as HTMLInputElement\n      }\n      this.createNode(\n        data,\n        (node: any) => {\n          node.startResize(DRAG_NODE_PARTS.BODY)\n          let ox = 20\n          let oy = 20\n          if (pos) {\n            ox = pos.x - node.x - node.width / 2\n            oy = pos.y - node.y - node.height / 2\n          }\n          const gridAdsorbentPos = this.app.calculate.gridAdsorbent(ox, oy)\n          node.resize(null, null, null, gridAdsorbentPos.x, gridAdsorbentPos.y)\n          node.isCreate = false\n          if (notActive) {\n            node.isActive = false\n          }\n          this.isCreateNode = false\n          resolve(node)\n        },\n        this as unknown as Ctx,\n        notActive\n      )\n    })\n  }\n\n  // Rectangle-like graphic object being created\n  createRectangleLikeNode(\n    type: PlotType,\n    x: number,\n    y: number,\n    offsetX: number,\n    offsetY: number\n  ) {\n    this.createNode({\n      type,\n      x,\n      y,\n      width: offsetX,\n      height: offsetY\n    })\n    this.activeNode?.updateSize?.(offsetX, offsetY)\n  }\n\n  // Circular graphic object being created\n  createCircle(x: number, y: number, e: { clientX: any; clientY: any }) {\n    this.createNode({\n      type: 'circle',\n      x,\n      y\n    })\n    const radius = getTowCoordinateDistance(e.clientX, e.clientY, x, y)\n    this.activeNode?.updateSize?.(radius, radius)\n  }\n\n  // Freehand brush graphic object being created\n  createArbitraryPlot(\n    e: { clientX: any; clientY: any },\n    event: { mouseSpeed: number; lastMousePos: { x: number; y: number } }\n  ) {\n    this.createNode({\n      type: 'arbitrary-plot'\n    })\n    const node = this.activeNode\n    // Calculating brush thickness\n    const lineWidth = computedLineWidthBySpeed(\n      event.mouseSpeed,\n      <number>node?.lastLineWidth\n    )\n    if (node?.lastLineWidth) {\n      node.lastLineWidth = lineWidth\n    }\n    node?.addCoordinate?.(e.clientX, e.clientY, lineWidth)\n    // The brush is not repainted and incremental painting is used, otherwise it will lag\n    const { calculate, ctx, state } = this.app\n    const tfp = calculate.transformToCanvasCalculate(\n      calculate.subScrollX(event.lastMousePos.x),\n      calculate.subScrollY(event.lastMousePos.y)\n    )\n    const ttp = calculate.transformToCanvasCalculate(\n      calculate.subScrollX(e.clientX),\n      calculate.subScrollY(e.clientY)\n    )\n    ctx.save()\n    ctx.scale(<number>state.scale, <number>state.scale)\n    node?.singleRender?.(tfp.x, tfp.y, ttp.x, ttp.y, lineWidth)\n    ctx.restore()\n  }\n\n  // Image graphic object being created\n  createImage(\n    e: { unGridClientX: number; unGridClientY: number },\n    {\n      width,\n      height,\n      imageObj,\n      url,\n      ratio\n    }: {\n      width: number\n      height: number\n      imageObj: HTMLInputElement\n      url: string\n      ratio: number\n    }\n  ) {\n    const gp = this.app.calculate.gridAdsorbent(\n      e.unGridClientX - width / 2,\n      e.unGridClientY - height / 2\n    )\n    this.createNode({\n      type: 'image',\n      x: gp.x,\n      y: gp.y,\n      url,\n      imageObj,\n      width,\n      height,\n      ratio\n    })\n  }\n\n  // Text graphic object being edited\n  editingText(node: Node) {\n    if (node.type !== 'text') {\n      return\n    }\n    node.noRender = true\n    this.setActiveNode(node)\n  }\n\n  // Complete editing of text graphic objects\n  completeEditingText() {\n    const node = this.activeNode\n    if (!node || node.type !== 'text') {\n      return\n    }\n    if (!node?.text?.trim()) {\n      this.deleteNode(node)\n      this.setActiveNode()\n      return\n    }\n    node.noRender = false\n  }\n\n  // Complete the creation of the arrow graphic object\n  completeCreateArrow(e: { clientX: number; clientY: number }) {\n    this.activeNode?.addCoordinate?.(e.clientX, e.clientY)\n  }\n\n  // Arrowhead graphic object being created\n  createArrow(x: number, y: number, e: { clientX: any; clientY: any }) {\n    this.createNode(\n      {\n        type: 'arrow',\n        x,\n        y\n      },\n      (node) => {\n        node.addCoordinate(x, y)\n      }\n    )\n    this.activeNode?.updateFictitiousCoordinate?.(e.clientX, e.clientY)\n  }\n\n  // Line/line graphical object being created\n  createLine(\n    x: number | undefined,\n    y: number | undefined,\n    e: { clientX: number; clientY: number },\n    isSingle = false,\n    notCreate = false\n  ) {\n    if (!notCreate) {\n      this.createNode(\n        {\n          type: 'line',\n          x,\n          y,\n          isSingle\n        },\n        (node) => {\n          node.addCoordinate(x, y)\n        }\n      )\n    }\n    const node = this.activeNode\n    if (node) {\n      node.updateFictitiousCoordinate?.(e.clientX, e.clientY)\n    }\n  }\n\n  insertNode(node: Node, index: number) {\n    this.nodeList.splice(index, 0, node)\n  }\n\n  addNode(node: Node) {\n    this.nodeList.push(node)\n    return this\n  }\n\n  getNodesNum() {\n    return this.nodeList.length\n  }\n\n  hasNodes() {\n    return this.nodeList.length > 0\n  }\n\n  unshiftNode(node: Node) {\n    this.nodeList.unshift(node)\n    return this\n  }\n\n  // Deleting graphic objects\n  deleteNode(node: Node) {\n    const index = this.getNodeIndex(node)\n    if (index !== -1) {\n      this.nodeList.splice(index, 1)\n      if (node.isActive) {\n        this.cancelActiveNode()\n      }\n    }\n    return this\n  }\n\n  // Delete all graphic objects\n  deleteAllNodes() {\n    this.activeNode = undefined\n    this.nodeList = []\n    this.isCreateNode = false\n    this.isResize = false\n    this.resizeNode = null\n    return this\n  }\n\n  // Get the index of the graphic object in the list of graphic objects\n  getNodeIndex(node: Node) {\n    return this.nodeList.findIndex((item) => item === node)\n  }\n\n  // Create graphic objects from graphic object data\n  createNodesFromData(nodes: NodeArray) {\n    this.app.oldData = this.app.getData()\n    nodes.forEach((node) => {\n      const nodeObject: any = this.pureCreateNode(node)\n      nodeObject.isActive = false\n      nodeObject.isCreate = false\n      this.addNode(nodeObject as Node)\n    })\n    return this\n  }\n\n  // Presence or absence of active graphic objects\n  hasActiveNode() {\n    return this.activeNode\n  }\n\n  // Setting the activation of graphic objects\n  setActiveNode(node?: Node) {\n    this.cancelActiveNode()\n    this.activeNode = node\n    if (node) {\n      node.isActive = true\n    }\n    this.app.emit('activeNodeChange', this.activeNode)\n    return this\n  }\n\n  // Cancel the currently active graphic object\n  cancelActiveNode() {\n    if (!this.hasActiveNode()) {\n      return this\n    }\n    if (this.activeNode) {\n      this.activeNode.isActive = false\n      this.activeNode = undefined\n    }\n    this.app.emit('activeNodeChange', this.activeNode)\n    return this\n  }\n\n  // Detects if a graphic object is selected by a coordinate click\n  checkIsClickNode(e: any) {\n    const x = e.unGridClientX\n    const y = e.unGridClientY\n    for (let i = this.nodeList.length - 1; i >= 0; i -= 1) {\n      const node = this.nodeList[i]\n      if (node.isClick?.(x, y)) {\n        return node\n      }\n    }\n    return null\n  }\n\n  pureCreateNode(options: any = {}) {\n    switch (options.type) {\n      case 'rectangle':\n        return new Rectangle(options, this.app)\n      case 'diamond':\n        return new Diamond(options, this.app)\n      case 'triangle':\n        return new Triangle(options, this.app)\n      case 'circle':\n        return new Circle(options, this.app)\n      case 'arbitrary-plot':\n        return new ArbitraryPlot(options, this.app)\n      case 'image':\n        return new Image(options, this.app)\n      case 'arrow':\n        return new Arrow(options, this.app)\n      case 'line':\n        return new Line(options, this.app)\n      case 'text':\n        return new Text(options, this.app)\n      default:\n        return null\n    }\n  }\n\n  // Complete the creation of line/dash graphical objects\n  completeCreateLine(\n    e: { clientX: number; clientY: number },\n    completeCallback = () => {}\n  ) {\n    let node = this.activeNode\n    const x = e.clientX\n    const y = e.clientY\n    if (node && node.isSingle) {\n      node.addCoordinate?.(x, y)\n      completeCallback()\n    } else {\n      this.createNode({\n        type: 'line',\n        isSingle: false\n      })\n      node = this.activeNode\n      node?.addCoordinate?.(x, y)\n      node?.updateFictitiousCoordinate?.(x, y)\n    }\n  }\n\n  // Creation of graphic objects complete\n  completeCreateNode() {\n    this.isCreateNode = false\n    const node: any = this.activeNode\n    if (!node) {\n      return this\n    }\n    if (['arbitrary-plot', 'arrow', 'line'].includes(node.type)) {\n      node.updateMultiplexCoordinateBoundingRect()\n    }\n    node.isCreate = false\n    this.app.emitChange()\n    return this\n  }\n\n  // Styling of active graphic objects\n  setActiveNodeStyle(style = {}) {\n    if (!this.hasActiveNode()) {\n      return this\n    }\n    Object.keys(style).forEach((key) => {\n      // @ts-ignore\n      this.activeNode.style[key] = style[key]\n    })\n    return this\n  }\n\n  // Detects if the specified position is on the graphic object adjustment handle\n  checkInResizeHand(x: any, y: any) {\n    const node = this.activeNode\n    const hand = node?.dragNode?.checkCoordinateInDragNodeWhere?.(x, y)\n    if (hand) {\n      return {\n        node,\n        hand\n      }\n    }\n    return null\n  }\n\n  // Check if a graphic object adjustment operation is required\n  checkIsResize(x: number, y: number, e: any) {\n    if (!this.hasActiveNode()) {\n      return false\n    }\n    const res = this.checkInResizeHand(x, y)\n    if (res) {\n      this.isResize = true\n      if (res.node) {\n        this.resizeNode = res.node\n        this.resizeNode.startResize?.(res.hand, e)\n      }\n      this.app.cursor.setResize(res.hand)\n      return true\n    }\n    return false\n  }\n\n  // Performing graphic object adjustment operations\n  handleResize(...args: any[]) {\n    if (!this.isResize) {\n      return\n    }\n    this.resizeNode?.resize?.(...args)\n  }\n\n  // Ending a graphic object adjustment operation\n  endResize() {\n    this.isResize = false\n    this.resizeNode?.endResize?.()\n    this.resizeNode = null\n  }\n\n  // Serialize all graphic objects on the current canvas\n  serialize(stringify = false) {\n    const data = this.nodeList.map((node) => node.serialize?.())\n    return stringify ? JSON.stringify(data) : data\n  }\n}\n","import { getMultiplexNodeRectInfo } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class Render {\n  public app: AppObject\n\n  public beingCopyActiveNode: null\n\n  public beingCopySelectedNodes: any[]\n\n  public beingCopyNode: undefined\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    // The active graphic object that will be copied\n    this.beingCopyActiveNode = null\n\n    // The selected graphic object that will be copied\n    this.beingCopySelectedNodes = []\n\n    this.registerShortcutKeys()\n  }\n\n  // Styling of active graphic objects\n  setActiveNodeStyle(style = {}) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.setActiveNodeStyle(style)\n    this.render()\n    if (!this.app.nodes.isCreateNode) {\n      this.app.emitChange()\n    }\n    return this\n  }\n\n  // Set the style for the currently active or selected graphic object\n  setCurrentNodesStyle(style = {}) {\n    this.setActiveNodeStyle(style)\n    this.app.selection.setSelectedNodeStyle(style)\n  }\n\n  clearCanvas() {\n    const { width, height } = this.app\n    this.app.ctx.clearRect(-width / 2, -height / 2, width, height)\n    return this\n  }\n\n  render() {\n    const { state } = this.app\n    this.clearCanvas()\n    this.app.ctx.save()\n    this.app.ctx.scale(<number>state.scale, <number>state.scale)\n    this.app.nodes.nodeList.forEach((node: any) => {\n      if (node.noRender) {\n        return\n      }\n      node.render()\n    })\n    this.app.ctx.restore()\n    return this\n  }\n\n  registerShortcutKeys() {\n    // Select all\n    this.app.keyCommand.addShortcut('Control+a', () => {\n      this.selectAll()\n    })\n    // Resetting scaling\n    this.app.keyCommand.addShortcut('Control+0', () => {\n      this.setZoom(1)\n    })\n    // Delete the currently active graphic object\n    this.app.keyCommand.addShortcut('Del|Backspace', () => {\n      this.deleteCurrentNodes()\n    })\n    // Copying graphic objects\n    this.app.keyCommand.addShortcut('Control+c', () => {\n      this.copyCurrentNode()\n    })\n    // Cutting graphic objects\n    this.app.keyCommand.addShortcut('Control+x', () => {\n      this.cutCurrentNode()\n    })\n    // Withdrawn\n    this.app.keyCommand.addShortcut('Control+z', () => {\n      this.app.history.undo()\n    })\n    // Show or hide the grid\n    this.app.keyCommand.addShortcut(\"Control+'\", () => {\n      if (this.app.state.showGrid) {\n        this.app.grid.hideGrid()\n      } else {\n        this.app.grid.showGrid()\n      }\n    })\n    // Redo\n    this.app.keyCommand.addShortcut('Control+y', () => {\n      this.app.history.redo()\n    })\n    // Paste graphic objects\n    this.app.keyCommand.addShortcut('Control+v', () => {\n      this.pasteCurrentNode(true)\n    })\n  }\n\n  // Copy the currently active or selected graphic object\n  copyCurrentNode() {\n    if (this.app.nodes.activeNode) {\n      this.beingCopySelectedNodes = []\n      this.beingCopyNode = this.app.nodes.activeNode\n    } else if (this.app.selection.hasSelectionNodes()) {\n      this.beingCopyNode = undefined\n      this.beingCopySelectedNodes = this.app.selection.getSelectionNodes()\n    }\n  }\n\n  // Cuts the currently active or selected graphic object\n  cutCurrentNode() {\n    if (this.app.nodes.activeNode) {\n      this.copyCurrentNode()\n      this.deleteCurrentNodes()\n    } else if (this.app.selection.hasSelectionNodes()) {\n      this.copyCurrentNode()\n      this.deleteCurrentNodes()\n      this.app.selection.setMultiplexSelectNodes(this.beingCopySelectedNodes)\n      this.app.selection.emitChange()\n    }\n  }\n\n  // Paste the copied or cut graphic object\n  pasteCurrentNode(useCurrentEventPos = false) {\n    let pos = null\n    if (useCurrentEventPos) {\n      const { x } = this.app.event.lastMousePos\n      const { y } = this.app.event.lastMousePos\n      pos = {\n        x,\n        y\n      }\n    }\n    if (this.beingCopyNode) {\n      this.copyNode(this.beingCopyNode, false, pos as any).then(() => {})\n    } else if (this.beingCopySelectedNodes.length > 0) {\n      this.app.selection.copySelectionNodes(useCurrentEventPos ? pos : null)\n    }\n  }\n\n  // Deleting graphic objects\n  deleteNode(node: any) {\n    this.app.nodes.deleteNode(node)\n    this.render()\n    this.app.emitChange()\n  }\n\n  // Copy and paste graphic objects\n  async copyNode(node: any, notActive?: boolean, pos?: { x: any; y: any }) {\n    this.app.nodes.cancelActiveNode()\n    await this.app.nodes.copyNode(node, notActive, pos)\n    this.render()\n    this.app.emitChange()\n  }\n\n  // Delete the currently active graphic object\n  deleteActiveNode() {\n    if (!this.app.nodes.hasActiveNode()) {\n      return\n    }\n    this.deleteNode(this.app.nodes.activeNode)\n  }\n\n  // Delete the currently active or selected graphic object\n  deleteCurrentNodes() {\n    this.deleteActiveNode()\n    this.app.selection.deleteSelectedNodes()\n  }\n\n  // Cancel the currently active graphic object\n  cancelActiveNode() {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.cancelActiveNode()\n    this.render()\n    return this\n  }\n\n  // Update the position of the currently active graphic object\n  updateActiveNodePosition(x: number, y: number) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.activeNode.updatePos(x, y)\n    this.render()\n    return this\n  }\n\n  // Update the size of the currently active graphic object\n  updateActiveNodeSize(width: number, height: number) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.activeNode.updateSize(width, height)\n    this.render()\n    return this\n  }\n\n  // Update the rotation angle of the currently active graphic object\n  updateActiveNodeRotate(rotate: number) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.activeNode.updateRotate(rotate)\n    this.render()\n    return this\n  }\n\n  // Emptying a graphic object\n  empty() {\n    this.app.nodes.deleteAllNodes()\n    this.render()\n    this.app.emitChange()\n  }\n\n  // Enlarge\n  zoomIn(num = 0.1) {\n    if (this.app.state.scale) {\n      this.app.updateState({\n        scale: this.app.state.scale + num\n      } as any)\n      this.render()\n      this.app.emit('zoomChange', this.app.state.scale)\n    }\n  }\n\n  // Reduction\n  zoomOut(num = 0.1) {\n    if (this.app.state.scale) {\n      this.app.updateState({\n        scale: this.app.state.scale - num > 0 ? this.app.state.scale - num : 0\n      } as any)\n      this.render()\n      this.app.emit('zoomChange', this.app.state.scale)\n    }\n  }\n\n  // Set the specified zoom value\n  setZoom(zoom: number) {\n    if (zoom < 0 || zoom > 1) {\n      return\n    }\n    this.app.updateState({\n      scale: zoom\n    } as any)\n    this.render()\n    this.app.emit('zoomChange', this.app.state.scale)\n  }\n\n  // Scaling to fit all graphic objects\n  fit() {\n    if (!this.app.nodes.hasNodes()) {\n      return\n    }\n    this.scrollToCenter()\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.app.nodes.nodeList\n    )\n    const width = maxX - minX\n    const height = maxY - minY\n    const maxScale = Math.min(this.app.width / width, this.app.height / height)\n    this.setZoom(maxScale)\n  }\n\n  // Scroll to the specified position\n  scrollTo(scrollX: number, scrollY: number) {\n    this.app.updateState({\n      scrollX,\n      scrollY\n    } as any)\n    this.render()\n    this.app.emit(\n      'scrollChange',\n      this.app.state.scrollX,\n      this.app.state.scrollY\n    )\n  }\n\n  // Scroll to centre, i.e. back to the centre of all graphic objects\n  scrollToCenter() {\n    if (!this.app.nodes.hasNodes()) {\n      this.scrollTo(0, 0)\n      return\n    }\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.app.nodes.nodeList\n    )\n    const width = maxX - minX\n    const height = maxY - minY\n    this.scrollTo(\n      minX - (this.app.width - width) / 2,\n      minY - (this.app.height - height) / 2\n    )\n  }\n\n  // Copy and paste the current graphic object\n  copyPasteCurrentNodes() {\n    this.copyCurrentNode()\n    this.pasteCurrentNode()\n  }\n\n  // Set the background colour\n  setBackgroundColor(color: string) {\n    this.app.updateState({\n      backgroundColor: color\n    } as any)\n    this.app.background.set()\n  }\n\n  // Select all graphic objects\n  selectAll() {\n    this.app.selection.selectNodes(this.app.nodes.nodeList)\n  }\n}\n","import { AppObject } from '../../types'\n\nexport default class Calculate {\n  private readonly app: AppObject\n\n  constructor(app: AppObject) {\n    this.app = app\n  }\n\n  // Conversion of screen coordinates to canvas coordinates\n  transformToCanvasCalculate(x: number, y: number) {\n    x -= this.app.width / 2\n    y -= this.app.height / 2\n    return {\n      x,\n      y\n    }\n  }\n\n  // Object position attached to grid\n  gridAdsorbent(x: number, y: number) {\n    const { gridConfig, showGrid } = this.app.state\n    if (typeof gridConfig === 'undefined') {\n      return {}\n    }\n    if (!showGrid) {\n      return {\n        x,\n        y\n      }\n    }\n    const gridSize = gridConfig.size\n    if (typeof gridSize === 'undefined') {\n      return {}\n    }\n    return {\n      x: x - (x % gridSize),\n      y: y - (y % gridSize)\n    }\n  }\n\n  // Add vertical scroll distance\n  addScrollY(y: number) {\n    if (typeof this.app.state.scrollY === 'undefined') {\n      return 0\n    }\n    return this.app.state.scrollY + y\n  }\n\n  // Add horizontal scroll distance\n  addScrollX(x: number) {\n    if (typeof this.app.state.scrollX === 'undefined') {\n      return 0\n    }\n    return this.app.state.scrollX + x\n  }\n\n  // minus vertical scroll distance\n  subScrollY(y: number) {\n    if (typeof this.app.state.scrollY === 'undefined') {\n      return 0\n    }\n    return y - this.app.state.scrollY\n  }\n\n  // minus horizontal rolling distance\n  subScrollX(x: number) {\n    if (typeof this.app.state.scrollX === 'undefined') {\n      return 0\n    }\n    return x - this.app.state.scrollX\n  }\n\n  // Canvas conversion to screen coordinates\n  transformToScreenCalculate(x: number, y: number) {\n    x += this.app.width / 2\n    y += this.app.height / 2\n    return {\n      x,\n      y\n    }\n  }\n\n  // Integrated conversion, screen coordinates to canvas coordinates minus scroll values\n  transform(x: number, y: number) {\n    const t = this.transformToCanvasCalculate(x, y)\n    return {\n      x: this.subScrollX(t.x),\n      y: this.subScrollY(t.y)\n    }\n  }\n\n  // For when the container is not full screen, convert coordinates relative to the container to relative to the window\n  mountELToWindow(x: number, y: number) {\n    return {\n      x: x + this.app.left,\n      y: y + this.app.top\n    }\n  }\n\n  // For when the container is not full screen, Convert coordinates relative to the window to relative to the container\n  windowToContainer(x: number, y: number) {\n    return {\n      x: x - this.app.left,\n      y: y - this.app.top\n    }\n  }\n\n  // The position of the screen coordinates after applying canvas scaling\n  scale(x: number, y: number) {\n    const { state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return {}\n    }\n    const wp = this.transformToCanvasCalculate(x, y)\n    const sp = this.transformToScreenCalculate(\n      wp.x * state.scale,\n      wp.y * state.scale\n    )\n    return {\n      x: sp.x,\n      y: sp.y\n    }\n  }\n\n  // The position of the screen coordinates after applying the canvas zoom in reverse\n  reverseScale(x: number, y: number) {\n    const { state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return {}\n    }\n    const tp = this.transformToCanvasCalculate(x, y)\n    const sp = this.transformToScreenCalculate(\n      tp.x / state.scale,\n      tp.y / state.scale\n    )\n    return {\n      x: sp.x,\n      y: sp.y\n    }\n  }\n}\n","import {\n  getMultiplexNodeRectInfo,\n  getNodeCenterCoordinate,\n  getTowCoordinateRotate\n} from '../common/utils'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { AppObject, Node, NodeArray } from '../types'\n\nexport default class MultiplexSelectNode extends BaseNode {\n  selectedNodeList: NodeArray\n\n  public wholeCenterPos: { x: number; y: number }\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this as any, this.app)\n\n    this.selectedNodeList = []\n\n    this.wholeCenterPos = { x: 0, y: 0 }\n  }\n\n  // Filtering out deleted graphic objects\n  updateNodes(nodes: NodeArray) {\n    const exists: NodeArray = []\n    this.selectedNodeList.forEach((node) => {\n      if (nodes.includes(node)) {\n        exists.push(node)\n      }\n    })\n    this.setSelectedNodeList(exists)\n  }\n\n  // Calculate size and position\n  // @ts-ignore\n  updateRect() {\n    if (this.selectedNodeList.length <= 0) {\n      super.updateRect(0, 0, 0, 0)\n      return\n    }\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.selectedNodeList\n    )\n    super.updateRect(minX, minY, maxX - minX, maxY - minY)\n  }\n\n  // In adjustment\n  // @ts-ignore\n  resize(...args: any) {\n    this.selectedNodeList.forEach((node: Node) => {\n      if (node.dragNode && node.dragNode.resizeType === 'rotate') {\n        // 旋转操作特殊处理\n        this.handleRotate(node, ...args)\n      } else {\n        node?.resize?.(...args)\n      }\n    })\n  }\n\n  // Rotating graphic objects\n  handleRotate(node: Node, e?: any, mx?: number, my?: number) {\n    const rotate = getTowCoordinateRotate(\n      this.wholeCenterPos.x,\n      this.wholeCenterPos.y,\n      e.clientX,\n      e.clientY,\n      <number>mx,\n      <number>my\n    )\n    node.rotateByCenter?.(rotate, this.wholeCenterPos.x, this.wholeCenterPos.y)\n  }\n\n  // End of adjustment\n  // @ts-ignore\n  endResize() {\n    this.selectedNodeList.forEach((node) => {\n      node.endResize?.()\n    })\n  }\n\n  // Set the selected graphic object list\n  setSelectedNodeList(list: NodeArray) {\n    this.selectedNodeList.forEach((node) => {\n      node.isSelected = false\n    })\n    this.selectedNodeList = list\n    this.selectedNodeList.forEach((node) => {\n      node.isSelected = true\n    })\n  }\n\n  // Start of adjustment\n  // @ts-ignore\n  startResize(...args: any) {\n    this.selectedNodeList.forEach((node) => {\n      if (args[0] === 'rotate') {\n        // 计算多选图形对象整体中心坐标\n        this.wholeCenterPos = getNodeCenterCoordinate(this as any)\n      }\n      node.startResize?.(...args)\n    })\n  }\n\n  render() {\n    if (this.width && this.height && this.selectedNodeList.length > 0) {\n      if (this.width <= 0 || this.height <= 0) {\n        return\n      }\n      this.dragNode.render()\n    }\n  }\n}\n","import { DRAG_NODE_PARTS } from '../common/constants'\nimport { getBoundingRect, throttle } from '../common/utils'\nimport Calculate from '../common/utils/Calculate'\nimport MultiplexSelectNode from '../components/MultiplexSelectNode'\nimport Rectangle from '../components/Rectangle'\nimport Canvas from '../support/Canvas'\nimport { AppObject, Ctx, Node, NodeArray, State } from '../types'\n\nexport default class Selection {\n  public app: AppObject\n\n  public canvas: any\n\n  public ctx: Ctx | undefined\n\n  public createSelection: boolean\n\n  hasSelection: boolean\n\n  public isResize: boolean\n\n  public state: State\n\n  public width: number\n\n  public height: number\n\n  public calculate: Calculate\n\n  public rectangle: Rectangle\n\n  public multiplexSelectNode: MultiplexSelectNode\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.canvas = null\n\n    this.ctx = undefined\n\n    // Is a selection currently being created\n    this.createSelection = false\n\n    // Whether there is currently a multiple selection of graphic objects\n    this.hasSelection = false\n\n    // Whether the selected graphic object is currently being adjusted\n    this.isResize = false\n\n    this.state = this.app.state\n\n    this.width = this.app.width\n\n    this.height = this.app.height\n\n    this.calculate = new Calculate(this as unknown as AppObject)\n\n    // Selection Rectangle\n    this.rectangle = new Rectangle(\n      {\n        type: 'rectangle',\n        style: {\n          strokeStyle: 'rgba(9,132,227,0.3)',\n          fillStyle: 'rgba(9,132,227,0.3)'\n        }\n      } as any,\n      this as any\n    )\n\n    // Virtual graphic object of the selected graphic object for displaying the drag and drop box\n    this.multiplexSelectNode = new MultiplexSelectNode(\n      {\n        type: 'multiplexSelectNode'\n      } as any,\n      this as any\n    )\n\n    // @ts-ignore\n    this.checkInNodes = throttle(this.checkInNodes, this, 20)\n\n    // A little relief from lag\n    this.handleResize = throttle(this.handleResize, this as any, 15)\n\n    this.init()\n\n    this.bindEvent()\n  }\n\n  // Detection of nodes in the selection\n  checkInNodes(e: any, event: any) {\n    const minX = Math.min(event.mousedownPos.x, e.clientX)\n    const minY = Math.min(event.mousedownPos.y, e.clientY)\n    const maxX = Math.max(event.mousedownPos.x, e.clientX)\n    const maxY = Math.max(event.mousedownPos.y, e.clientY)\n    const selectedNodeList: any[] | undefined = []\n    this.app.nodes.nodeList.forEach((node: Node) => {\n      let _minX = Infinity\n      let _maxX = -Infinity\n      let _minY = Infinity\n      let _maxY = -Infinity\n      const endCoordinateList = node?.getEndCoordinateList?.()\n      const rect: any = getBoundingRect(\n        endCoordinateList.map((coordinate: { x: number; y: number }) => [\n          coordinate.x,\n          coordinate.y\n        ]),\n        true\n      )\n      rect.forEach(({ x, y }: any) => {\n        if (x < _minX) {\n          _minX = x\n        }\n        if (x > _maxX) {\n          _maxX = x\n        }\n        if (y < _minY) {\n          _minY = y\n        }\n        if (y > _maxY) {\n          _maxY = y\n        }\n      })\n      if (_minX >= minX && _maxX <= maxX && _minY >= minY && _maxY <= maxY) {\n        selectedNodeList.push(node)\n      }\n    })\n    this.setMultiplexSelectNodes(selectedNodeList, true)\n    this.app.render.render()\n  }\n\n  // Detects if the specified position is on the graphic object adjustment handle\n  checkInResizeHand(x: any, y: any) {\n    return this.multiplexSelectNode.dragNode.checkCoordinateInDragNodeWhere(\n      x,\n      y\n    )\n  }\n\n  // Delete the currently selected graphic object\n  deleteSelectedNodes() {\n    this.getSelectionNodes().forEach((node: Node) => {\n      this.app.nodes.deleteNode(node)\n    })\n    this.selectNodes([])\n    this.app.emitChange()\n  }\n\n  // Whether the selected graphic object currently exists\n  hasSelectionNodes() {\n    return this.getSelectionNodes().length > 0\n  }\n\n  // Get the currently selected graphic object\n  getSelectionNodes() {\n    return this.multiplexSelectNode.selectedNodeList\n  }\n\n  // Copy the currently selected graphic objects\n  async copySelectionNodes(pos: { x: number; y: number }) {\n    const task = this.getSelectionNodes().map((node) =>\n      this.app.nodes.copyNode(node, true)\n    )\n    const nodes = await Promise.all(task)\n    this.setMultiplexSelectNodes(nodes)\n    // Paste to the specified location\n    if (pos) {\n      this.multiplexSelectNode.startResize(DRAG_NODE_PARTS.BODY)\n      if (\n        !this.multiplexSelectNode.x ||\n        !this.multiplexSelectNode.y ||\n        !this.multiplexSelectNode.width ||\n        !this.multiplexSelectNode.height\n      ) {\n        // eslint-disable-next-line no-console\n        console.error('multiplexSelectNode x or y or width or height is null')\n        return\n      }\n      const ox =\n        pos.x - this.multiplexSelectNode.x - this.multiplexSelectNode.width / 2\n      const oy =\n        pos.y - this.multiplexSelectNode.y - this.multiplexSelectNode.height / 2\n      // If the grid is turned on, then the coordinates are to be attached to the grid\n      const gridAdsorbentPos = this.app.calculate.gridAdsorbent(ox, oy)\n      this.multiplexSelectNode.resize(\n        null,\n        null,\n        null,\n        gridAdsorbentPos.x,\n        gridAdsorbentPos.y\n      )\n      this.multiplexSelectNode.endResize()\n      this.multiplexSelectNode.updateRect()\n    }\n    this.app.render.render()\n    this.renderSelection()\n    this.app.emitChange()\n  }\n\n  // Check if a graphic object adjustment operation is required\n  checkIsResize(x: number, y: number, e: any) {\n    if (!this.hasSelection) {\n      return false\n    }\n    const hand =\n      this.multiplexSelectNode.dragNode.checkCoordinateInDragNodeWhere(x, y)\n    if (hand) {\n      this.isResize = true\n      this.multiplexSelectNode.startResize(hand, e)\n      this.app.cursor.setResize(hand)\n      return true\n    }\n    return false\n  }\n\n  // Performing graphic object adjustment operations\n  handleResize(...args: any[]) {\n    if (!this.isResize) {\n      return\n    }\n    this.multiplexSelectNode.resize(...args)\n    this.app.render.render()\n    this.multiplexSelectNode.updateRect()\n    this.renderSelection()\n  }\n\n  // Ending a graphic object adjustment operation\n  endResize() {\n    this.isResize = false\n    this.multiplexSelectNode.endResize()\n  }\n\n  // Styling of multi-selected graphic objects\n  setSelectedNodeStyle(style = {}) {\n    if (!this.hasSelectionNodes()) {\n      return\n    }\n    Object.keys(style).forEach((key) => {\n      this.getSelectionNodes().forEach((node) => {\n        // @ts-ignore\n        node.style[key] = style[key]\n      })\n    })\n    this.app.render.render()\n    this.app.emitChange()\n  }\n\n  // Select the specified graphic object\n  selectNodes(nodes = []) {\n    this.hasSelection = nodes.length > 0\n    this.setMultiplexSelectNodes(nodes)\n    this.app.render.render()\n    this.renderSelection()\n    this.emitChange()\n  }\n\n  cancelSelectNodes() {\n    this.selectNodes([])\n  }\n\n  // Set the selected graphic object\n  setMultiplexSelectNodes(nodes: NodeArray = [], notUpdateRect?: boolean) {\n    this.multiplexSelectNode.setSelectedNodeList(nodes)\n    if (!notUpdateRect) {\n      this.multiplexSelectNode.updateRect()\n    }\n  }\n\n  emitChange() {\n    this.app.emit('multiplexSelectChange', this.getSelectionNodes())\n  }\n\n  bindEvent() {\n    this.app.on('change', () => {\n      this.state = this.app.state\n      this.multiplexSelectNode.updateNodes(this.app.nodes.nodeList)\n      this.renderSelection()\n    })\n    this.app.on('scrollChange', () => {\n      this.renderSelection()\n    })\n    this.app.on('zoomChange', () => {\n      this.renderSelection()\n    })\n  }\n\n  onMousedown(\n    e: { originEvent: { which: number } },\n    event: { mousedownPos: { x: number; y: number } }\n  ) {\n    if (e.originEvent.which !== 1) {\n      return\n    }\n    this.createSelection = true\n    this.rectangle.updatePos(event.mousedownPos.x, event.mousedownPos.y)\n  }\n\n  onMousemove(e: number, event: { mouseOffset: { x: number; y: number } }) {\n    if (\n      Math.abs(event.mouseOffset.x) <= 10 &&\n      Math.abs(event.mouseOffset.y) <= 10\n    ) {\n      return\n    }\n    this.onMove(e, event)\n  }\n\n  onMouseup() {\n    this.createSelection = false\n    this.rectangle.updateRect(0, 0, 0, 0)\n    // 判断是否有图形对象被选中\n    this.hasSelection = this.hasSelectionNodes()\n    this.multiplexSelectNode.updateRect()\n    this.renderSelection()\n    this.emitChange()\n  }\n\n  // Mouse movement events\n  onMove(e: number, event: { mouseOffset: { x: number; y: number } }) {\n    this.rectangle.updateSize(event.mouseOffset.x, event.mouseOffset.y)\n    this.renderSelection()\n    this.checkInNodes(e, event)\n  }\n\n  reset() {\n    this.setMultiplexSelectNodes([])\n    this.hasSelection = false\n    this.renderSelection()\n    this.emitChange()\n  }\n\n  renderSelection() {\n    this.canvas.clearCanvas()\n    this.ctx?.save()\n    if (this.app.state.scale) {\n      this.ctx?.scale(this.app.state.scale, this.app.state.scale)\n    }\n    this.rectangle.render()\n    this.multiplexSelectNode.render()\n    this.ctx?.restore()\n  }\n\n  init() {\n    if (this.canvas) {\n      this.app.mountEL.removeChild(this.canvas.el)\n    }\n    this.width = this.app.width\n    this.height = this.app.height\n    this.canvas = new Canvas(this.width, this.height, {\n      className: 'selection'\n    })\n    this.ctx = this.canvas.ctx\n    this.app.mountEL.appendChild(this.canvas.el)\n  }\n}\n","import EventEmitter from 'eventemitter3'\n\nimport { getFontString, getTextNodeSize } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class TextEdit extends EventEmitter {\n  private readonly app: AppObject\n\n  private editable: undefined | HTMLTextAreaElement\n\n  isEditing: boolean\n\n  constructor(app: AppObject) {\n    super()\n    this.app = app\n    this.editable = undefined\n    this.isEditing = false\n    this.onTextInput = this.onTextInput.bind(this)\n    this.onTextBlur = this.onTextBlur.bind(this)\n  }\n\n  // Show text edit box\n  showTextEdit() {\n    if (!this.editable) {\n      this.crateTextInputEl()\n    } else {\n      this.editable.style.display = 'block'\n    }\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    this.updateTextInputStyle()\n    this.editable.focus()\n    this.editable.select()\n    this.isEditing = true\n  }\n\n  // Text input events\n  onTextInput() {\n    const { activeNode } = this.app.nodes\n    if (!activeNode) {\n      return\n    }\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    activeNode.text = this.editable.value\n    const { width, height } = getTextNodeSize(activeNode)\n    activeNode.width = width\n    activeNode.height = height\n    this.updateTextInputStyle()\n  }\n\n  // Text box out-of-focus event\n  onTextBlur() {\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    this.editable.style.display = 'none'\n    this.editable.value = ''\n    this.emit('blur')\n    this.isEditing = false\n  }\n\n  // Create text input box graphic objects\n  crateTextInputEl() {\n    this.editable = document.createElement('textarea')\n    this.editable.dir = 'auto'\n    this.editable.tabIndex = 0\n    this.editable.wrap = 'off'\n    this.editable.className = 'textInput'\n    Object.assign(this.editable.style, {\n      position: 'fixed',\n      display: 'block',\n      minHeight: '1em',\n      backfaceVisibility: 'hidden',\n      margin: 0,\n      padding: 0,\n      border: 0,\n      outline: 0,\n      resize: 'none',\n      background: 'transparent',\n      overflow: 'hidden',\n      whiteSpace: 'pre'\n    })\n    this.editable.addEventListener('input', this.onTextInput)\n    this.editable.addEventListener('blur', this.onTextBlur)\n    document.body.appendChild(this.editable)\n  }\n\n  // Update the style of the text input box according to the style of the current text graphic object\n  updateTextInputStyle() {\n    const { activeNode } = this.app.nodes\n    if (!activeNode) {\n      return\n    }\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    let { x, y }: any = activeNode\n    const { width, height, style, text, rotate }: any = activeNode\n    const { calculate, state } = this.app\n    this.editable.value = text\n    x = calculate.subScrollX(x)\n    y = calculate.subScrollY(y)\n    if (typeof state.scale === 'undefined') {\n      return\n    }\n    // Screen coordinates to canvas coordinates\n    const sp = calculate.scale(x, y)\n    const tp = calculate.mountELToWindow(sp.x, sp.y)\n    const fontSize = style.fontSize * state.scale\n    const styles = {\n      font: getFontString(fontSize, style.fontFamily),\n      lineHeight: `${fontSize * style.lineHeightRatio}px`,\n      left: `${tp.x}px`,\n      top: `${tp.y}px`,\n      color: style.fillStyle,\n      width: `${Math.max(width, 100) * state.scale}px`,\n      height: `${height * state.scale}px`,\n      transform: `rotate(${rotate}deg)`,\n      opacity: style.globalAlpha\n    }\n    Object.assign(this.editable.style, styles)\n  }\n}\n","import {\n  DiffNodesRes,\n  DiffStateRes,\n  LocalData,\n  NodeArray,\n  State\n} from '../../types'\n\n// Depth-first traversal based on key to determine if equal\nexport function isEqual(oldData: any, nowData: any) {\n  if (typeof oldData !== typeof nowData) {\n    return false\n  }\n  if (typeof oldData !== 'object') {\n    return oldData === nowData\n  }\n  const oldKeys = Object.keys(oldData)\n  const nowKeys = Object.keys(nowData)\n  if (oldKeys.length !== nowKeys.length) {\n    return false\n  }\n  for (let i = 0; i < oldKeys.length; i += 1) {\n    const key = oldKeys[i]\n    if (!isEqual(oldData[key], nowData[key])) {\n      return false\n    }\n  }\n  return true\n}\n\n// diff nodes\nexport function getDiffData(\n  oldData: LocalData | undefined,\n  nowData: LocalData\n) {\n  const isUNOld = typeof oldData === 'undefined'\n  const isUNNow = typeof nowData === 'undefined'\n\n  if (isUNOld && isUNNow) {\n    return undefined\n  }\n  if (isUNOld) {\n    return {\n      type: 'cover-all',\n      nodes: nowData.nodes\n    }\n  }\n\n  if (isUNNow || (isUNOld && nowData.nodes.length === 0)) {\n    return {\n      type: 'delete-all'\n    }\n  }\n\n  if (isEqual(oldData.nodes, nowData.nodes)) {\n    return undefined\n  }\n  const oldNodes = oldData.nodes || []\n  const nowNodes = nowData.nodes || []\n  const oldLen = oldNodes.length\n  const nowLen = nowNodes.length\n  // Add｜Delete Operation\n  const isAdd = nowLen > oldLen\n  const isDelete = nowLen < oldLen\n  if (isAdd || isDelete) {\n    const ANodes = isAdd ? nowNodes : oldNodes\n    const PIDs = isAdd\n      ? oldNodes.map((item) => item.id)\n      : nowNodes.map((item) => item.id)\n    let diffNodes = ANodes.filter((item) => !PIDs.includes(item.id))\n    if (isDelete) {\n      diffNodes = diffNodes.map((item) => ({ id: item.id })) as any\n    }\n    return {\n      type: isAdd ? 'add' : 'delete',\n      nodes: diffNodes\n    }\n  }\n  if (nowLen === oldLen) {\n    const updateNodes = []\n    // Determine which attributes have changed and store those that have changed, but not those that have not\n    for (let i = 0; i < nowLen; i += 1) {\n      if (!isEqual(oldNodes[i], nowNodes[i])) {\n        if ('coordinateArr' in nowNodes[i] || 'coordinateArr' in oldNodes[i]) {\n          break\n        }\n        const diff: any = {}\n        Object.keys(nowNodes[i]).forEach((key) => {\n          // @ts-ignore\n          if (!isEqual(oldNodes[i][key], nowNodes[i][key])) {\n            // @ts-ignore\n            diff[key] = nowNodes[i][key]\n          }\n        })\n        diff.id = nowNodes[i].id\n        updateNodes.push(diff)\n      }\n    }\n    if (updateNodes.length > 0) {\n      return {\n        type: 'update',\n        nodes: updateNodes\n      }\n    }\n  }\n  return undefined\n}\n\nexport function parseDiffNodes(\n  oldNodes: NodeArray,\n  { type, nodes }: DiffNodesRes\n): NodeArray {\n  const fns = {\n    add: () => {\n      oldNodes.push(...nodes)\n    },\n    delete: () => {\n      nodes.forEach((item) => {\n        const index = oldNodes.findIndex((node) => node.id === item.id)\n        oldNodes.splice(index, 1)\n      })\n    },\n    update: () => {\n      nodes.forEach((item) => {\n        const index = oldNodes.findIndex((node) => node.id === item.id)\n        oldNodes[index] = { ...oldNodes[index], ...item }\n      })\n    },\n    'cover-all': () => {\n      oldNodes.splice(0, oldNodes.length, ...nodes)\n    },\n    'delete-all': () => {\n      oldNodes.splice(0, oldNodes.length)\n    }\n  }\n  fns[type]()\n  return oldNodes\n}\n\n// diff state att: ( backgroundColor / showGrid / showGrid )\nexport function getDiffState(\n  oldData: LocalData | undefined,\n  nowData: LocalData\n) {\n  const oldState = oldData?.state\n  if (typeof oldState === 'undefined') {\n    return undefined\n  }\n  const nowState = nowData?.state\n  const isDiffBac = oldState.backgroundColor !== nowState.backgroundColor\n  const isDiffGrid = oldState.showGrid !== nowState.showGrid\n  const isDiffReadonly = oldState.readonly !== nowState.readonly\n  const isDiffScrollY = oldState.scrollY !== nowState.scrollY\n  const isDiffScrollX = oldState.scrollX !== nowState.scrollX\n  const isDiffScale = oldState.scale !== nowState.scale\n\n  if (isDiffBac || isDiffGrid || isDiffReadonly) {\n    const state: any = {}\n    if (isDiffBac) {\n      state.backgroundColor = nowState.backgroundColor\n    }\n    if (isDiffGrid) {\n      state.showGrid = nowState.showGrid\n    }\n    if (isDiffReadonly) {\n      state.readonly = nowState.readonly\n    }\n    if (isDiffScrollY) {\n      state.scrollY = nowState.scrollY\n    }\n    if (isDiffScrollX) {\n      state.scrollX = nowState.scrollX\n    }\n    if (isDiffScale) {\n      state.scale = nowState.scale\n    }\n    return {\n      type: 'update-state',\n      state\n    }\n  }\n  return undefined\n}\n\nexport function parseDiffState(oldState: State, { state }: DiffStateRes) {\n  Object.keys(state).forEach((key) => {\n    // @ts-ignore\n    oldState[key] = state[key]\n  })\n  return oldState\n}\n","import EventEmitter from 'eventemitter3'\n\nimport Author from './classFile/Author'\nimport Background from './classFile/Background'\nimport Cursor from './classFile/Cursor'\nimport Event from './classFile/Event'\nimport Export from './classFile/Export'\nimport Grid from './classFile/Grid'\nimport History from './classFile/History'\nimport ImageEdit from './classFile/ImageEdit'\nimport KeyCommand from './classFile/KeyCommand'\nimport Nodes from './classFile/Nodes'\nimport Render from './classFile/Render'\nimport Selection from './classFile/Selection'\nimport TextEdit from './classFile/TextEdit'\nimport {\n  createCanvas,\n  createImageObj,\n  getTowCoordinateDistance,\n  throttle\n} from './common/utils'\nimport Calculate from './common/utils/Calculate'\nimport {\n  getDiffData,\n  getDiffState,\n  parseDiffNodes,\n  parseDiffState\n} from './common/utils/diffData'\nimport {\n  Ctx,\n  DiffNodesRes,\n  DiffStateRes,\n  LocalData,\n  Node,\n  OnCallBack,\n  PlotType,\n  State\n} from './types'\n\ntype Options = {\n  mountEL: HTMLElement | HTMLDivElement\n  plotType?: PlotType\n  state?: State\n}\n\nclass CreatLoader extends EventEmitter {\n  public options: Options\n\n  public readonly mountEL: HTMLElement | HTMLDivElement\n\n  public plotType: any\n\n  public width: number\n\n  public height: number\n\n  public left: number\n\n  public top: number\n\n  public canvas: HTMLCanvasElement | undefined\n\n  public ctx: Ctx | undefined\n\n  public state: State\n\n  public calculate: Calculate\n\n  public event: Event\n\n  public keyCommand: KeyCommand\n\n  public imageEdit: ImageEdit\n\n  public textEdit: TextEdit\n\n  public cursor: Cursor\n\n  public history: History\n\n  public export: Export\n\n  public background: Background\n\n  public selection: Selection\n\n  public grid: Grid\n\n  public author: Author\n\n  public nodes: any\n\n  public render: Render\n\n  public watch: any\n\n  static utils: any\n\n  static checkClick: any\n\n  static plot: any\n\n  static nodes: any\n\n  public oldData: undefined\n\n  constructor(options: Options) {\n    super()\n\n    this.options = options\n\n    this.mountEL = options.mountEL\n\n    this.plotType = options.plotType || 'selection'\n\n    // Container width and height position information\n    this.width = 0\n    this.height = 0\n    this.left = 0\n    this.top = 0\n\n    // Main rendering canvas graphics objects\n    this.canvas = undefined\n\n    // canvas drawing context\n    this.ctx = undefined\n\n    // Canvas state\n    this.state = {\n      // resizing\n      scale: 1,\n      // Scroll offset in horizontal direction\n      scrollX: 0,\n      // Scroll offset in vertical direction\n      scrollY: 0,\n      // Rolling step\n      scrollStep: 25,\n      // Background colour\n      backgroundColor: '',\n      // Whether to display the grid or not\n      showGrid: false,\n      // Is it read-only mode\n      readonly: false,\n      // Default colour\n      defaultColor: '#000000',\n      // Grid configuration\n      gridConfig: {\n        // Grid size\n        size: 20,\n        // Grid line colours\n        strokeStyle: '#dfe0e1',\n        // Mesh line width\n        lineWidth: 1\n      },\n      // Coverage\n      ...(options.state || {})\n    } as any\n\n    this.initCanvas()\n\n    this.calculate = new Calculate(this as any)\n\n    this.event = new Event(this as any)\n    this.event.on('mousedown', this.onMousedown, this)\n    this.event.on('mousemove', this.onMousemove, this)\n    this.event.on('mouseup', this.onMouseup, this)\n    this.event.on('dblclick', this.onDblclick, this)\n    this.event.on('mousewheel', this.onMousewheel, this)\n    this.event.on('contextmenu', this.onContextmenu, this)\n\n    this.keyCommand = new KeyCommand(this as any)\n\n    this.imageEdit = new ImageEdit(this as any)\n    this.imageEdit.on('imageSelectChange', this.onImageSelectChange, this)\n\n    this.textEdit = new TextEdit(this as any)\n    this.textEdit.on('blur', this.onTextInputBlur, this)\n\n    this.cursor = new Cursor(this as any)\n\n    this.history = new History(this as any)\n\n    this.export = new Export(this as any)\n\n    this.background = new Background(this as any)\n\n    this.selection = new Selection(this as any)\n\n    this.grid = new Grid(this as any)\n\n    this.nodes = new Nodes(this as any)\n\n    this.render = new Render(this as any)\n\n    this.author = new Author(this as any)\n\n    this.mountFunction()\n\n    this.checkIsOnNode = throttle(this.checkIsOnNode, this as any)\n\n    this.emitChange()\n\n    this.helpUpdate()\n\n    this.watch = {\n      zoomChange: (callback: OnCallBack) => this.on('zoomChange', callback),\n      scrollChange: (callback: OnCallBack) => this.on('scrollChange', callback),\n      currentTypeChange: (callback: OnCallBack) =>\n        this.on('currentTypeChange', callback),\n      shuttle: (callback: OnCallBack) => this.on('shuttle', callback),\n      activeNodeChange: (callback: OnCallBack) =>\n        this.on('activeNodeChange', callback),\n      multiplexSelectChange: (callback: OnCallBack) =>\n        this.on('multiplexSelectChange', callback),\n      contextmenu: (callback: OnCallBack) => this.on('contextmenu', callback),\n      diffNodesChange: (callback: OnCallBack) =>\n        this.on('diffNodesChange', callback),\n      diffStateChange: (callback: OnCallBack) =>\n        this.on('diffStateChange', callback),\n      localDataChange: (callback: OnCallBack) => this.on('change', callback),\n      nodeRotateChange: (callback: OnCallBack) =>\n        this.on('nodeRotateChange', callback)\n    }\n  }\n\n  mountFunction() {\n    ;['exportImage', 'exportJson'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.export[method].bind(this.export)\n    })\n    ;['showGrid', 'hideGrid', 'updateGrid'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.grid[method].bind(this.grid)\n    })\n    ;['setEditAuthor', 'setReadonlyAuthor'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.author[method].bind(this.author)\n    })\n    ;['undo', 'redo'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.history[method].bind(this.history)\n    })\n    ;['unBindEvent', 'bindEvent'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.keyCommand[method].bind(this.keyCommand)\n    })\n    ;['setSelectedNodeStyle', 'cancelSelectNodes'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.selection[method].bind(this.selection)\n    })\n    ;[\n      'updateActiveNodeRotate',\n      'updateActiveNodeSize',\n      'updateActiveNodePosition',\n      'cancelActiveNode',\n      'scrollToCenter',\n      'copyPasteCurrentNodes',\n      'empty',\n      'zoomIn',\n      'zoomOut',\n      'setZoom',\n      'selectAll',\n      'fit',\n      'deleteActiveNode',\n      'deleteCurrentNodes',\n      'setBackgroundColor',\n      'copyNode',\n      'copyCurrentNode',\n      'deleteNode',\n      'setActiveNodeStyle',\n      'setCurrentNodesStyle',\n      'scrollTo',\n      'cutCurrentNode',\n      'pasteCurrentNode'\n    ].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.render[method].bind(this.render)\n    })\n  }\n\n  // Access to data, including state data and graphical object data\n  getData() {\n    return {\n      state: {\n        ...this.state\n      },\n      nodes: this.nodes.serialize()\n    }\n  }\n\n  // Image selection events\n  onImageSelectChange() {\n    this.cursor.hide()\n  }\n\n  // Get container size location information\n  getContainerRectInfo() {\n    const { width, height, left, top } = this.mountEL.getBoundingClientRect()\n    this.width = width\n    this.height = height\n    this.left = left\n    this.top = top\n  }\n\n  // Rendering as necessary\n  helpUpdate() {\n    if (this.state.readonly) {\n      // @ts-ignore\n      this.setReadonlyAuthor()\n    }\n    if (this.state.showGrid) {\n      this.grid.showGrid()\n    }\n    this.background.set()\n  }\n\n  // Setting data, including status data and graphic object data\n  async setData(\n    { state = {}, nodes = [] }: any,\n    noEmitChange: boolean,\n    noDiffData?: boolean\n  ) {\n    this.state = state\n\n    const nowNs = nodes.map(async (node: Node) => {\n      if (node.type === 'image') {\n        return {\n          ...node,\n          imageObj: await createImageObj(<string>node.url)\n        }\n      }\n      return node\n    })\n\n    const nNS: any[] = []\n\n    for (const n of nowNs) {\n      // eslint-disable-next-line no-await-in-loop\n      nNS.push(await n)\n    }\n\n    this.helpUpdate()\n    this.nodes.deleteAllNodes().createNodesFromData(nNS)\n    this.render.render()\n    if (!noEmitChange) {\n      this.emitChange(noDiffData)\n    }\n  }\n\n  initCanvas() {\n    this.getContainerRectInfo()\n    if (this.canvas) {\n      this.mountEL.removeChild(this.canvas)\n    }\n    const { canvas, ctx }: any = createCanvas(this.width, this.height, {\n      className: 'main'\n    })\n    this.canvas = canvas\n    this.ctx = ctx\n    this.mountEL.appendChild(this.canvas as any)\n    console.log('a')\n  }\n\n  // Container resizing\n  resize() {\n    this.initCanvas()\n    this.render.render()\n    this.selection.init()\n    this.grid.init()\n    this.grid.renderGrid()\n  }\n\n  // Updating the state data only updates the state data and does not trigger a render\n  updateState(data = {}) {\n    this.state = {\n      ...this.state,\n      ...data\n    }\n    this.emitChange(undefined, true)\n  }\n\n  // Update current drawing type\n  updateCurrentType(plotType: PlotType) {\n    this.plotType = plotType\n    if (this.plotType === 'image') {\n      this.imageEdit.selectImage()\n    }\n    if (this.plotType === 'eraser') {\n      this.cursor.setEraser()\n      // @ts-ignore\n      this.cancelActiveNode()\n    } else if (this.plotType === 'text') {\n      this.cursor.setText()\n    } else if (this.plotType !== 'selection') {\n      this.cursor.setCrossHair()\n    } else {\n      this.cursor.reset()\n    }\n    this.emit('currentTypeChange', this.plotType)\n  }\n\n  // Mouse press event\n  onMousedown(\n    e: {\n      unGridClientX?: number\n      unGridClientY?: number\n      originEvent?: { which: number }\n    },\n    event: { mousedownPos: any }\n  ) {\n    if (this.state.readonly || this.author.isDragAuthor) {\n      this.author.onStart()\n      return\n    }\n    if (!this.nodes.isCreateNode && !this.textEdit.isEditing) {\n      const clickNode = this.nodes.checkIsClickNode(e)\n      if (this.plotType === 'selection') {\n        if (this.nodes.hasActiveNode()) {\n          const isResize = this.nodes.checkIsResize(\n            event.mousedownPos.unGridClientX,\n            event.mousedownPos.unGridClientY,\n            e\n          )\n          if (!isResize) {\n            this.nodes.setActiveNode(clickNode as any)\n            this.render.render()\n          }\n        } else if (this.selection.hasSelection) {\n          const isResize = this.selection.checkIsResize(\n            event.mousedownPos.unGridClientX,\n            event.mousedownPos.unGridClientY,\n            e\n          )\n          if (!isResize) {\n            this.selection.reset()\n            this.nodes.setActiveNode(clickNode as any)\n            this.render.render()\n          }\n        } else if (clickNode) {\n          this.nodes.setActiveNode(clickNode)\n          this.render.render()\n          this.onMousedown(e, event)\n        } else {\n          this.selection.onMousedown(e as any, event)\n        }\n      } else if (this.plotType === 'eraser') {\n        // @ts-ignore\n        this.deleteNode(clickNode)\n      }\n    }\n  }\n\n  // Mouse movement events\n  onMousemove(e: any, event: any) {\n    // TODO : Real-time synchronisation, currently on mouse up, expected to be on mouse over\n    if (this.state.readonly || this.author.isDragAuthor) {\n      if (event.isMousedown) {\n        this.author.onMove(e, event)\n      }\n      return\n    }\n    if (event.isMousedown) {\n      const mx = event.mousedownPos.x\n      const my = event.mousedownPos.y\n      const offsetX = Math.max(event.mouseOffset.x, 0)\n      const offsetY = Math.max(event.mouseOffset.y, 0)\n      if (this.plotType === 'selection') {\n        if (this.selection.isResize) {\n          this.selection.handleResize(\n            e,\n            mx,\n            my,\n            event.mouseOffset.x,\n            event.mouseOffset.y\n          )\n        } else if (this.selection.createSelection) {\n          this.selection.onMousemove(e, event)\n        } else {\n          this.nodes.handleResize(\n            e,\n            mx,\n            my,\n            event.mouseOffset.x,\n            event.mouseOffset.y\n          )\n          this.render.render()\n        }\n      } else if (['rectangle', 'diamond', 'triangle'].includes(this.plotType)) {\n        this.nodes.createRectangleLikeNode(\n          this.plotType,\n          mx,\n          my,\n          offsetX,\n          offsetY\n        )\n        this.render.render()\n      } else if (this.plotType === 'circle') {\n        this.nodes.createCircle(mx, my, e)\n        this.render.render()\n      } else if (this.plotType === 'arbitrary-plot') {\n        this.nodes.createArbitraryPlot(e, event)\n      } else if (this.plotType === 'arrow') {\n        this.nodes.createArrow(mx, my, e)\n        this.render.render()\n      } else if (this.plotType === 'line') {\n        if (getTowCoordinateDistance(mx, my, e.clientX, e.clientY) > 3) {\n          this.nodes.createLine(mx, my, e, true)\n          this.render.render()\n        }\n      }\n    } else if (this.imageEdit.isReady) {\n      this.cursor.hide()\n      this.imageEdit.updatePreviewElPos(\n        e.originEvent.clientX,\n        e.originEvent.clientY\n      )\n    } else if (this.plotType === 'selection') {\n      if (this.nodes.hasActiveNode()) {\n        const handData: any = ''\n        const h = this.nodes.checkInResizeHand(e.unGridClientX, e.unGridClientY)\n        if (h) {\n          this.cursor.setResize(handData.hand)\n        } else {\n          // @ts-ignore\n          this.checkIsOnNode(e)\n        }\n      } else if (this.selection.hasSelection) {\n        const hand = this.selection.checkInResizeHand(\n          e.unGridClientX,\n          e.unGridClientY\n        )\n        if (hand) {\n          this.cursor.setResize(hand)\n        } else {\n          // @ts-ignore\n          this.checkIsOnNode(e)\n        }\n      } else {\n        // @ts-ignore\n        this.checkIsOnNode(e)\n      }\n    } else if (this.plotType === 'line') {\n      this.nodes.createLine(undefined, undefined, e, false, true)\n      this.render.render()\n    }\n  }\n\n  // Detects if a graphic object has been slid over\n  checkIsOnNode(e: { unGridClientX: number; unGridClientY: number }) {\n    const clickNode = this.nodes.checkIsClickNode(e)\n    if (clickNode) {\n      this.cursor.setMove()\n    } else {\n      this.cursor.reset()\n    }\n  }\n\n  // Reset current type to selection mode\n  resetCurrentType() {\n    if (this.plotType !== 'selection') {\n      this.plotType = 'selection'\n      this.emit('currentTypeChange', 'selection')\n    }\n  }\n\n  // Creation of new graphic objects complete\n  completeCreateNewNode() {\n    this.resetCurrentType()\n    this.nodes.completeCreateNode()\n    this.render.render()\n  }\n\n  // Mouse release event\n  onMouseup(e: any) {\n    if (this.state.readonly || this.author.isDragAuthor) {\n      return\n    }\n    if (this.plotType === 'text') {\n      if (!this.textEdit.isEditing) {\n        this.createTextNode(e)\n        this.resetCurrentType()\n      }\n    } else if (this.imageEdit.isReady) {\n      this.nodes.createImage(e, this.imageEdit.imageData as any)\n      this.completeCreateNewNode()\n      this.cursor.reset()\n      this.imageEdit.reset()\n    } else if (this.plotType === 'arrow') {\n      this.nodes.completeCreateArrow(e)\n      this.completeCreateNewNode()\n    } else if (this.plotType === 'line') {\n      this.nodes.completeCreateLine(e, () => {\n        this.completeCreateNewNode()\n      })\n      this.render.render()\n    } else if (this.nodes.isCreateNode) {\n      if (this.plotType === 'arbitrary-plot') {\n        this.nodes.completeCreateNode()\n        this.nodes.setActiveNode()\n      } else {\n        this.completeCreateNewNode()\n      }\n    } else if (this.nodes.isResize) {\n      this.nodes.endResize()\n      this.emitChange()\n    } else if (this.selection.createSelection) {\n      this.selection.onMouseup()\n    } else if (this.selection.isResize) {\n      this.selection.endResize()\n      this.emitChange()\n    }\n  }\n\n  // Double click event\n  onDblclick(e: { unGridClientX: number; unGridClientY: number }) {\n    if (this.plotType === 'line') {\n      this.completeCreateNewNode()\n    } else {\n      const clickNode = this.nodes.checkIsClickNode(e)\n      if (clickNode) {\n        if (clickNode.type === 'text') {\n          this.nodes.editingText(clickNode)\n          this.render.render()\n          this.keyCommand.unBindEvent()\n          this.textEdit.showTextEdit()\n        }\n      } else if (!this.textEdit.isEditing) {\n        // @ts-ignore\n        this.createTextNode(e)\n      }\n    }\n  }\n\n  // Text box out-of-focus event\n  onTextInputBlur() {\n    this.keyCommand.bindEvent()\n    this.nodes.completeEditingText()\n    this.render.render()\n    this.emitChange()\n  }\n\n  // Creating text graphic objects\n  createTextNode(e: { clientX: any; clientY: any }) {\n    this.nodes.createNode({\n      type: 'text',\n      x: e.clientX,\n      y: e.clientY\n    })\n    this.keyCommand.unBindEvent()\n    this.textEdit.showTextEdit()\n  }\n\n  // Mouse scroll event\n  onMousewheel(dir: string) {\n    if (\n      typeof this.state.scrollStep === 'undefined' ||\n      typeof this.state.scale === 'undefined'\n    ) {\n      return\n    }\n    const stepNum = this.state.scrollStep / this.state.scale\n    const step = dir === 'down' ? stepNum : -stepNum\n    // @ts-ignore\n    this.scrollTo(this.state.scrollX, this.state.scrollY + step)\n  }\n\n  // Right-click menu events\n  onContextmenu(e: { originEvent: any }) {\n    let el: any\n    if (this.nodes.hasActiveNode()) {\n      el = [this.nodes.activeNode]\n    } else if (this.selection.hasSelectionNodes()) {\n      el = this.selection.getSelectionNodes()\n    }\n    this.emit('contextmenu', e.originEvent, el)\n  }\n\n  unBindEvent() {\n    this.keyCommand.unBindEvent()\n  }\n\n  bindEvent() {\n    this.keyCommand.bindEvent()\n  }\n\n  emitNodeRotateChange(rotate: number) {\n    this.emit('nodeRotateChange', rotate)\n  }\n\n  // Triggering update events\n  emitChange(noDiffData?: boolean, noHistory?: boolean) {\n    const data = this.getData()\n    const oldData = this.history.now()\n    if (\n      ((typeof oldData === 'undefined' && data.nodes.length !== 0) ||\n        typeof oldData !== 'undefined') &&\n      !noHistory\n    ) {\n      this.history.add(<LocalData>data)\n    }\n    if (!noDiffData) {\n      this.emitDiffNodesChange(oldData, data)\n      this.emitDiffStateChange(oldData, data)\n    }\n    this.emit('change', data)\n  }\n\n  // Customised data object update triggers with diff algorithm processing\n  emitDiffNodesChange(oldData: LocalData, nowData: LocalData) {\n    const diffRes = getDiffData(oldData, nowData)\n    if (typeof diffRes === 'object') {\n      this.emit('diffNodesChange', diffRes)\n    }\n  }\n\n  // Customised data state update triggers with diff algorithm processing\n  emitDiffStateChange(oldData: LocalData, nowData: LocalData) {\n    const diffRes = getDiffState(oldData, nowData)\n    if (typeof diffRes !== 'undefined') {\n      this.emit('diffStateChange', diffRes)\n    }\n  }\n\n  async parseSetDiffData(config: DiffNodesRes | DiffStateRes) {\n    const oldData = this.getData()\n    const newData: any = {}\n    if (config.type === 'update-state') {\n      newData.nodes = oldData.nodes\n      newData.state = parseDiffState(oldData.nodes, config)\n    } else {\n      newData.state = oldData.state\n      newData.nodes = parseDiffNodes(oldData.nodes, config)\n    }\n    await this.setData(newData, false, true)\n  }\n}\n\nexport default CreatLoader\n","import CreatLoader from './API'\nimport { AppResponse, AppState } from './types'\n\nexport default function creatLoader(state: AppState) {\n  function mount(mountEl: string | Object | HTMLElement): AppResponse {\n    // get DOM\n    const el =\n      typeof mountEl === 'string' ? document.querySelector(mountEl) : mountEl\n    // check\n    if (!el || !(el instanceof HTMLElement)) {\n      throw new Error('mountEl is not a HTMLElement !')\n    }\n    if (\n      !['absolute', 'fixed', 'relative'].includes(\n        window.getComputedStyle(<HTMLElement>el).position\n      )\n    ) {\n      throw new Error(\n        'The DOM being mounted needs to be set to absolute/fixed/relative positioning!'\n      )\n    }\n    // init\n    return new CreatLoader({\n      mountEL: el as any,\n      plotType: state.plotType,\n      state\n    }) as unknown as AppResponse\n  }\n  return { mount }\n}\n"],"names":["keyPosit","0","1","2","3","4","5","6","7","8","9","Backspace","Tab","Enter","Shift","Control","Alt","CapsLock","Esc","Space","PageUp","PageDown","End","Home","Insert","Left","Up","Right","Down","Del","NumLock","Cmd","CmdFF","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","`","=","+","-","'","/",".","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CLICK_DISTANCE","FOUR_CORNER","TOP_LEFT","TOP_RIGHT","BOTTOM_RIGHT","BOTTOM_LEFT","DRAG_NODE_PARTS","BODY","ROTATE","TOP_LEFT_BUTTON","TOP_RIGHT_BUTTON","BOTTOM_RIGHT_BUTTON","BOTTOM_LEFT_BUTTON","let","nodeKeyIndex","deepCopy","JSON","parse","stringify","obj","throttle","fn","ctx","time","_timer","args","setTimeout","call","getFontString","fontSize","fontFamily","splitTextLines","text","replace","split","radToDeg","rad","Math","PI","degToRad","deg","createCanvas","width","height","option","noStyle","noTranslate","className","canvas","document","createElement","style","cssText","getContext","translate","getTowCoordinateDistance","x1","y1","x2","y2","sqrt","checkIsAtSegment","dis","dis1","dis2","dis3","max","getCoordinateToLineDistance","abs","A","B","getTowCoordinateRotate","cx","cy","tx","ty","fx","fy","atan2","getRotatedCoordinate","rotate","del","cos","sin","getNodeCenterCoordinate","node","transformCoordinateReverseRotate","rp","transformCoordinateOnNode","center","getNodeFourCornerCoordinate","dir","getBoundingRect","coordinateArr","returnFourCorners","minX","Infinity","maxX","minY","maxY","forEach","coordinate","getNodeRotatedFourCornerCoordinate","dirPos","checkCoordinateIsInRectangle","rx","ry","rw","rh","getMultiplexNodeRectInfo","nodeList","length","getEndCoordinateList","textCheckEl","getTextActWidth","position","left","body","appendChild","innerText","getBoundingClientRect","createImageObj","Promise","img","Image","setAttribute","onload","resolve","onerror","src","url","getTextNodeSize","textArr","maxWidth","textRow","lineHeightRatio","Author","app","startScrollX","startScrollY","isDragAuthor","constructor","this","onMove","bindEvent","onStart","state","scrollX","scrollY","event","scale","scrollTo","mouseOffset","originX","originY","on","keyCode","cursor","set","setEditAuthor","updateState","readonly","setReadonlyAuthor","cancelActiveNode","Background","backgroundColor","addBackgroundColor","remove","mountEL","canvasAddBackgroundColor","save","rect","fillStyle","fill","restore","Cursor","currentType","type","setEraser","setText","setMove","hide","reset","setCrossHair","setResize","direction","Event","EventEmitter","calculate","lastMousePos","mouseDistance","lastMouseTime","mouseDuration","mouseSpeed","isMousedown","mousedownPos","super","Date","now","unGridClientX","unGridClientY","originClientX","originClientY","onMousedown","bind","onMousemove","onMouseup","onDblclick","onMousewheel","onKeydown","onKeyup","onContextmenu","transformEvent","emit","originEvent","wheelDelta","stopPropagation","preventDefault","clientX","clientY","curTime","wp","windowToContainer","reverseScale","addScrollX","addScrollY","gp","gridAdsorbent","addEventListener","window","unbindEvent","removeEventListener","Export","openPreview","saveState","exportJson","getData","render","onlySelected","getNodeList","cacheActive","cacheSelected","noRender","isActive","isSelected","saveAppState","exportImage","renderBg","useBlob","paddingX","paddingY","show","changeAppState","recoveryAppState","reject","toBlob","blob","toDataURL","console","error","nodes","selectedNodes","activeNode","push","selection","hasSelectionNodes","getSelectionNodes","filter","includes","Canvas","el","opt","clearCanvas","clearRect","Grid","init","renderGrid","renderVerticalLines","gridConfig","maxRight","size","plotVerticalLine","subScrollX","renderHorizontalLines","maxBottom","plotHorizontalLine","subScrollY","showGrid","strokeStyle","lineWidth","_i","beginPath","moveTo","lineTo","stroke","hideGrid","updateGrid","config","removeChild","insertBefore","children","History","historyStack","index","fixIndex","emitChange","clear","add","data","prev","copyData","shuttle","oldData","fixLength","setData","then","emitDiffNodesChange","emitDiffStateChange","catch","undo","redo","ImageEdit","isReady","previewEl","imageData","maxHeight","maxRatio","onImageSelectChange","updatePreviewElPos","ratio","backgroundImage","backgroundSize","pointerEvents","tp","mountELToWindow","top","value","getImageUrl","file","reader","FileReader","onloadend","result","readAsDataURL","getImageSize","imageObj","await","target","files","selectImage","accept","click","KeyCommand","shortcutMap","getKeyCodeArr","key","keyArr","map","item","arr","getOriginEventCodeArr","ctrlKey","metaKey","altKey","shiftKey","checkKey","findIndex","splice","Object","keys","addShortcut","removeShortcut","unBindEvent","off","checkIsAtRectangleInner","getCircleRadius","min","checkIsAtMultiplexSegment","segments","res","seg","BaseNode","id","isCreate","startX","startY","startRotate","dragNode","options","defaultColor","lineDash","globalAlpha","undefined","isClick","Error","offsetRotate","or","updateRotate","setStyle","_style","setLineDash","warpRender","renderFn","transform","halfWidth","halfHeight","move","ox","oy","emitNodeRotateChange","rotateByCenter","np","updatePos","startResize","resizeType","endResize","resize","handleResizeNode","bottomRight","updateRect","updateSize","serialize","renderDragNode","showAll","onlyShowBody","BaseMultiplexCoordinateNode","startCoordinateArr","startWidth","startHeight","fictitiousCoordinate","opts","scaleX","scaleY","slice","offsetX","offsetY","updateMultiplexCoordinateBoundingRect","addCoordinate","Array","isArray","updateFictitiousCoordinate","plotWrap","plotCircle","arc","plotRect","fillRect","transformArbitraryLineCoordinate","plotLineSegment","mx","my","lineCap","lineJoin","DragNode","offset","diagonalCoordinate","mousedownPosAndNodePosOffset","nodeRatio","hideParts","notNeedDragNode","lockRatio","handleDragMousedown","corner","centerPos","pos","handleMoveNode","handleRotateNode","handleStretchNode","newCenter","newRatio","newRect","newSize","setHideParts","parts","update","stretchCalc","calcSize","calcPos","isWidthReverse","isHeightReverse","newPos","fixPos","actClientX","actClientY","fixStretch","fp","fixNewRect","checkCoordinateInDragNodeWhere","part","_checkCoordinateIsInButton","_x","_y","ArbitraryPlot","lastLineWidth","checkIsAtArbitraryPlotLineEdge","singleRender","plotArbitraryLine","coordinates","nextCoordinate","Arrow","realtimeCoordinate","plotArrow","concat","lineDeg","plusDeg","Circle","radius","Diamond","closePath","showWidth","showHeight","drawImage","Line","isSingle","len","first","Rectangle","Text","floor","plotText","textObj","lineHeight","font","textBaseline","fillText","Triangle","Nodes","isCreateNode","isResize","resizeNode","handleResize","createNode","callback","notActive","hasActiveNode","random","getTime","toString","pureCreateNode","addNode","setActiveNode","copyNode","async","gridAdsorbentPos","createRectangleLikeNode","createCircle","createArbitraryPlot","speed","baseLineWidth","maxLineWidth","tfp","transformToCanvasCalculate","ttp","createImage","editingText","completeEditingText","trim","deleteNode","completeCreateArrow","createArrow","createLine","notCreate","insertNode","getNodesNum","hasNodes","unshiftNode","unshift","getNodeIndex","deleteAllNodes","createNodesFromData","nodeObject","checkIsClickNode","completeCreateLine","completeCallback","completeCreateNode","setActiveNodeStyle","checkInResizeHand","hand","checkIsResize","Render","beingCopyActiveNode","beingCopySelectedNodes","beingCopyNode","registerShortcutKeys","setCurrentNodesStyle","setSelectedNodeStyle","keyCommand","selectAll","setZoom","deleteCurrentNodes","copyCurrentNode","cutCurrentNode","history","grid","pasteCurrentNode","setMultiplexSelectNodes","useCurrentEventPos","copySelectionNodes","deleteActiveNode","deleteSelectedNodes","updateActiveNodePosition","updateActiveNodeSize","updateActiveNodeRotate","empty","zoomIn","num","zoomOut","zoom","fit","maxScale","scrollToCenter","copyPasteCurrentNodes","setBackgroundColor","color","background","selectNodes","Calculate","gridSize","transformToScreenCalculate","sp","MultiplexSelectNode","selectedNodeList","wholeCenterPos","updateNodes","exists","setSelectedNodeList","handleRotate","list","Selection","createSelection","hasSelection","rectangle","multiplexSelectNode","checkInNodes","_minX","_maxX","_minY","_maxY","endCoordinateList","task","all","renderSelection","cancelSelectNodes","notUpdateRect","which","TextEdit","editable","isEditing","onTextInput","onTextBlur","showTextEdit","display","crateTextInputEl","updateTextInputStyle","focus","select","tabIndex","wrap","assign","minHeight","backfaceVisibility","margin","padding","border","outline","overflow","whiteSpace","styles","opacity","isEqual","nowData","oldKeys","nowKeys","CreatLoader","plotType","imageEdit","textEdit","export","author","watch","utils","checkClick","plot","scrollStep","initCanvas","onTextInputBlur","mountFunction","checkIsOnNode","helpUpdate","zoomChange","scrollChange","currentTypeChange","activeNodeChange","multiplexSelectChange","contextmenu","diffNodesChange","diffStateChange","localDataChange","nodeRotateChange","method","getContainerRectInfo","noEmitChange","noDiffData","nNS","log","updateCurrentType","clickNode","resetCurrentType","completeCreateNewNode","createTextNode","stepNum","noHistory","diffRes","isUNOld","isUNNow","oldNodes","nowNodes","oldLen","nowLen","isAdd","isDelete","ANodes","PIDs","diffNodes","diff","isDiffBac","isDiffGrid","isDiffReadonly","isDiffScrollY","isDiffScrollX","oldState","nowState","isDiffScale","parseSetDiffData","newData","parseDiffState","parseDiffNodes","delete","cover-all","delete-all","mount","mountEl","querySelector","HTMLElement","getComputedStyle"],"mappings":"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"}