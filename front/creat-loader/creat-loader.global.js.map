{"version":3,"file":"creat-loader.global.js","sources":["src/common/constants.ts","src/common/utils/index.ts","src/classFile/Author.ts","src/classFile/Background.ts","src/classFile/Cursor.ts","src/classFile/Event.ts","src/classFile/Export.ts","src/support/Canvas.ts","src/classFile/Grid.ts","src/classFile/History.ts","src/classFile/ImageEdit.ts","src/classFile/KeyCommand.ts","src/common/utils/checkClick.ts","src/support/BaseNode.ts","src/support/BaseMultiplexCoordinateNode.ts","src/support/plot.ts","src/support/DragNode.ts","src/components/ArbitraryPlot.ts","src/components/Arrow.ts","src/components/Circle.ts","src/components/Diamond.ts","src/components/Image.ts","src/components/Line.ts","src/components/Rectangle.ts","src/components/Text.ts","src/components/Triangle.ts","src/classFile/Nodes.ts","src/classFile/Render.ts","src/common/utils/Calculate.ts","src/components/MultiplexSelectNode.ts","src/classFile/Selection.ts","src/classFile/TextEdit.ts","src/common/utils/diffData.ts","src/components/index.ts","src/API.ts","src/index.ts"],"sourcesContent":["import { KeyPosit } from '../types'\n\n// The number key corresponding to the key position\nexport const keyPosit: KeyPosit = {\n  '0': 48,\n  '1': 49,\n  '2': 50,\n  '3': 51,\n  '4': 52,\n  '5': 53,\n  '6': 54,\n  '7': 55,\n  '8': 56,\n  '9': 57,\n  Backspace: 8,\n  Tab: 9,\n  Enter: 13,\n  Shift: 16,\n  Control: 17,\n  Alt: 18,\n  CapsLock: 20,\n  Esc: 27,\n  Space: 32,\n  PageUp: 33,\n  PageDown: 34,\n  End: 35,\n  Home: 36,\n  Insert: 45,\n  Left: 37,\n  Up: 38,\n  Right: 39,\n  Down: 40,\n  Del: 46,\n  NumLock: 144,\n  Cmd: 91,\n  CmdFF: 224,\n  F1: 112,\n  F2: 113,\n  F3: 114,\n  F4: 115,\n  F5: 116,\n  F6: 117,\n  F7: 118,\n  F8: 119,\n  F9: 120,\n  F10: 121,\n  F11: 122,\n  F12: 123,\n  '`': 192,\n  '=': 187,\n  '+': 187,\n  '-': 189,\n  \"'\": 222,\n  '/': 191,\n  '.': 190,\n  a: 65,\n  b: 66,\n  c: 67,\n  d: 68,\n  e: 69,\n  f: 70,\n  g: 71,\n  h: 72,\n  i: 73,\n  j: 74,\n  k: 75,\n  l: 76,\n  m: 77,\n  n: 78,\n  o: 79,\n  p: 80,\n  q: 81,\n  r: 82,\n  s: 83,\n  t: 84,\n  u: 85,\n  v: 86,\n  w: 87,\n  x: 88,\n  y: 89,\n  z: 90\n}\n// Click on the applicable trigger pixel range\nexport const CLICK_DISTANCE = 10\n\n// Four corners of a graphical object\nexport const FOUR_CORNER = {\n  TOP_LEFT: 'topLeft',\n  TOP_RIGHT: 'topRight',\n  BOTTOM_RIGHT: 'bottomRight',\n  BOTTOM_LEFT: 'bottomLeft'\n}\n\n// Drag and drop a part of a graphic object\nexport const DRAG_NODE_PARTS = {\n  BODY: 'body',\n  ROTATE: 'rotate',\n  TOP_LEFT_BUTTON: 'topLeftButton',\n  TOP_RIGHT_BUTTON: 'topRightButton',\n  BOTTOM_RIGHT_BUTTON: 'bottomRightButton',\n  BOTTOM_LEFT_BUTTON: 'bottomLeftButton'\n}\n","import { Ctx, LocalData, Node, NodeArray, Style } from '../../types'\n\n// Generate an ID, seeded with a timestamp + random number, with the first half random and the second half incremental\nexport function getNodeID() {\n  const seed = Math.floor(Math.random() * 1e12) * 1e7 + new Date().getTime()\n  return seed.toString(36)\n}\n\n// Unique key for graphical objects\nlet nodeKeyIndex = 0\nexport function createNodeKey() {\n  nodeKeyIndex += 1\n  return nodeKeyIndex\n}\n\nexport const deepCopy = (obj: LocalData) => JSON.parse(JSON.stringify(obj))\n\n// Download the file\nexport const downloadFile = (file: string, fileName: string) => {\n  const a = document.createElement('a')\n  a.href = file\n  a.download = fileName\n  a.click()\n}\n\n// Throttling\nexport const throttle = (fn: any, ctx: Ctx, time = 20) => {\n  let _timer: any = null\n  return (...args: any) => {\n    if (_timer) {\n      return\n    }\n    _timer = setTimeout(() => {\n      fn.call(ctx, ...args)\n      _timer = null\n    }, time)\n  }\n}\n\n// Spliced text font size string\nexport const getFontString = (fontSize: number, fontFamily: string) =>\n  `${fontSize}px ${fontFamily}`\n\n// Text cut into lines\nexport const splitTextLines = (text: string) =>\n  text.replace(/\\r\\n?/g, '\\n').split('\\n')\n\n// Curvature to angle\nexport const radToDeg = (rad: number) => rad * (180 / Math.PI)\n\n// Angle to radians\nexport const degToRad = (deg: number) => deg * (Math.PI / 180)\n\nexport const createCanvas = (\n  width: number,\n  height: number,\n  option: { noStyle?: boolean; noTranslate?: boolean; className?: string } = {\n    noStyle: false,\n    noTranslate: false,\n    className: ''\n  }\n) => {\n  const canvas = document.createElement('canvas')\n  if (!option.noStyle) {\n    canvas.style.cssText = `position: absolute;left: 0;top: 0;`\n  }\n  if (option.className) {\n    canvas.className = option.className\n  }\n  // Get Drawing Context\n  const ctx = canvas.getContext('2d')\n  canvas.width = width\n  canvas.height = height\n  // Move the canvas origin to the centre of the canvas\n  if (!option.noTranslate) {\n    ctx?.translate(canvas.width / 2, canvas.height / 2)\n  }\n  return {\n    canvas,\n    ctx\n  }\n}\n\n// Calculate the distance between two coordinates\nexport const getTowCoordinateDistance = (\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number\n) => Math.sqrt((x1 - x2) ** 2 + (y1 - y2) ** 2)\n\n// Calculate the distance from a point to a line\nexport const getCoordinateToLineDistance = (\n  x: number,\n  y: number,\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number\n) => {\n  // Straight line perpendicular to x-axis\n  if (x1 === x2) {\n    return Math.abs(x - x1)\n  }\n  const B = 1\n  const A = (y1 - y2) / (x2 - x1)\n  const C = 0 - B * y1 - A * x1\n  return Math.abs((A * x + B * y + C) / Math.sqrt(A * A + B * B))\n}\n\n// Check if you have clicked on a line segment\nexport const checkIsAtSegment = (\n  x: number,\n  y: number,\n  x1: number,\n  y1: number,\n  x2: number | undefined,\n  y2: number | undefined,\n  dis = 10\n) => {\n  if (typeof x2 === 'undefined' || typeof y2 === 'undefined') {\n    return false\n  }\n  if (getCoordinateToLineDistance(x, y, x1, y1, x2, y2) > dis) {\n    return false\n  }\n  const dis1 = getTowCoordinateDistance(x, y, x1, y1)\n  const dis2 = getTowCoordinateDistance(x, y, x2, y2)\n  const dis3 = getTowCoordinateDistance(x1, y1, x2, y2)\n  const max = Math.sqrt(dis * dis + dis3 * dis3)\n  return dis1 <= max && dis2 <= max\n}\n\n// Calculate the angle of difference between two coordinates with the same centre point\nexport const getTowCoordinateRotate = (\n  cx: number,\n  cy: number,\n  tx: number,\n  ty: number,\n  fx: number,\n  fy: number\n) => radToDeg(Math.atan2(ty - cy, tx - cx) - Math.atan2(fy - cy, fx - cx))\n\n// Get coordinates rotated by a specified angle from a specified centre, clockwise or anti-clockwise rotate by passing positive or negative\nexport const getRotatedCoordinate = (\n  x: number,\n  y: number,\n  cx: number,\n  cy: number,\n  rotate: number\n) => {\n  const deg = radToDeg(Math.atan2(y - cy, x - cx))\n  const del = deg + rotate\n  const dis = getTowCoordinateDistance(x, y, cx, cy)\n  return {\n    x: Math.cos(degToRad(del)) * dis + cx,\n    y: Math.sin(degToRad(del)) * dis + cy\n  }\n}\n\n// Get the coordinates of the element's centroid\nexport const getNodeCenterCoordinate = (node: any) => {\n  const { x, y, width, height }: any = node as Node\n  return {\n    x: x + width / 2,\n    y: y + height / 2\n  }\n}\n\n// Rotate the coordinates by the specified angle at the specified centre point\nexport const transformCoordinateReverseRotate = (\n  x: number,\n  y: number,\n  cx: number,\n  cy: number,\n  rotate: number\n) => {\n  if (rotate !== 0) {\n    const rp = getRotatedCoordinate(x, y, cx, cy, -rotate)\n    x = rp.x\n    y = rp.y\n  }\n  return {\n    x,\n    y\n  }\n}\n\n//  Handles mouse coordinates according to whether the element is rotated or not, if the element is rotated, then the mouse coordinates are rotated backwards\nexport const transformCoordinateOnNode = (x: number, y: number, node: any) => {\n  const center = getNodeCenterCoordinate(node as Node)\n  return transformCoordinateReverseRotate(\n    x,\n    y,\n    center.x,\n    center.y,\n    <number>node.rotate\n  )\n}\n\n// Get the four corner coordinates of the object\nexport const getNodeFourCornerCoordinate = (node: Node, dir: string) => {\n  const { x, y, width, height }: any = node\n  switch (dir) {\n    case 'topLeft':\n      return {\n        x,\n        y\n      }\n    case 'topRight':\n      return {\n        x: x + width,\n        y\n      }\n    case 'bottomRight':\n      return {\n        x: x + width,\n        y: y + height\n      }\n    case 'bottomLeft':\n      return {\n        x,\n        y: y + height\n      }\n    default:\n      break\n  }\n  return {}\n}\n\n// Get the outer bounding box for multiple coordinates\nexport const getBoundingRect = (\n  coordinateArr = [],\n  returnFourCorners = false\n) => {\n  let minX = Infinity\n  let maxX = -Infinity\n  let minY = Infinity\n  let maxY = -Infinity\n  coordinateArr.forEach((coordinate) => {\n    const [x, y]: Array<number> = coordinate\n    if (x < minX) {\n      minX = x\n    }\n    if (x > maxX) {\n      maxX = x\n    }\n    if (y < minY) {\n      minY = y\n    }\n    if (y > maxY) {\n      maxY = y\n    }\n  })\n  const x = minX\n  const y = minY\n  const width = maxX - minX\n  const height = maxY - minY\n  // Return in four corner coordinates\n  if (returnFourCorners) {\n    return [\n      {\n        x,\n        y\n      },\n      {\n        x: x + width,\n        y\n      },\n      {\n        x: x + width,\n        y: y + height\n      },\n      {\n        x,\n        y: y + height\n      }\n    ]\n  }\n  return {\n    x,\n    y,\n    width,\n    height\n  }\n}\n\n// Get the coordinates of the four corners of a rotated graphic object\nexport const getNodeRotatedFourCornerCoordinate = (node: Node, dir: string) => {\n  const center = getNodeCenterCoordinate(node)\n  const dirPos = getNodeFourCornerCoordinate(node, dir)\n  if (!dirPos || !dirPos.x || !dirPos.y) {\n    return 0\n  }\n  return getRotatedCoordinate(\n    dirPos.x,\n    dirPos.y,\n    center.x,\n    center.y,\n    <number>node.rotate\n  )\n}\n\n// Determines whether a coordinate is within a rectangle. rx can be a graphical object with x, y, width, height\nexport const checkCoordinateIsInRectangle = (\n  x: number,\n  y: number,\n  rx: number | Node,\n  ry?: number | undefined,\n  rw?: number | undefined,\n  rh?: number | undefined\n) => {\n  if (typeof rx === 'object') {\n    const node = rx\n    rx = node.x as number\n    ry = node.y\n    rw = node.width\n    rh = node.height\n  }\n  if (\n    typeof ry === 'undefined' ||\n    typeof rw === 'undefined' ||\n    typeof rh === 'undefined'\n  ) {\n    return false\n  }\n  return x >= rx && x <= rx + rw && y >= ry && y <= ry + rh\n}\n\n// Get the outermost bounding box information of multiple graphic objects\nexport const getMultiplexNodeRectInfo = (nodeList: NodeArray = []) => {\n  if (nodeList.length <= 0) {\n    return {\n      minX: 0,\n      maxX: 0,\n      minY: 0,\n      maxY: 0\n    }\n  }\n  let minX = Infinity\n  let maxX = -Infinity\n  let minY = Infinity\n  let maxY = -Infinity\n  nodeList.forEach((node) => {\n    const coordinateList = node?.getEndCoordinateList?.()\n    coordinateList.forEach(({ x, y }: { x: number; y: number }) => {\n      if (x < minX) {\n        minX = x\n      }\n      if (x > maxX) {\n        maxX = x\n      }\n      if (y < minY) {\n        minY = y\n      }\n      if (y > maxY) {\n        maxY = y\n      }\n    })\n  })\n  return {\n    minX,\n    maxX,\n    minY,\n    maxY\n  }\n}\n\n// Calculate the actual rendering width of the text\nlet textCheckEl: HTMLDivElement | null = null\nexport const getTextActWidth = (text: string, style: Style) => {\n  if (!textCheckEl) {\n    textCheckEl = document.createElement('div')\n    textCheckEl.style.position = 'fixed'\n    textCheckEl.style.left = '-99999px'\n    document.body.appendChild(textCheckEl)\n  }\n  const { fontSize, fontFamily } = style\n  textCheckEl.innerText = text\n  textCheckEl.style.fontSize = `${fontSize}px`\n  textCheckEl.style.fontFamily = fontFamily\n  const { width } = textCheckEl.getBoundingClientRect()\n  return width\n}\n\n//  Gets the coordinates of the four corners of the graphical object, after applying the rotation\nexport const getNodeFourCorners = (node: Node) => {\n  const bottomRight = getNodeRotatedFourCornerCoordinate(node, 'bottomRight')\n  const topLeft = getNodeRotatedFourCornerCoordinate(node, 'topLeft')\n  const topRight = getNodeRotatedFourCornerCoordinate(node, 'topRight')\n  const bottomLeft = getNodeRotatedFourCornerCoordinate(node, 'bottomLeft')\n  return [topLeft, topRight, bottomLeft, bottomRight]\n}\n\n// Creating picture objects\nexport const createImageObj = (url: string) =>\n  new Promise((resolve) => {\n    const img = new Image()\n    img.setAttribute('crossOrigin', 'anonymous')\n    img.onload = () => {\n      resolve(img)\n    }\n    img.onerror = () => {\n      resolve(null)\n    }\n    img.src = url\n  })\n\n// Calculate the maximum font size that will fit all text within a fixed width\nexport const getMaxFontSizeInWidth = (\n  text: string,\n  width: number,\n  style: { fontSize: number; fontFamily: string }\n) => {\n  let fontSize = 12\n  while (\n    getTextActWidth(text, {\n      ...style,\n      fontSize: fontSize + 1\n    }) < width\n  ) {\n    fontSize += 1\n  }\n  return fontSize\n}\n\n// Calculating the actual width of line feed text\nexport const getWrapTextActWidth = (node: Node) => {\n  const { text }: any = node\n  const textArr = splitTextLines(text)\n  let maxWidth = -Infinity\n  textArr.forEach((textRow) => {\n    const width = getTextActWidth(textRow, <any>node.style)\n    if (width > maxWidth) {\n      maxWidth = width\n    }\n  })\n  return maxWidth\n}\n\n// Calculate the number of words in the longest line of newline text\nexport const getWrapTextMaxRowTextNumber = (text: string) => {\n  const textArr = splitTextLines(text)\n  let maxNumber = -Infinity\n  textArr.forEach((textRow) => {\n    if (textRow.length > maxNumber) {\n      maxNumber = textRow.length\n    }\n  })\n  return maxNumber\n}\n\n// Calculate the width and height of a text graphic object\nexport const getTextNodeSize = (node: Node) => {\n  const { text, style }: any = node\n  const width = getWrapTextActWidth(node)\n  const lines = Math.max(splitTextLines(text).length, 1)\n  const lineHeight = style.fontSize * style.lineHeightRatio\n  const height = lines * lineHeight\n  return {\n    width,\n    height\n  }\n}\n\n// Calculate brush thickness based on speed\nexport const computedLineWidthBySpeed = (\n  speed: number,\n  lastLineWidth: number,\n  baseLineWidth = 2\n) => {\n  let lineWidth = 0\n  const maxLineWidth = baseLineWidth + 2\n  const maxSpeed = 10\n  const minSpeed = 0.5\n  if (speed >= maxSpeed) {\n    lineWidth = baseLineWidth\n  } else if (speed <= minSpeed) {\n    lineWidth = maxLineWidth + 1\n  } else {\n    lineWidth =\n      maxLineWidth - ((speed - minSpeed) / (maxSpeed - minSpeed)) * maxLineWidth\n  }\n  if (lastLineWidth === -1) {\n    lastLineWidth = maxLineWidth\n  }\n  return lineWidth * 0.5 + lastLineWidth * 0.3\n}\n","import { keyPosit } from '../common/constants'\nimport { throttle } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class Author {\n  public app: AppObject\n\n  public startScrollX: number | undefined\n\n  public startScrollY: number | undefined\n\n  isDragAuthor: boolean\n\n  constructor(app: AppObject) {\n    this.app = app\n    // Save the scroll offset when dragging is about to start\n    this.startScrollX = 0\n    this.startScrollY = 0\n    // Canvas drag and drop Author\n    this.isDragAuthor = false\n    // A little relief from lag\n    this.onMove = throttle(this.onMove, this as any, 15)\n    this.bindEvent()\n  }\n\n  // Save the current scroll offset\n  onStart() {\n    this.startScrollX = this.app.state.scrollX\n    this.startScrollY = this.app.state.scrollY\n  }\n\n  // Update scroll offset and re-render\n  onMove(e: any, event: { mouseOffset: { originX: number; originY: number } }) {\n    if (\n      typeof this.startScrollX !== 'undefined' &&\n      typeof this.startScrollY !== 'undefined' &&\n      typeof this.app.state.scale !== 'undefined'\n    ) {\n      this.app.scrollTo(\n        this.startScrollX - event.mouseOffset.originX / this.app.state.scale,\n        this.startScrollY - event.mouseOffset.originY / this.app.state.scale\n      )\n    }\n  }\n\n  bindEvent() {\n    this.app.event.on('keydown', (e: { keyCode: number }) => {\n      if (e.keyCode === keyPosit.Space) {\n        this.isDragAuthor = true\n        this.app.cursor.set('grab')\n      }\n    })\n    this.app.event.on('keyup', () => {\n      if (this.isDragAuthor) {\n        this.isDragAuthor = false\n        this.app.cursor.set('default')\n      }\n    })\n  }\n\n  // Set to edit Author\n  setEditAuthor() {\n    this.app.cursor.set('default')\n    this.app.updateState({\n      readonly: false\n    })\n  }\n\n  // Set to read-only Author\n  setReadonlyAuthor() {\n    this.app.cursor.set('grab')\n    this.app.cancelActiveNode()\n    this.app.updateState({\n      readonly: true\n    })\n  }\n}\n","import { AppObject, Ctx } from '../types'\n\nexport default class Background {\n  public app: AppObject\n\n  constructor(app: AppObject) {\n    this.app = app\n  }\n\n  // Setting the background\n  set() {\n    if (this.app.state.backgroundColor) {\n      this.addBackgroundColor()\n    } else {\n      this.remove()\n    }\n  }\n\n  // Add background colour\n  addBackgroundColor() {\n    this.app.mountEL.style.backgroundColor = <string>(\n      this.app.state.backgroundColor\n    )\n  }\n\n  // Remove background colour\n  remove() {\n    this.app.mountEL.style.backgroundColor = ''\n  }\n\n  // Set background colour inside canvas, not css style\n  static canvasAddBackgroundColor(\n    ctx: Ctx,\n    width: number,\n    height: number,\n    backgroundColor: string\n  ) {\n    ctx.save()\n    ctx.rect(0, 0, width, height)\n    ctx.fillStyle = backgroundColor\n    ctx.fill()\n    ctx.restore()\n  }\n}\n","import { DRAG_NODE_PARTS } from '../common/constants'\nimport { AppObject } from '../types'\n\nexport default class Cursor {\n  public app: AppObject\n\n  public currentType: string\n\n  constructor(app: AppObject) {\n    this.app = app\n    this.currentType = 'default'\n  }\n\n  // Set the mouse pointer style\n  set(type = 'default') {\n    this.currentType = type\n    let style = type\n    if (type === 'eraser') {\n      style = `url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAbZJREFUSEvNlL1rVEEUxc95uwvCVjYKNnZa2ATEXrALNhaKiBgQDabQwt13hlQbi30w8x4oNhaCkYBFElAhoJXaip2FRfIX2FhY2c2VJy5skn0fERacbphzf3Pv5dxLzOlwTlz8H2Dv/VqSJF/NbFHS3bpqW2ec5/mqmWUk1wC8iTFmzrnLVfBWYO/9gGQxBVkl+c7M1iWdnwVvBIcQ7gN4OiP4IckPZrYj6fTB91pwURT3YozPqso1sxWSnwF8knR8WlcJDiHcAfC8yY5mdgvAT5KvJXUn+plg7/0SyZdN0Kn3bQA/JK1UgvM8v2Fmr44A/SMleSlN048zwSGEqwC2jgpNkmRxOBy+r+yx9/4xyQUAF9vCzeyKc+5trStCCCaJRVFciDF+aQG/Lmmz1schhHKKXkg6UQqzLDvT7XZ3a+BLkjZaTV6ZcafTOTsYDPbKgPF4fLLX630/VCa5nKZprRX32a1cMiRHZTsmsNFodKzf7/+a3M3stnNuvalNh3w8gQO4Jmn7r1OeADhlZjedc62sWDUgyyQfADgH4BuAR2WG5UdNmdZOXtvgOl3jdvvXT+YG/g3VNZQXhpoDKQAAAABJRU5ErkJggg==) 10 10, auto`\n    }\n    if (type === 'text') {\n      style = `url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAWZJREFUSEvNlLFOwzAQhi+5iaUrDDwBHekDNHtZEOorMFk5JQ8APEAsJyOPwAjsZEZ0LAMrCzwBUxx0kVM5adI4RZXwlMj2p///fXceHGh5B+LC/wPHcXxWFMWSHSulbtvO91JsoA8AMDXAXCkV2PC9wAwgIlZ5Y8HubOWjwLX9GtCCN1Q7g1v2N+oM/Mr3/Usp5UftwAlsoG8AcNRlnfeTJHkflbGBrnvqvZGrM5iI5gDw0gNdI+KyrXQwigHoDyLO+qAM78w4DMNjz/O++todEae7oJ1gIcQpIn7+BboFHrDP5wOlVO4yuBpREBGX1HnPRWdoQ3EURQut9VMXtCzLkzRNv12UblUFET0CwEX7stZ6lmXZagx0o1gIMTEPNrEAK631dQ01rVuNyPobAHg+5PZeQ7HVXWz31ff9eynls62SiEoDCqzhU+Vu73VFMd/14qZiWDGDuCOrZf/b952G0Nh8+fwvoNqzF6HDmhsAAAAASUVORK5CYII=) 10 10, auto`\n    }\n    this.app.mountEL.style.cursor = style\n  }\n\n  setEraser() {\n    this.set('eraser')\n  }\n\n  setText() {\n    this.set('text')\n  }\n\n  setMove() {\n    this.set('move')\n  }\n\n  hide() {\n    this.set('none')\n  }\n\n  reset() {\n    this.set()\n  }\n\n  setCrossHair() {\n    this.set('crosshair')\n  }\n\n  // Set to a movable state in a certain direction\n  setResize(direction: string) {\n    let type = ''\n    switch (direction) {\n      case DRAG_NODE_PARTS.BODY:\n        type = 'move'\n        break\n      case DRAG_NODE_PARTS.ROTATE:\n        type = 'grab'\n        break\n      case DRAG_NODE_PARTS.TOP_LEFT_BUTTON:\n        type = 'nw-resize'\n        break\n      case DRAG_NODE_PARTS.TOP_RIGHT_BUTTON:\n        type = 'ne-resize'\n        break\n      case DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON:\n        type = 'se-resize'\n        break\n      case DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON:\n        type = 'sw-resize'\n        break\n      default:\n        break\n    }\n    this.set(type)\n  }\n}\n","import EventEmitter from 'eventemitter3'\n\nimport { getTowCoordinateDistance } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class Event extends EventEmitter {\n  public app: AppObject\n\n  public calculate: any\n\n  public lastMousePos: { x: number; y: number }\n\n  public mouseDistance: number\n\n  public lastMouseTime: number\n\n  public mouseDuration: number\n\n  public mouseSpeed: number\n\n  public isMousedown: boolean\n\n  public mousedownPos: {\n    originClientY: number\n    x: number\n    y: number\n    unGridClientX: number\n    unGridClientY: number\n    originClientX: number\n  }\n\n  public mouseOffset: {\n    originX: number\n    originY: number\n    x: number\n    y: number\n  }\n\n  constructor(app: AppObject) {\n    super()\n    this.app = app\n    this.calculate = app.calculate\n\n    // Record the mouse position at the previous moment\n    this.lastMousePos = {\n      x: 0,\n      y: 0\n    }\n\n    // Distance of mouse movement in the previous instant\n    this.mouseDistance = 0\n\n    // Record the time of the previous moment\n    this.lastMouseTime = Date.now()\n\n    // The moment before\n    this.mouseDuration = 0\n\n    // Mouse movement speed in the previous instant\n    this.mouseSpeed = 0\n\n    // Is the mouse pressed\n    this.isMousedown = false\n\n    // Mouse position when pressed\n    this.mousedownPos = {\n      x: 0,\n      y: 0,\n      unGridClientX: 0,\n      unGridClientY: 0,\n      originClientX: 0,\n      originClientY: 0\n    }\n\n    // The difference between the current position of the mouse and the position when it is pressed\n    this.mouseOffset = {\n      x: 0,\n      y: 0,\n      originX: 0,\n      originY: 0\n    }\n\n    this.onMousedown = this.onMousedown.bind(this)\n    this.onMousemove = this.onMousemove.bind(this)\n    this.onMouseup = this.onMouseup.bind(this)\n    this.onDblclick = this.onDblclick.bind(this)\n    this.onMousewheel = this.onMousewheel.bind(this)\n    this.onKeydown = this.onKeydown.bind(this)\n    this.onKeyup = this.onKeyup.bind(this)\n    this.onContextmenu = this.onContextmenu.bind(this)\n    this.bindEvent()\n  }\n\n  onMouseup(e: any) {\n    e = this.transformEvent(e)\n    this.isMousedown = false\n    this.mousedownPos.x = 0\n    this.mousedownPos.y = 0\n    this.emit('mouseup', e, this)\n  }\n\n  onDblclick(e: any) {\n    e = this.transformEvent(e)\n    this.emit('dblclick', e, this)\n  }\n\n  onMousewheel(e: any) {\n    e = this.transformEvent(e)\n    this.emit('mousewheel', e.originEvent.wheelDelta < 0 ? 'down' : 'up')\n  }\n\n  onContextmenu(e: any) {\n    e.stopPropagation()\n    e.preventDefault()\n    e = this.transformEvent(e)\n    this.emit('contextmenu', e, this)\n  }\n\n  onKeydown(e: any) {\n    this.emit('keydown', e, this)\n  }\n\n  onKeyup(e: any) {\n    this.emit('keyup', e, this)\n  }\n\n  onMousedown(e: any) {\n    e = this.transformEvent(e)\n    this.isMousedown = true\n    this.mousedownPos.x = e.clientX\n    this.mousedownPos.y = e.clientY\n    this.mousedownPos.unGridClientX = e.unGridClientX\n    this.mousedownPos.unGridClientY = e.unGridClientY\n    this.mousedownPos.originClientX = e.originEvent.clientX\n    this.mousedownPos.originClientY = e.originEvent.clientY\n    this.emit('mousedown', e, this)\n  }\n\n  onMousemove(e: any) {\n    e = this.transformEvent(e)\n    const x = e.clientX\n    const y = e.clientY\n    if (this.isMousedown) {\n      this.mouseOffset.x = x - this.mousedownPos.x\n      this.mouseOffset.y = y - this.mousedownPos.y\n      this.mouseOffset.originX =\n        e.originEvent.clientX - this.mousedownPos.originClientX\n      this.mouseOffset.originY =\n        e.originEvent.clientY - this.mousedownPos.originClientY\n    }\n    const curTime = Date.now()\n    this.mouseDuration = curTime - this.lastMouseTime\n    this.mouseDistance = getTowCoordinateDistance(\n      x,\n      y,\n      this.lastMousePos.x,\n      this.lastMousePos.y\n    )\n    this.mouseSpeed = this.mouseDistance / this.mouseDuration\n    this.emit('mousemove', e, this)\n    this.lastMouseTime = curTime\n    this.lastMousePos.x = x\n    this.lastMousePos.y = y\n  }\n\n  // events into coordinates, and adsorption if grid is turned on\n  transformEvent(e: { clientX: any; clientY: any }) {\n    const { calculate } = this.app\n    const wp = calculate.windowToContainer(e.clientX, e.clientY)\n    let { x, y } = calculate.reverseScale(wp.x, wp.y)\n    x = calculate.addScrollX(x)\n    y = calculate.addScrollY(y)\n    const unGridClientX = x\n    const unGridClientY = y\n    const gp = calculate.gridAdsorbent(x, y)\n    return {\n      originEvent: e,\n      unGridClientX,\n      unGridClientY,\n      clientX: gp.x,\n      clientY: gp.y\n    }\n  }\n\n  bindEvent() {\n    this.app.mountEL.addEventListener('mousedown', this.onMousedown)\n    this.app.mountEL.addEventListener('mousemove', this.onMousemove)\n    this.app.mountEL.addEventListener('mouseup', this.onMouseup)\n    this.app.mountEL.addEventListener('dblclick', this.onDblclick)\n    this.app.mountEL.addEventListener('mousewheel', this.onMousewheel)\n    this.app.mountEL.addEventListener('contextmenu', this.onContextmenu)\n    window.addEventListener('keydown', this.onKeydown)\n    window.addEventListener('keyup', this.onKeyup)\n  }\n\n  unbindEvent() {\n    this.app.mountEL.removeEventListener('mousedown', this.onMousedown)\n    this.app.mountEL.removeEventListener('mousemove', this.onMousemove)\n    this.app.mountEL.removeEventListener('mouseup', this.onMouseup)\n    this.app.mountEL.removeEventListener('dblclick', this.onDblclick)\n    this.app.mountEL.removeEventListener('mousewheel', this.onMousewheel)\n    this.app.mountEL.removeEventListener('contextmenu', this.onContextmenu)\n    window.removeEventListener('keydown', this.onKeydown)\n    window.removeEventListener('keyup', this.onKeyup)\n  }\n}\n","import { createCanvas, getMultiplexNodeRectInfo } from '../common/utils'\nimport { AppObject, Ctx, Node, NodeArray } from '../types'\nimport Background from './Background'\n\nexport default class Export {\n  public app: AppObject\n\n  public openPreview: boolean\n\n  public saveState: {\n    width: number\n    scale: number\n    scrollY: number\n    scrollX: number\n    height: number\n    ctx?: Ctx\n  }\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.openPreview = false\n\n    this.saveState = {\n      scale: 0,\n      scrollX: 0,\n      scrollY: 0,\n      width: 0,\n      height: 0\n    }\n  }\n\n  // Export as json data\n  exportJson() {\n    return this.app.getData()\n  }\n\n  // Draw all graphic objects\n  render(ctx: Ctx, onlySelected: boolean) {\n    ctx.save()\n    this.getNodeList(onlySelected).forEach((node: Node) => {\n      if (node.noRender) {\n        return\n      }\n      const cacheActive = node.isActive\n      const cacheSelected = node.isSelected\n      node.isActive = false\n      node.isSelected = false\n      node.render()\n      node.isActive = cacheActive\n      node.isSelected = cacheSelected\n    })\n    ctx.restore()\n  }\n\n  // Save the current state data of the app class\n  saveAppState() {\n    const { width, height, state, ctx } = this.app\n    this.saveState.width = width\n    this.saveState.height = height\n    if (state.scale) {\n      this.saveState.scale = state.scale\n    }\n    if (state.scrollX) {\n      this.saveState.scrollX = state.scrollX\n    }\n    if (state.scrollY) {\n      this.saveState.scrollY = state.scrollY\n    }\n    this.saveState.ctx = ctx\n  }\n\n  // Export as image\n  exportImage({\n    type = 'image/png',\n    renderBg = true,\n    useBlob = false,\n    paddingX = 10,\n    paddingY = 10,\n    onlySelected = true\n  } = {}) {\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.getNodeList(onlySelected)\n    )\n    const width = maxX - minX + paddingX * 2\n    const height = maxY - minY + paddingY * 2\n    // Creating an export canvas\n    const { canvas, ctx } = createCanvas(width, height, {\n      noStyle: true,\n      noTranslate: true\n    })\n    if (!ctx) {\n      // eslint-disable-next-line no-console\n      console.error('Create Export Canvas Error')\n      return ''\n    }\n    this.show(canvas)\n    this.saveAppState()\n    this.changeAppState(minX - paddingX, minY - paddingY, ctx)\n    // Painting background colours\n    if (renderBg && this.app.state.backgroundColor && ctx) {\n      Background.canvasAddBackgroundColor(\n        ctx,\n        width,\n        height,\n        this.app.state.backgroundColor\n      )\n    }\n    // Drawing graphic objects to exported canvas\n    this.render(ctx, onlySelected)\n    this.recoveryAppState()\n\n    if (useBlob) {\n      return new Promise((resolve, reject) => {\n        canvas.toBlob((blob) => {\n          if (blob) {\n            resolve(blob)\n          } else {\n            reject()\n          }\n        }, type)\n      })\n    }\n    return canvas.toDataURL(type)\n  }\n\n  show(canvas: HTMLCanvasElement) {\n    if (this.openPreview) {\n      canvas.style.cssText = `position: absolute;left: 0;top: 0;background-color: #FFFFFF;`\n      document.body.appendChild(canvas)\n    }\n  }\n\n  // Recovery of app class status data\n  recoveryAppState() {\n    const { width, height, scale, scrollX, scrollY, ctx } = this.saveState\n    this.app.state.scale = scale\n    this.app.state.scrollX = scrollX\n    this.app.state.scrollY = scrollY\n    this.app.width = width\n    this.app.height = height\n    if (ctx) {\n      this.app.ctx = ctx\n    }\n  }\n\n  // Temporary modification of app class status data\n  changeAppState(minX: number, minY: number, ctx: Ctx) {\n    this.app.ctx = ctx\n    this.app.width = minX * 2\n    this.app.height = minY * 2\n    this.app.state.scale = 1\n    this.app.state.scrollX = 0\n    this.app.state.scrollY = 0\n  }\n\n  // Get the graphic object to be exported\n  getNodeList(onlySelected = true) {\n    // Exporting all graphic objects\n    if (!onlySelected) {\n      return this.app.nodes.nodeList\n    }\n    // Export only active or selected graphic objects\n    let selectedNodes: NodeArray = []\n    if (this.app.nodes.activeNode) {\n      selectedNodes.push(this.app.nodes.activeNode)\n    } else if (this.app.selection.hasSelectionNodes()) {\n      selectedNodes = this.app.selection.getSelectionNodes()\n    }\n    return this.app.nodes.nodeList.filter((node: Node) =>\n      selectedNodes.includes(node)\n    )\n  }\n}\n","import { createCanvas } from '../common/utils'\nimport { Ctx } from '../types'\n\nexport default class Canvas {\n  public width: number\n\n  public height: number\n\n  public el: HTMLCanvasElement | undefined\n\n  public ctx: Ctx | undefined\n\n  constructor(\n    width: number,\n    height: number,\n    opt?: { noStyle?: boolean; noTranslate?: boolean; className?: string }\n  ) {\n    this.width = width\n    this.height = height\n    const { canvas, ctx } = createCanvas(width, height, opt)\n    if (ctx) {\n      this.el = canvas\n      this.ctx = ctx\n    }\n  }\n\n  clearCanvas() {\n    const { width, height } = this\n    this.ctx?.clearRect(-width / 2, -height / 2, width, height)\n  }\n}\n","import Canvas from '../support/Canvas'\nimport { AppObject, Ctx } from '../types'\n\nexport default class Grid {\n  public app: AppObject\n\n  public canvas: any\n\n  public ctx: Ctx | null\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.canvas = null\n\n    this.ctx = null\n\n    this.init()\n\n    this.app.on('zoomChange', this.renderGrid, this)\n\n    this.app.on('scrollChange', this.renderGrid, this)\n  }\n\n  // plot vertical lines\n  renderVerticalLines() {\n    const { calculate, width, state } = this.app\n    const { gridConfig, scale } = state\n    let maxRight = 0\n    if (\n      typeof gridConfig === 'undefined' ||\n      typeof scale === 'undefined' ||\n      typeof gridConfig.size === 'undefined'\n    ) {\n      // eslint-disable-next-line no-console\n      console.error('gridConfig or scale or gridConfig.size is undefined')\n      return\n    }\n    for (let i = -width / 2; i < width / 2; i += gridConfig.size) {\n      this.plotVerticalLine(i)\n      maxRight = i\n    }\n    // Draws the line beyond the left side when rolling to the right\n    for (\n      let i = -width / 2 - gridConfig.size;\n      i > -calculate.subScrollX(width / scale / 2);\n      i -= gridConfig.size\n    ) {\n      this.plotVerticalLine(i)\n    }\n    // Draws the line beyond the right when rolling to the left\n    for (\n      let i = maxRight + gridConfig.size;\n      i < calculate.addScrollX(width / scale / 2);\n      i += gridConfig.size\n    ) {\n      this.plotVerticalLine(i)\n    }\n  }\n\n  // Rendering of horizontal lines\n  renderHorizontalLines() {\n    const { calculate, height, state } = this.app\n    const { gridConfig, scale } = state\n    if (\n      typeof gridConfig === 'undefined' ||\n      typeof scale === 'undefined' ||\n      typeof gridConfig.size === 'undefined'\n    ) {\n      return\n    }\n    let maxBottom = 0\n    for (let i = -height / 2; i < height / 2; i += gridConfig.size) {\n      this.plotHorizontalLine(i)\n      maxBottom = i\n    }\n    // Draws the line beyond the top when rolling downwards\n    for (\n      let i = -height / 2 - gridConfig.size;\n      i > -calculate.subScrollY(height / scale / 2);\n      i -= gridConfig.size\n    ) {\n      this.plotHorizontalLine(i)\n    }\n    // Draws the line beyond the bottom when rolling upwards\n    for (\n      let i = maxBottom + gridConfig.size;\n      i < calculate.addScrollY(height / scale / 2);\n      i += gridConfig.size\n    ) {\n      this.plotHorizontalLine(i)\n    }\n  }\n\n  renderGrid() {\n    this.canvas.clearCanvas()\n    const { gridConfig, scale, showGrid } = this.app.state\n    if (!showGrid) {\n      return\n    }\n    if (\n      this.ctx &&\n      scale &&\n      gridConfig &&\n      this.ctx.strokeStyle &&\n      this.ctx.lineWidth\n    ) {\n      this.ctx.save()\n      this.ctx.scale(scale, scale)\n      // @ts-ignore\n      this.ctx.strokeStyle = gridConfig.strokeStyle\n      // @ts-ignore\n      this.ctx.lineWidth = gridConfig.lineWidth\n    }\n\n    this.renderVerticalLines()\n\n    this.renderHorizontalLines()\n\n    this.ctx?.restore()\n  }\n\n  // Drawing horizontal lines\n  plotHorizontalLine(i: number) {\n    const { calculate, width, state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return\n    }\n    const _i = calculate.subScrollY(i)\n    this.ctx?.beginPath()\n    this.ctx?.moveTo(-width / state.scale / 2, _i)\n    this.ctx?.lineTo(width / state.scale / 2, _i)\n    this.ctx?.stroke()\n  }\n\n  // plot the reset line\n  plotVerticalLine(i: number) {\n    const { calculate, height, state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return\n    }\n    const _i = calculate.subScrollX(i)\n    this.ctx?.beginPath()\n    this.ctx?.moveTo(_i, -height / state.scale / 2)\n    this.ctx?.lineTo(_i, height / state.scale / 2)\n    this.ctx?.stroke()\n  }\n\n  showGrid() {\n    this.app.updateState({\n      showGrid: true\n    } as any)\n    this.renderGrid()\n  }\n\n  hideGrid() {\n    this.app.updateState({\n      showGrid: false\n    } as any)\n    this.canvas.clearCanvas()\n  }\n\n  updateGrid(config = {}) {\n    this.app.updateState({\n      gridConfig: {\n        ...this.app.state.gridConfig,\n        ...config\n      }\n    } as any)\n    if (this.app.state.showGrid) {\n      this.hideGrid()\n      this.showGrid()\n    }\n  }\n\n  init() {\n    if (this.canvas) {\n      this.app.mountEL.removeChild(this.canvas.el)\n    }\n    const { width, height } = this.app\n    this.canvas = new Canvas(width, height, {\n      className: 'grid'\n    })\n    this.ctx = this.canvas.ctx\n    this.app.mountEL.insertBefore(this.canvas.el, this.app.mountEL.children[0])\n  }\n}\n","import { deepCopy } from '../common/utils'\nimport { AppObject, LocalData } from '../types'\n\nexport default class History {\n  public app: AppObject\n\n  public historyStack: Array<LocalData>\n\n  public length: number\n\n  public index: number\n\n  public fixIndex: number\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.historyStack = []\n\n    this.length = 0\n\n    this.index = -1\n\n    this.fixIndex = -1\n  }\n\n  emitChange() {\n    this.app.emit('shuttle', this.index, this.length)\n  }\n\n  now() {\n    return this.historyStack[this.length - 1]\n  }\n\n  clear() {\n    this.index = -1\n    this.length = 0\n    this.historyStack = []\n    this.emitChange()\n  }\n\n  add(data: LocalData) {\n    const prev = this.length > 0 ? this.historyStack[this.length - 1] : null\n    const copyData = deepCopy(data)\n    if (copyData === prev) {\n      return\n    }\n    this.historyStack.push(copyData)\n    this.length += 1\n    this.index = this.length - 1\n    this.emitChange()\n  }\n\n  shuttle() {\n    const oldData = this.app.getData()\n    const data = this.historyStack[this.index]\n    // Avoid interference and enforce correction\n    this.fixIndex = this.index\n    const fixLength = this.length\n    this.app\n      .setData(data, true)\n      .then(() => {\n        this.index = this.fixIndex\n        this.length = fixLength\n        this.emitChange()\n        this.app.emit('change', data)\n        this.app.emitDiffNodesChange(oldData, data)\n        this.app.emitDiffStateChange(oldData, data)\n      })\n      .catch(() => {\n        // eslint-disable-next-line no-console\n        console.error('History shuttle setData error')\n      })\n  }\n\n  undo() {\n    if (this.index <= 0) {\n      return\n    }\n    this.index -= 1\n    this.shuttle()\n  }\n\n  redo() {\n    if (this.index >= this.length - 1) {\n      return\n    }\n    this.index += 1\n    this.shuttle()\n  }\n}\n","import EventEmitter from 'eventemitter3'\n\nimport { AppObject } from '../types'\n\nexport default class ImageEdit extends EventEmitter {\n  public app: AppObject\n\n  public el: HTMLInputElement | null\n\n  isReady: boolean\n\n  public previewEl: HTMLDivElement | null\n\n  public imageData: {\n    url: string\n    width: number\n    height: number\n    ratio: number\n    imageObj: HTMLInputElement\n  } | null\n\n  public maxWidth: number\n\n  public maxHeight: number\n\n  public maxRatio: number\n\n  constructor(app: AppObject) {\n    super()\n\n    this.app = app\n\n    this.el = null\n\n    this.isReady = false\n\n    this.previewEl = null\n\n    this.imageData = null\n\n    this.maxWidth = 750\n\n    this.maxHeight = 450\n\n    this.maxRatio = this.maxWidth / this.maxHeight\n\n    this.onImageSelectChange = this.onImageSelectChange.bind(this)\n  }\n\n  updatePreviewElPos(x: number, y: number) {\n    const width = 100\n    if (!this.imageData) {\n      // eslint-disable-next-line no-console\n      console.error('imageData is null')\n      return\n    }\n    const height = width / this.imageData.ratio\n    if (!this.previewEl) {\n      this.previewEl = document.createElement('div')\n      this.previewEl.style.position = 'fixed'\n      this.previewEl.style.width = `${width}px`\n      this.previewEl.style.height = `${height}px`\n      this.previewEl.style.backgroundImage = `url('${this.imageData.url}')`\n      this.previewEl.style.backgroundSize = 'cover'\n      this.previewEl.style.pointerEvents = 'none'\n      document.body.appendChild(this.previewEl)\n    }\n    const tp = this.app.calculate.mountELToWindow(x, y)\n    this.previewEl.style.left = `${tp.x - width / 2}px`\n    this.previewEl.style.top = `${tp.y - height / 2}px`\n  }\n\n  reset() {\n    if (this.el) {\n      this.el.value = ''\n    }\n    this.isReady = false\n    if (this.previewEl) {\n      document.body.removeChild(this.previewEl)\n    }\n    this.previewEl = null\n    this.imageData = null\n  }\n\n  async getImageUrl(file: Blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        resolve(reader.result)\n      }\n      reader.onerror = () => {\n        reject()\n      }\n      reader.readAsDataURL(file)\n    })\n  }\n\n  async getImageSize(url: string): Promise<{\n    imageObj: HTMLInputElement\n    size: {\n      width: number\n      height: number\n    }\n    ratio: number\n  }> {\n    return new Promise((resolve, reject) => {\n      const img = new Image()\n      img.setAttribute('crossOrigin', 'anonymous')\n      img.onload = () => {\n        let { width } = img\n        let { height } = img\n        const ratio = img.width / img.height\n        if (img.width > this.maxWidth || img.height > this.maxHeight) {\n          if (ratio > this.maxRatio) {\n            width = this.maxWidth\n            height = this.maxWidth / ratio\n          } else {\n            height = this.maxHeight\n            width = this.maxHeight * ratio\n          }\n        }\n        resolve({\n          imageObj: img,\n          size: {\n            width,\n            height\n          },\n          ratio\n        } as any)\n      }\n      img.onerror = () => {\n        reject()\n      }\n      img.src = url\n    })\n  }\n\n  async onImageSelectChange(e: any) {\n    const url = await this.getImageUrl(e.target.files[0])\n    if (typeof url !== 'string') {\n      // eslint-disable-next-line no-console\n      console.error('url is not string')\n      return\n    }\n    const { imageObj, size, ratio } = await this.getImageSize(url)\n    this.isReady = true\n    this.imageData = {\n      url,\n      ...size,\n      ratio,\n      imageObj\n    }\n    this.emit('imageSelectChange', this.imageData)\n  }\n\n  selectImage() {\n    if (!this.el) {\n      this.el = document.createElement('input')\n      this.el.style.position = 'fixed'\n      this.el.style.left = '-9999999px'\n      this.el.type = 'file'\n      this.el.accept = 'image/*'\n      this.el.addEventListener('change', this.onImageSelectChange)\n      document.body.appendChild(this.el)\n    }\n    this.el.click()\n  }\n}\n","import { keyPosit } from '../common/constants'\nimport { AppObject, KeyPosit } from '../types'\n\nexport default class KeyCommand {\n  public app: AppObject\n\n  public keyPosit: KeyPosit\n\n  public shortcutMap: any\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.keyPosit = keyPosit\n\n    this.shortcutMap = {}\n\n    this.bindEvent()\n  }\n\n  // Get the array of key values corresponding to the shortcut keys\n  getKeyCodeArr(key: string) {\n    key = key.replace(/\\+\\+/, '+add')\n    const keyArr = key\n      .split(/\\s*\\+\\s*/)\n      .map((item) => (item === 'add' ? '+' : item))\n    const arr: any[] = []\n    keyArr.forEach((item) => {\n      // @ts-ignore\n      arr.push(keyPosit[item])\n    })\n    return arr\n  }\n\n  // Get an array of key values in an event object\n  getOriginEventCodeArr(e: {\n    stopPropagation?: () => void\n    preventDefault?: () => void\n    ctrlKey?: any\n    metaKey?: any\n    altKey?: any\n    shiftKey?: any\n    keyCode?: any\n  }) {\n    const arr = []\n    if (e.ctrlKey || e.metaKey) {\n      arr.push(keyPosit.Control)\n    }\n    if (e.altKey) {\n      arr.push(keyPosit.Alt)\n    }\n    if (e.shiftKey) {\n      arr.push(keyPosit.Shift)\n    }\n    if (!arr.includes(e.keyCode)) {\n      arr.push(e.keyCode)\n    }\n    return arr\n  }\n\n  // Check if the key value matches\n  checkKey(\n    e: { stopPropagation: () => void; preventDefault: () => void },\n    key: string\n  ) {\n    const o = this.getOriginEventCodeArr(e)\n    const k = this.getKeyCodeArr(key)\n    if (o.length !== k.length) {\n      return false\n    }\n    for (let i = 0; i < o.length; i += 1) {\n      const index = k.findIndex((item) => item === o[i])\n      if (index === -1) {\n        return false\n      }\n      k.splice(index, 1)\n    }\n    return true\n  }\n\n  onKeydown(e: { stopPropagation: () => void; preventDefault: () => void }) {\n    Object.keys(this.shortcutMap).forEach((key) => {\n      if (this.checkKey(e, key)) {\n        e.stopPropagation()\n        e.preventDefault()\n        this.shortcutMap[key].forEach(\n          (f: { fn: { call: (arg0: any) => void }; ctx: any }) => {\n            f.fn.call(f.ctx)\n          }\n        )\n      }\n    })\n  }\n\n  // Add shortcut command\n  addShortcut(key: string, fn: any, ctx?: any) {\n    key.split(/\\s*\\|\\s*/).forEach((item) => {\n      if (this.shortcutMap[item]) {\n        this.shortcutMap[item].push({\n          fn,\n          ctx\n        })\n      } else {\n        this.shortcutMap[item] = [\n          {\n            fn,\n            ctx\n          }\n        ]\n      }\n    })\n  }\n\n  // Remove shortcut command\n  removeShortcut(key: string, fn: any) {\n    key.split(/\\s*\\|\\s*/).forEach((item) => {\n      if (this.shortcutMap[item]) {\n        if (fn) {\n          const index = this.shortcutMap[item].findIndex(\n            (f: { fn: any }) => f.fn === fn\n          )\n          if (index !== -1) {\n            this.shortcutMap[item].splice(index, 1)\n          }\n        } else {\n          this.shortcutMap[item] = []\n          delete this.shortcutMap[item]\n        }\n      }\n    })\n  }\n\n  bindEvent() {\n    this.app.event.on('keydown', this.onKeydown, this)\n  }\n\n  unBindEvent() {\n    this.app.event.off('keydown', this.onKeydown)\n  }\n}\n","import { Node } from '../../types'\nimport { CLICK_DISTANCE } from '../constants'\nimport {\n  checkCoordinateIsInRectangle,\n  checkIsAtSegment,\n  getTowCoordinateDistance\n} from './index'\n\ntype Segments = Array<[x1: number, y1: number, x2: number, y2: number]>\ntype Rp = { xs?: number; ys?: number; x: number; y: number }\n\n// Detects if a click is inside a rectangle\nexport const checkIsAtRectangleInner = (node: any, rp: Rp) =>\n  checkCoordinateIsInRectangle(rp.x, rp.y, node as Node) ? node : null\n\n// Calculate the radius of the circle from the width and height\nexport const getCircleRadius = (width: number, height: number) =>\n  Math.min(Math.abs(width), Math.abs(height)) / 2\n\n// Detects if a click is made on the fold\nexport const checkIsAtMultiplexSegment = (segments: Segments, rp: Rp) => {\n  let res = false\n  segments.forEach((seg) => {\n    if (res) return\n    if (checkIsAtSegment(rp.x, rp.y, ...seg, CLICK_DISTANCE)) {\n      res = true\n    }\n  })\n  return res\n}\n\n// Calculate the radius of the circle from the width and height\nexport const checkIsAtCircleEdge = (node: any, rp: Rp) => {\n  const { width, height, x, y } = node as Node\n  const radius = getCircleRadius(width, height)\n  const dis = getTowCoordinateDistance(rp.x, rp.y, x + radius, y + radius)\n  const onCircle =\n    dis >= radius - CLICK_DISTANCE && dis <= radius + CLICK_DISTANCE\n  return onCircle ? node : null\n}\n\n// Detects if you click on the edge of a rectangle\nexport const checkIsAtRectangleEdge = (node: any, rp: Rp) => {\n  const { x, y, width, height } = node as Node\n  const segments: Segments = [\n    [x, y, x + width, y],\n    [x + width, y, x + width, y + height],\n    [x + width, y + height, x, y + height],\n    [x, y + height, x, y]\n  ]\n  return checkIsAtMultiplexSegment(segments, rp) ? node : null\n}\n\n// Detects if a triangle edge is clicked on\nexport const checkIsAtTriangleEdge = (node: Node, rp: Rp) => {\n  const { x, y, width, height } = node\n  const segments = [\n    [x + width / 2, y, x + width, y + height],\n    [x + width, y + height, x, y + height],\n    [x, y + height, x + width / 2, y]\n  ]\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n\n// Detects if a diamond edge is clicked on\nexport const checkIsAtDiamondEdge = (node: any, rp: Rp) => {\n  const { x, y, width, height } = node as Node\n  const segments = [\n    [x + width / 2, y, x + width, y + height / 2],\n    [x + width, y + height / 2, x + width / 2, y + height],\n    [x + width / 2, y + height, x, y + height / 2],\n    [x, y + height / 2, x + width / 2, y]\n  ]\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n\n// Detects if you click on the edge of the arrow\nexport const checkIsAtArrowEdge = (node: any, rp: Rp) => {\n  const { coordinateArr } = node as Node\n  if (typeof coordinateArr === 'undefined') {\n    return null\n  }\n  const x = coordinateArr[0][0]\n  const y = coordinateArr[0][1]\n  const tx = coordinateArr[coordinateArr.length - 1][0]\n  const ty = coordinateArr[coordinateArr.length - 1][1]\n  const segments = [[x, y, tx, ty]]\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n\n// Detects if a click is made on the edge of a free line segment\nexport const checkIsAtArbitraryPlotLineEdge = (node: Node, rp: Rp) => {\n  let res: Node | null = null\n  if (typeof node.coordinateArr === 'undefined') {\n    return null\n  }\n  node.coordinateArr.forEach((coordinate) => {\n    if (res) return\n    const dis = getTowCoordinateDistance(\n      rp.x,\n      rp.y,\n      coordinate[0],\n      coordinate[1]\n    )\n    if (dis <= CLICK_DISTANCE) {\n      res = node\n    }\n  })\n  return res\n}\n\n// Detects if a click is made on the edge of a line segment\nexport const checkIsAtLineEdge = (node: Node, rp: Rp) => {\n  const segments = []\n  if (typeof node.coordinateArr === 'undefined') {\n    return null\n  }\n  const len = node.coordinateArr.length\n  const arr = node.coordinateArr\n  for (let i = 0; i < len - 1; i += 1) {\n    segments.push([...arr[i], ...arr[i + 1]])\n  }\n  return checkIsAtMultiplexSegment(segments as Segments, rp) ? node : null\n}\n","import EventEmitter from 'eventemitter3'\n\nimport {\n  createNodeKey,\n  degToRad,\n  getNodeFourCorners,\n  getRotatedCoordinate\n} from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class BaseNode extends EventEmitter {\n  public app: AppObject\n\n  public id: string\n\n  public type: string\n\n  public key: number\n\n  public isCreate: boolean\n\n  public isActive: boolean\n\n  public isSelected: boolean\n\n  public startX: number\n\n  public startY: number\n\n  x: number\n\n  y: number\n\n  width: number\n\n  height: number\n\n  public startRotate: number\n\n  public rotate: number\n\n  public noRender: boolean\n\n  public style: any\n\n  dragNode: any\n\n  constructor(options: any, app: AppObject) {\n    super()\n    this.app = app\n    // Graphical object id\n    this.id = options.id\n    // Type\n    this.type = options.type || ''\n    // key\n    this.key = createNodeKey()\n    // Is it being created\n    this.isCreate = true\n    // Activated or not\n    this.isActive = true\n    // Whether selected by multiple choice\n    this.isSelected = false\n    // Record initial position for use when dragging\n    this.startX = 0\n    this.startY = 0\n    // Real-time position, which is the coordinate of the upper left corner of the graphic object\n    this.x = options.x || 0\n    this.y = options.y || 0\n    // Width and height\n    this.width = options.width || 0\n    this.height = options.height || 0\n    // Records the initial angle for use when rotating\n    this.startRotate = 0\n    // Angle\n    this.rotate = options.rotate || 0\n    // Does not need to be rendered\n    this.noRender = false\n    // style\n    this.style = {\n      strokeStyle: this.app.state.defaultColor,\n      fillStyle: 'transparent',\n      lineWidth: 2,\n      lineDash: 0,\n      globalAlpha: 1,\n      ...(options.style || {})\n    }\n    // Example of dragging and dropping a graphic object\n    this.dragNode = undefined\n  }\n\n  // Detects if a graphic object has been hit\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  isClick(x: number, y: number) {\n    throw new Error('Subclasses need to implement this method!')\n  }\n\n  // Offsetting the angle of a graphic object\n  offsetRotate(or: number) {\n    this.updateRotate(this.startRotate + or)\n    return this\n  }\n\n  // Setting the drawing style\n  setStyle(style = {}) {\n    const _style = style as any\n    Object.keys(_style).forEach((key) => {\n      if (key === 'lineDash') {\n        if (_style.lineDash > 0) {\n          this.app.ctx.setLineDash([_style.lineDash])\n        }\n      } else if (\n        _style[key] !== undefined &&\n        _style[key] !== '' &&\n        _style[key] !== null\n      ) {\n        // @ts-ignore\n        this.app.ctx[key] = _style[key]\n      }\n    })\n    return this\n  }\n\n  // Public rendering operations\n  warpRender(renderFn: any) {\n    const { x, y, width, height, rotate, style } = this\n    const { x: tx, y: ty } = this.app.calculate.transform(x, y)\n    const halfWidth = width / 2\n    const halfHeight = height / 2\n    const cx = tx + halfWidth\n    const cy = ty + halfHeight\n    this.app.ctx.save()\n    this.app.ctx.translate(cx, cy)\n    this.app.ctx.rotate(degToRad(rotate))\n    this.setStyle(style)\n    renderFn({\n      halfWidth,\n      halfHeight,\n      tx,\n      ty,\n      cx,\n      cy\n    })\n    this.app.ctx.restore()\n    return this\n  }\n\n  // Save the initial state of the graphic object\n  saveState() {\n    const { rotate, x, y } = this\n    this.startRotate = rotate\n    this.startX = x\n    this.startY = y\n    return this\n  }\n\n  // Moving graphic objects\n  move(ox: number, oy: number) {\n    const { startX, startY } = this\n    this.x = startX + ox\n    this.y = startY + oy\n    this.emit('nodePositionChange', this.x, this.y)\n    return this\n  }\n\n  // Updating the angle of a graphic object\n  updateRotate(rotate: number) {\n    rotate %= 360\n    if (rotate < 0) {\n      rotate = 360 + rotate\n    }\n    this.rotate = rotate\n    this.emit('nodeRotateChange', this.rotate)\n  }\n\n  // Rotate the individual coordinates of a graphic object according to the specified centre coordinates\n  rotateByCenter(rotate: number, cx: number, cy: number) {\n    this.offsetRotate(rotate)\n    const np = getRotatedCoordinate(this.startX, this.startY, cx, cy, rotate)\n    this.updatePos(np.x, np.y)\n  }\n\n  // Start adjusting graphic objects\n  startResize(resizeType: string, e: any) {\n    this.dragNode.startResize(resizeType, e)\n    return this\n  }\n\n  // Ending the adjustment of graphic objects\n  endResize() {\n    this.dragNode.endResize()\n    return this\n  }\n\n  // Adjustment in graphic objects\n  resize(...args: any[]) {\n    this.dragNode.handleResizeNode(...args)\n    return this\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    return getNodeFourCorners(this as any)\n  }\n\n  // Update graphic object enclosures\n  updateRect(x: number, y: number, width: number, height: number) {\n    this.updatePos(x, y)\n    this.updateSize(width, height)\n    return this\n  }\n\n  // Update activation of graphic object sizes\n  updateSize(width: number, height: number) {\n    this.width = width\n    this.height = height\n    this.emit('nodeSizeChange', this.width, this.height)\n    return this\n  }\n\n  // Update coordinates of active graphic objects\n  updatePos(x: number, y: number) {\n    this.x = x\n    this.y = y\n    this.emit('nodePositionChange', this.x, this.y)\n    return this\n  }\n\n  // Serialisation\n  serialize() {\n    return {\n      id: this.id,\n      type: this.type,\n      width: this.width,\n      height: this.height,\n      x: this.x,\n      y: this.y,\n      rotate: this.rotate,\n      style: {\n        ...this.style\n      }\n    }\n  }\n\n  // Rendering drag-and-drop graphic objects\n  renderDragNode() {\n    if (this.isActive && !this.isCreate) {\n      this.dragNode.showAll()\n      this.dragNode.render()\n    } else if (this.isSelected) {\n      // Selected by multiple choice\n      this.dragNode.onlyShowBody()\n      this.dragNode.render()\n    }\n  }\n\n  // Rendering methods, which need to be implemented\n  render() {\n    throw new Error('Subclasses need to implement this method！')\n  }\n}\n","import {\n  deepCopy,\n  getBoundingRect,\n  getNodeCenterCoordinate,\n  getRotatedCoordinate\n} from '../common/utils'\nimport { AppObject } from '../types'\nimport BaseNode from './BaseNode'\n\nexport default class BaseMultiplexCoordinateNode extends BaseNode {\n  public startCoordinateArr: any[]\n\n  public coordinateArr: any\n\n  public startWidth: number | undefined\n\n  public startHeight: number | undefined\n\n  public fictitiousCoordinate: { x: number; y: number }\n\n  constructor(opts: any, app: AppObject) {\n    super(opts, app)\n    // Record initial coordinates when dragging\n    this.startCoordinateArr = []\n    // Coordinates\n    this.coordinateArr = opts.coordinateArr || []\n    // Record initial size for use when scaling\n    this.startWidth = 0\n    this.startHeight = 0\n    // The current live position of the mouse, used to display the virtual line from the last coordinate of the line segment to the current mouse when drawing\n    this.fictitiousCoordinate = {\n      x: 0,\n      y: 0\n    }\n  }\n\n  // Update graphic object enclosures\n  updateRect(x: number, y: number, width: number, height: number) {\n    const { startWidth, startHeight, startCoordinateArr } = this\n    if (\n      typeof startWidth === 'undefined' ||\n      typeof startHeight === 'undefined'\n    ) {\n      return this\n    }\n    const scaleX = width / startWidth\n    const scaleY = height / startHeight\n    this.coordinateArr = startCoordinateArr.map((coordinate) => {\n      const nx = coordinate[0] * scaleX\n      const ny = coordinate[1] * scaleY\n      return [nx, ny, ...coordinate.slice(2)]\n    })\n    const rect: any = getBoundingRect(this.coordinateArr)\n    const offsetX = rect.x - x\n    const offsetY = rect.y - y\n    this.coordinateArr = this.coordinateArr.map(\n      (coordinate: string | any[]) => [\n        coordinate[0] - offsetX,\n        coordinate[1] - offsetY,\n        ...coordinate.slice(2)\n      ]\n    )\n    this.updatePos(x, y)\n    this.updateSize(width, height)\n    return this\n  }\n\n  // Rotate the individual coordinates of a graphic object according to the specified centre coordinates\n  rotateByCenter(rotate: number, cx: number, cy: number) {\n    this.coordinateArr = this.startCoordinateArr.map((coordinate) => {\n      const np = getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        cx,\n        cy,\n        rotate\n      )\n      return [np.x, np.y, ...coordinate.slice(2)]\n    })\n    this.updateMultiplexCoordinateBoundingRect()\n  }\n\n  // Serialisation\n  serialize() {\n    const base = super.serialize()\n    return {\n      ...base,\n      coordinateArr: [...this.coordinateArr]\n    }\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    return this.coordinateArr.map((coordinate: number[]) => {\n      const center = getNodeCenterCoordinate(this as any)\n      const np = getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        center.x,\n        center.y,\n        this.rotate as number\n      )\n      return {\n        x: np.x,\n        y: np.y\n      }\n    })\n  }\n\n  // Adding coordinates, graphs with multiple coordinate data, e.g. line segments, free lines\n  addCoordinate(x: number, y: number, ...args: any[]) {\n    if (!Array.isArray(this.coordinateArr)) {\n      return undefined\n    }\n    this.coordinateArr.push([x, y, ...args])\n    return this\n  }\n\n  // Update of graphical object enclosures for graphs with multiple coordinate data\n  updateMultiplexCoordinateBoundingRect() {\n    const rect: any = getBoundingRect(this.coordinateArr)\n    this.x = rect.x\n    this.y = rect.y\n    this.width = rect.width\n    this.height = rect.height\n    return this\n  }\n\n  // Update virtual coordinates coordinates\n  updateFictitiousCoordinate(x: number, y: number) {\n    this.fictitiousCoordinate.x = x\n    this.fictitiousCoordinate.y = y\n  }\n\n  // Moving graphic objects\n  move(ox: number, oy: number) {\n    this.coordinateArr = this.startCoordinateArr.map((coordinate) => [\n      coordinate[0] + ox,\n      coordinate[1] + oy,\n      ...coordinate.slice(2)\n    ])\n    const { startX, startY } = this\n    if (startX && startY) {\n      this.x = startX + ox\n      this.y = startY + oy\n    }\n    return this\n  }\n\n  // Save the initial state of the graphic object\n  saveState() {\n    const { rotate, x, y, width, height, coordinateArr } = this\n    this.startRotate = rotate\n    this.startX = x\n    this.startY = y\n    this.startCoordinateArr = deepCopy(coordinateArr)\n    this.startWidth = width\n    this.startHeight = height\n    return this\n  }\n}\n","import {\n  degToRad,\n  getFontString,\n  radToDeg,\n  splitTextLines\n} from '../common/utils'\nimport { Ctx } from '../types'\n\n// Drawing public operations\nexport const plotWrap = (ctx: Ctx, fn: any, fill = false) => {\n  ctx.beginPath()\n  fn()\n  ctx.stroke()\n  if (fill) {\n    ctx.fill()\n  }\n}\n\n// Drawing circle\nexport const plotCircle = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  r: number,\n  fill = false\n) => {\n  plotWrap(\n    ctx,\n    () => {\n      ctx.arc(x, y, r, 0, 2 * Math.PI)\n    },\n    fill\n  )\n}\n\n// Drawing arrows\nexport const plotArrow = (ctx: Ctx, coordinateArr: any[]) => {\n  const x = coordinateArr[0][0]\n  const y = coordinateArr[0][1]\n  const tx = coordinateArr[coordinateArr.length - 1][0]\n  const ty = coordinateArr[coordinateArr.length - 1][1]\n  plotWrap(\n    ctx,\n    () => {\n      ctx.moveTo(x, y)\n      ctx.lineTo(tx, ty)\n    },\n    true\n  )\n  const l = 30\n  const deg = 30\n  const lineDeg = radToDeg(Math.atan2(ty - y, tx - x))\n  plotWrap(\n    ctx,\n    () => {\n      const plusDeg = deg - lineDeg\n      const _x = tx - l * Math.cos(degToRad(plusDeg))\n      const _y = ty + l * Math.sin(degToRad(plusDeg))\n      ctx.moveTo(_x, _y)\n      ctx.lineTo(tx, ty)\n    },\n    true\n  )\n  plotWrap(ctx, () => {\n    const plusDeg = 90 - lineDeg - deg\n    const _x = tx - l * Math.sin(degToRad(plusDeg))\n    const _y = ty - l * Math.cos(degToRad(plusDeg))\n    ctx.moveTo(_x, _y)\n    ctx.lineTo(tx, ty)\n  })\n}\n\n// Drawing rectangles\nexport const plotRect = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  fill = false\n) => {\n  plotWrap(ctx, () => {\n    ctx.rect(x, y, width, height)\n    if (fill) {\n      ctx.fillRect(x, y, width, height)\n    }\n  })\n}\n\n// Drawing a diamond\nexport const plotDiamond = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  fill = false\n) => {\n  plotWrap(\n    ctx,\n    () => {\n      ctx.moveTo(x + width / 2, y)\n      ctx.lineTo(x + width, y + height / 2)\n      ctx.lineTo(x + width / 2, y + height)\n      ctx.lineTo(x, y + height / 2)\n      ctx.closePath()\n    },\n    fill\n  )\n}\n\n// Convert the coordinates of the brush to the coordinates of the canvas\nconst transformArbitraryLineCoordinate = (\n  coordinate: string | any[],\n  opt: {\n    app: {\n      calculate: { transform: (arg0: any, arg1: any) => { x: any; y: any } }\n    }\n    cx: number\n    cy: number\n  }\n) => {\n  const { x, y } = opt.app.calculate.transform(coordinate[0], coordinate[1])\n  return [x - opt.cx, y - opt.cy, ...coordinate.slice(2)]\n}\n\n// Drawing line segments\nexport const plotLineSegment = (\n  ctx: Ctx,\n  mx: number,\n  my: number,\n  tx: number,\n  ty: number,\n  lineWidth = 0\n) => {\n  plotWrap(ctx, () => {\n    if (lineWidth > 0) {\n      ctx.lineWidth = lineWidth\n    }\n    ctx.moveTo(mx, my)\n    ctx.lineTo(tx, ty)\n    ctx.lineCap = 'round'\n    ctx.lineJoin = 'round'\n  })\n}\n\n// Drawing triangles\nexport const plotTriangle = (\n  ctx: Ctx,\n  x: number,\n  y: number,\n  width: number,\n  height: any,\n  fill = false\n) => {\n  plotWrap(\n    ctx,\n    () => {\n      ctx.moveTo(x + width / 2, y)\n      ctx.lineTo(x + width, y + height)\n      ctx.lineTo(x, y + height)\n      ctx.closePath()\n    },\n    fill\n  )\n}\n\n// Drawing free line segments (Also known as a paintbrush)\nexport const plotArbitraryLine = (\n  ctx: Ctx,\n  coordinates: string | any[],\n  opt: any\n) => {\n  for (let i = 0; i < coordinates.length - 1; i += 1) {\n    plotWrap(\n      ctx,\n      () => {\n        const coordinate = transformArbitraryLineCoordinate(coordinates[i], opt)\n        const nextCoordinate = transformArbitraryLineCoordinate(\n          coordinates[i + 1],\n          opt\n        )\n        plotLineSegment(\n          ctx,\n          coordinate[0],\n          coordinate[1],\n          nextCoordinate[0],\n          nextCoordinate[1],\n          nextCoordinate[2]\n        )\n      },\n      true\n    )\n  }\n}\n\n// Drawing text\nexport const plotText = (ctx: Ctx, textObj: any, x: number, y: number) => {\n  const { text, style } = textObj\n  const lineHeight = style.fontSize * style.lineHeightRatio\n  plotWrap(ctx, () => {\n    ctx.font = getFontString(style.fontSize, style.fontFamily)\n    ctx.textBaseline = 'middle'\n    const textArr = splitTextLines(text)\n    textArr.forEach((textRow, index) => {\n      ctx.fillText(textRow, x, y + (index * lineHeight + lineHeight / 2))\n    })\n  })\n}\n\n// Drawing pictures\nexport const plotImage = (\n  ctx: Ctx,\n  node: any,\n  x: number,\n  y: number,\n  width: number,\n  height: number\n) => {\n  plotWrap(ctx, () => {\n    const ratio = width / height\n    let showWidth = 0\n    let showHeight = 0\n    if (ratio > node.ratio) {\n      showHeight = height\n      showWidth = node.ratio * height\n    } else {\n      showWidth = width\n      showHeight = width / node.ratio\n    }\n    ctx.drawImage(node.imageObj, x, y, showWidth, showHeight)\n  })\n}\n\n// Draw the line\nexport const plotLine = (ctx: Ctx, coordinates: any[]) => {\n  plotWrap(ctx, () => {\n    let first = true\n    coordinates.forEach((coordinate) => {\n      if (first) {\n        first = false\n        ctx.moveTo(coordinate[0], coordinate[1])\n      } else {\n        ctx.lineTo(coordinate[0], coordinate[1])\n      }\n    })\n  })\n}\n","import { DRAG_NODE_PARTS, FOUR_CORNER } from '../common/constants'\nimport {\n  checkCoordinateIsInRectangle,\n  getNodeCenterCoordinate,\n  getNodeRotatedFourCornerCoordinate,\n  getRotatedCoordinate,\n  getTowCoordinateDistance,\n  getTowCoordinateRotate,\n  transformCoordinateOnNode,\n  transformCoordinateReverseRotate\n} from '../common/utils'\nimport { AppObject, Node } from '../types'\nimport BaseNode from './BaseNode'\nimport { plotCircle, plotRect } from './plot'\n\nexport default class DragNode extends BaseNode {\n  public options: Node\n\n  public node: any\n\n  public offset: number\n\n  public size: number\n\n  public resizeType: string\n\n  public diagonalCoordinate: { x: number; y: number }\n\n  public mousedownPosAndNodePosOffset: { x: number; y: number }\n\n  public nodeRatio: number\n\n  public hideParts: any[]\n\n  constructor(node: any, app: AppObject, options = {}) {\n    super(\n      {\n        type: 'dragNode',\n        notNeedDragNode: true\n      },\n      app\n    )\n\n    // @ts-ignore\n    this.options = {\n      lockRatio: false,\n      ...options\n    }\n\n    this.style = {\n      strokeStyle: '#666',\n      fillStyle: 'transparent',\n      lineWidth: 'small',\n      lineDash: 0,\n      globalAlpha: 1\n    }\n\n    // Attribution Nodes\n    this.node = node\n\n    // Distance to graphic objects\n    this.offset = 5\n\n    // Drag handle size\n    this.size = 10\n\n    // What adjustment operation is currently in progress\n    this.resizeType = ''\n\n    // Diagonal coordinates of the coordinates of the graphical object currently dragged with the mouse held down\n    this.diagonalCoordinate = {\n      x: 0,\n      y: 0\n    }\n\n    // The difference between the coordinates of the current mouse press and the coordinates of the dragged graphic object\n    this.mousedownPosAndNodePosOffset = {\n      x: 0,\n      y: 0\n    }\n\n    // Aspect ratio of graphical objects\n    this.nodeRatio = 0\n\n    // The hidden part\n    this.hideParts = []\n\n    this.x = 0\n    this.y = 0\n  }\n\n  // Start adjusting graphic objects\n  // @ts-ignore\n  startResize(resizeType: string, e: any) {\n    this.resizeType = resizeType\n    if (this.options.lockRatio) {\n      this.nodeRatio = this.node.width / this.node.height\n    }\n    if (resizeType === DRAG_NODE_PARTS.BODY) {\n      this.node.saveState()\n    } else if (resizeType === DRAG_NODE_PARTS.ROTATE) {\n      this.node.saveState()\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_LEFT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.TOP_LEFT)\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_RIGHT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.TOP_RIGHT)\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.BOTTOM_RIGHT)\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON) {\n      this.handleDragMousedown(e, FOUR_CORNER.BOTTOM_LEFT)\n    }\n  }\n\n  // Ending the adjustment of graphic objects\n  // @ts-ignore\n  endResize() {\n    this.resizeType = ''\n    this.diagonalCoordinate = {\n      x: 0,\n      y: 0\n    }\n    this.mousedownPosAndNodePosOffset = {\n      x: 0,\n      y: 0\n    }\n    this.nodeRatio = 0\n  }\n\n  // Handling of four retractable handle events for dragging graphic objects by pressing\n  handleDragMousedown(e: { clientX: number; clientY: number }, corner: string) {\n    const centerPos = getNodeCenterCoordinate(this.node)\n    const pos: any = getNodeRotatedFourCornerCoordinate(this.node, corner)\n    this.diagonalCoordinate.x = 2 * centerPos.x - pos.x\n    this.diagonalCoordinate.y = 2 * centerPos.y - pos.y\n    this.mousedownPosAndNodePosOffset.x = e.clientX - pos.x\n    this.mousedownPosAndNodePosOffset.y = e.clientY - pos.y\n    this.node.saveState()\n  }\n\n  // Adjusting graphic objects\n  handleResizeNode(\n    e: any,\n    mx: number,\n    my: number,\n    offsetX: number,\n    offsetY: number\n  ) {\n    const { resizeType } = this\n    if (resizeType === DRAG_NODE_PARTS.BODY) {\n      this.handleMoveNode(offsetX, offsetY)\n    } else if (resizeType === DRAG_NODE_PARTS.ROTATE) {\n      this.handleRotateNode(e, mx, my)\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_LEFT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (newCenter.x - rp.x) * 2,\n          height: (newCenter.y - rp.y) * 2\n        }),\n        (rp: { x: any; y: any }) => ({\n          x: rp.x,\n          y: rp.y\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; width?: any; height?: any; y?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + newRect.width - this.nodeRatio * newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            y = newRect.y + (newRect.height - newRect.width / this.nodeRatio)\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    } else if (resizeType === DRAG_NODE_PARTS.TOP_RIGHT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (rp.x - newCenter.x) * 2,\n          height: (newCenter.y - rp.y) * 2\n        }),\n        (rp: { x: number; y: any }, newSize: { width: number }) => ({\n          x: rp.x - newSize.width,\n          y: rp.y\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; height?: any; width?: any; y?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + this.nodeRatio * newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            x = newRect.x + newRect.width\n            y = newRect.y + (newRect.height - newRect.width / this.nodeRatio)\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (rp.x - newCenter.x) * 2,\n          height: (rp.y - newCenter.y) * 2\n        }),\n        (\n          rp: { x: number; y: number },\n          newSize: { width: number; height: number }\n        ) => ({\n          x: rp.x - newSize.width,\n          y: rp.y - newSize.height\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; height?: any; y?: any; width?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + this.nodeRatio * newRect.height\n            y = newRect.y + newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            x = newRect.x + newRect.width\n            y = newRect.y + newRect.width / this.nodeRatio\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    } else if (resizeType === DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON) {\n      this.handleStretchNode(\n        e,\n        (\n          newCenter: { x: number; y: number },\n          rp: { x: number; y: number }\n        ) => ({\n          width: (newCenter.x - rp.x) * 2,\n          height: (rp.y - newCenter.y) * 2\n        }),\n        (rp: { x: number; y: number }, newSize: { height: number }) => ({\n          x: rp.x,\n          y: rp.y - newSize.height\n        }),\n        (\n          newRatio: number,\n          newRect: { x?: any; width?: any; height?: any; y?: any }\n        ) => {\n          let { x } = newRect\n          let { y } = newRect\n          if (newRatio > this.nodeRatio) {\n            x = newRect.x + newRect.width - this.nodeRatio * newRect.height\n            y = newRect.y + newRect.height\n          } else if (newRatio < this.nodeRatio) {\n            y = newRect.y + newRect.width / this.nodeRatio\n          }\n          return {\n            x,\n            y\n          }\n        }\n      )\n    }\n  }\n\n  // Move the graphic object as a whole\n  handleMoveNode(offsetX: number, offsetY: number) {\n    this.node.move(offsetX, offsetY)\n  }\n\n  // Rotating graphic objects\n  handleRotateNode(\n    e: { clientX: number; clientY: number },\n    mx: number,\n    my: number\n  ) {\n    const centerPos = getNodeCenterCoordinate(this.node)\n    const rotate = getTowCoordinateRotate(\n      centerPos.x,\n      centerPos.y,\n      e.clientX,\n      e.clientY,\n      mx,\n      my\n    )\n    this.node.offsetRotate(rotate)\n  }\n\n  // Set the hidden section\n  setHideParts(parts = []) {\n    this.hideParts = parts\n  }\n\n  // Show all sections\n  showAll() {\n    this.setHideParts([])\n  }\n\n  // Only the main part is displayed\n  onlyShowBody() {\n    this.setHideParts([\n      DRAG_NODE_PARTS.ROTATE,\n      DRAG_NODE_PARTS.TOP_LEFT_BUTTON,\n      DRAG_NODE_PARTS.TOP_RIGHT_BUTTON,\n      DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON,\n      DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON\n    ] as any)\n  }\n\n  // Update data\n  update() {\n    this.x = this.node.x - this.offset\n    this.y = this.node.y - this.offset\n    this.width = this.node.width + this.offset * 2\n    this.height = this.node.height + this.offset * 2\n    this.rotate = this.node.rotate\n  }\n\n  // Scaling calculations\n  stretchCalc(\n    x: number,\n    y: number,\n    calcSize: (\n      arg0: { x: number; y: number },\n      arg1: { x: number; y: number }\n    ) => any,\n    calcPos: (arg0: { x: number; y: number }, arg1: any) => any\n  ) {\n    const newCenter = {\n      x: (x + this.diagonalCoordinate.x) / 2,\n      y: (y + this.diagonalCoordinate.y) / 2\n    }\n    const rp = transformCoordinateReverseRotate(\n      x,\n      y,\n      newCenter.x,\n      newCenter.y,\n      this.node.rotate\n    )\n    const newSize = calcSize(newCenter, rp)\n    let isWidthReverse = false\n    if (newSize.width < 0) {\n      newSize.width = 0\n      isWidthReverse = true\n    }\n    let isHeightReverse = false\n    if (newSize.height < 0) {\n      newSize.height = 0\n      isHeightReverse = true\n    }\n    const newPos = calcPos(rp, newSize)\n    const newRect = {\n      x: newPos.x,\n      y: newPos.y,\n      width: newSize.width,\n      height: newSize.height\n    }\n    if (isWidthReverse || isHeightReverse) {\n      newRect.x = this.node.x\n      newRect.y = this.node.y\n    }\n    return {\n      newRect,\n      newCenter\n    }\n  }\n\n  // Stretching graphic objects\n  handleStretchNode(\n    e: { clientX: number; clientY: number },\n    calcSize: any,\n    calcPos: any,\n    fixPos: any\n  ) {\n    const actClientX = e.clientX - this.mousedownPosAndNodePosOffset.x\n    const actClientY = e.clientY - this.mousedownPosAndNodePosOffset.y\n    const { newRect, newCenter } = this.stretchCalc(\n      actClientX,\n      actClientY,\n      calcSize,\n      calcPos\n    )\n    if (this.options.lockRatio) {\n      this.fixStretch(newRect, newCenter, calcSize, calcPos, fixPos)\n      return\n    }\n    this.node.updateRect(newRect.x, newRect.y, newRect.width, newRect.height)\n  }\n\n  // Correction of new graphics when aspect ratio is locked\n  fixStretch(\n    newRect: { x?: any; y?: any; width: any; height: any },\n    newCenter: { x: any; y: any },\n    calcSize: {\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (newCenter: { x: number; y: number }, rp: { x: number; y: number }): {\n        width: number\n        height: number\n      }\n      (arg0: { x: number; y: number }, arg1: { x: number; y: number }): any\n      (arg0: { x: number; y: number }, arg1: { x: number; y: number }): any\n    },\n    calcPos: {\n      (rp: { x: any; y: any }): { x: any; y: any }\n      (rp: { x: number; y: any }, newSize: { width: number }): {\n        x: number\n        y: any\n      }\n      (\n        rp: { x: number; y: number },\n        newSize: { width: number; height: number }\n      ): { x: number; y: number }\n      (rp: { x: number; y: number }, newSize: { height: number }): {\n        x: number\n        y: number\n      }\n      (arg0: { x: number; y: number }, arg1: any): any\n      (arg0: { x: number; y: number }, arg1: any): any\n    },\n    fixPos: {\n      (\n        newRatio: number,\n        newRect: { x?: any; width?: any; height?: any; y?: any }\n      ): { x: any; y: any }\n      (\n        newRatio: number,\n        newRect: { x?: any; height?: any; width?: any; y?: any }\n      ): { x: any; y: any }\n      (\n        newRatio: number,\n        newRect: { x?: any; height?: any; y?: any; width?: any }\n      ): { x: any; y: any }\n      (\n        newRatio: number,\n        newRect: { x?: any; width?: any; height?: any; y?: any }\n      ): { x: any; y: any }\n      (arg0: number, arg1: any): any\n    }\n  ) {\n    const newRatio = newRect.width / newRect.height\n    const fp = fixPos(newRatio, newRect)\n    const rp = getRotatedCoordinate(\n      fp.x,\n      fp.y,\n      newCenter.x,\n      newCenter.y,\n      this.node.rotate\n    )\n    const fixNewRect = this.stretchCalc(rp.x, rp.y, calcSize, calcPos).newRect\n    if (fixNewRect.width === 0 && fixNewRect.height === 0) {\n      return\n    }\n    this.node.updateRect(\n      fixNewRect.x,\n      fixNewRect.y,\n      fixNewRect.width,\n      fixNewRect.height\n    )\n  }\n\n  render() {\n    this.update()\n    const { width, height } = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      this.app.ctx.save()\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.BODY)) {\n        this.app.ctx.setLineDash([5])\n        plotRect(this.app.ctx, -halfWidth, -halfHeight, width, height)\n        this.app.ctx.restore()\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.TOP_LEFT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth - this.size,\n          -halfHeight - this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.TOP_RIGHT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth + this.node.width + this.size,\n          -halfHeight - this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth + this.node.width + this.size,\n          -halfHeight + this.node.height + this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON)) {\n        plotRect(\n          this.app.ctx,\n          -halfWidth - this.size,\n          -halfHeight + this.node.height + this.size,\n          this.size,\n          this.size\n        )\n      }\n      if (!this.hideParts.includes(DRAG_NODE_PARTS.ROTATE)) {\n        plotCircle(\n          this.app.ctx,\n          -halfWidth + this.node.width / 2 + this.size / 2,\n          -halfHeight - this.size * 2,\n          this.size\n        )\n      }\n    })\n  }\n\n  // Detects which part of a dragged graphic object a coordinate is on\n  checkCoordinateInDragNodeWhere(x: number, y: number) {\n    let part = ''\n    const rp = transformCoordinateOnNode(x, y, this.node)\n    if (checkCoordinateIsInRectangle(rp.x, rp.y, this as any)) {\n      part = DRAG_NODE_PARTS.BODY\n    } else if (\n      getTowCoordinateDistance(\n        rp.x,\n        rp.y,\n        this.x + this.width / 2,\n        this.y - this.size * 2\n      ) <= this.size\n    ) {\n      part = DRAG_NODE_PARTS.ROTATE\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.TOP_LEFT)\n    ) {\n      part = DRAG_NODE_PARTS.TOP_LEFT_BUTTON\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.TOP_RIGHT)\n    ) {\n      part = DRAG_NODE_PARTS.TOP_RIGHT_BUTTON\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.BOTTOM_RIGHT)\n    ) {\n      part = DRAG_NODE_PARTS.BOTTOM_RIGHT_BUTTON\n    } else if (\n      this._checkCoordinateIsInButton(rp.x, rp.y, FOUR_CORNER.BOTTOM_LEFT)\n    ) {\n      part = DRAG_NODE_PARTS.BOTTOM_LEFT_BUTTON\n    }\n    if (this.hideParts.includes(part)) {\n      part = ''\n    }\n    return part\n  }\n\n  // Detects if the coordinates are within a drag and drop button\n  _checkCoordinateIsInButton(x: number, y: number, dir: string) {\n    let _x = 0\n    let _y = 0\n    switch (dir) {\n      case FOUR_CORNER.TOP_LEFT:\n        _x = this.x - this.size\n        _y = this.y - this.size\n        break\n      case FOUR_CORNER.TOP_RIGHT:\n        _x = this.x + this.width\n        _y = this.y - this.size\n        break\n      case FOUR_CORNER.BOTTOM_RIGHT:\n        _x = this.x + this.width\n        _y = this.y + this.height\n        break\n      case FOUR_CORNER.BOTTOM_LEFT:\n        _x = this.x - this.size\n        _y = this.y + this.height\n        break\n      default:\n        break\n    }\n    return checkCoordinateIsInRectangle(x, y, _x, _y, this.size, this.size)\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtArbitraryPlotLineEdge } from '../common/utils/checkClick'\nimport BaseMultiplexCoordinateNode from '../support/BaseMultiplexCoordinateNode'\nimport DragNode from '../support/DragNode'\nimport { plotArbitraryLine, plotLineSegment } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class ArbitraryPlot extends BaseMultiplexCoordinateNode {\n  public lastLineWidth: number\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n\n    // The third number of the coordinates [x,y,speed] is the line width\n    this.lastLineWidth = -1\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtArbitraryPlotLineEdge(this as any, rp)\n  }\n\n  // Rendering of a single line segment\n  singleRender(\n    mx: number,\n    my: number,\n    tx: number,\n    ty: number,\n    lineWidth: number | undefined\n  ) {\n    this.app.ctx.save()\n    plotLineSegment(this.app.ctx, mx, my, tx, ty, lineWidth)\n    this.app.ctx.restore()\n  }\n\n  render() {\n    const { coordinateArr }: any = this\n    this.warpRender(({ cx, cy }: any) => {\n      plotArbitraryLine(this.app.ctx, coordinateArr, {\n        app: this.app,\n        cx,\n        cy\n      })\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtArrowEdge } from '../common/utils/checkClick'\nimport BaseMultiplexCoordinateNode from '../support/BaseMultiplexCoordinateNode'\nimport DragNode from '../support/DragNode'\nimport { plotArrow } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Arrow extends BaseMultiplexCoordinateNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, app)\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtArrowEdge(this, rp)\n  }\n\n  render() {\n    const { coordinateArr, fictitiousCoordinate }: any = this\n    this.warpRender(({ cx, cy }: { cx: number; cy: number }) => {\n      // Plus the current live position of the mouse\n      let realtimeCoordinate: any[][] = []\n      if (coordinateArr.length > 0 && this.isCreate) {\n        const { x: fx, y: fy } = this.app.calculate.transform(\n          fictitiousCoordinate.x - cx,\n          fictitiousCoordinate.y - cy\n        )\n        realtimeCoordinate = [[fx, fy]]\n      }\n      plotArrow(\n        this.app.ctx,\n        coordinateArr\n          .map((coordinate: any[]) => {\n            const { x, y } = this.app.calculate.transform(\n              coordinate[0],\n              coordinate[1]\n            )\n            return [x - cx, y - cy]\n          })\n          .concat(realtimeCoordinate)\n      )\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport {\n  checkIsAtCircleEdge,\n  getCircleRadius\n} from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotCircle } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Circle extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app, {\n      lockRatio: true\n    })\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtCircleEdge(this, rp)\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(() => {\n      plotCircle(this.app.ctx, 0, 0, getCircleRadius(width, height), true)\n    })\n    this.renderDragNode()\n  }\n}\n","import {\n  getNodeCenterCoordinate,\n  getRotatedCoordinate,\n  transformCoordinateOnNode\n} from '../common/utils'\nimport { checkIsAtDiamondEdge } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotDiamond } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Diamond extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtDiamondEdge(this, rp)\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    const { x, y, width, height, rotate }: any = this\n    const coordinates = [\n      [x + width / 2, y],\n      [x + width, y + height / 2],\n      [x + width / 2, y + height],\n      [x, y + height / 2]\n    ]\n    const center = getNodeCenterCoordinate(this)\n    return coordinates.map((coordinate) =>\n      getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        center.x,\n        center.y,\n        rotate\n      )\n    )\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotDiamond(this.app.ctx, -halfWidth, -halfHeight, width, height, true)\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtRectangleInner } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotImage } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Image extends BaseNode {\n  public url: string\n\n  public imageObj: null\n\n  public ratio: number\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app, {\n      lockRatio: true\n    })\n\n    const { url, imageObj, ratio }: any = options\n\n    this.url = url || ''\n\n    this.imageObj = imageObj || null\n\n    this.ratio = ratio || 1\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtRectangleInner(this, rp)\n  }\n\n  // Serialisation\n  serialize() {\n    const base = super.serialize()\n    return {\n      ...base,\n      url: this.url,\n      ratio: this.ratio\n    }\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotImage(this.app.ctx, this, -halfWidth, -halfHeight, width, height)\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtLineEdge } from '../common/utils/checkClick'\nimport BaseMultiplexCoordinateNode from '../support/BaseMultiplexCoordinateNode'\nimport DragNode from '../support/DragNode'\nimport { plotLine } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Line extends BaseMultiplexCoordinateNode {\n  public isSingle: boolean\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n\n    // Is it a single line segment, otherwise it is a folded line consisting of multiple line segments\n    const { isSingle = false }: any = options\n\n    this.isSingle = isSingle\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtLineEdge(this as any, rp)\n  }\n\n  render() {\n    const { coordinateArr, fictitiousCoordinate }: any = this\n    this.warpRender(({ cx, cy }: any) => {\n      // Plus the current live position of the mouse\n      let realtimeCoordinate: any[][] = []\n      if (coordinateArr.length > 0 && this.isCreate) {\n        const { x: fx, y: fy } = this.app.calculate.transform(\n          fictitiousCoordinate.x - cx,\n          fictitiousCoordinate.y - cy\n        )\n        realtimeCoordinate = [[fx, fy]]\n      }\n      plotLine(\n        this.app.ctx,\n        coordinateArr\n          .map((coordinate: any[]) => {\n            const { x, y } = this.app.calculate.transform(\n              coordinate[0],\n              coordinate[1]\n            )\n            return [x - cx, y - cy]\n          })\n          .concat(realtimeCoordinate)\n      )\n    })\n    this.renderDragNode()\n  }\n}\n","import { transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtRectangleEdge } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotRect } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Rectangle extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtRectangleEdge(this, rp)\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotRect(this.app.ctx, -halfWidth, -halfHeight, width, height, true)\n    })\n    this.renderDragNode()\n  }\n}\n","import { splitTextLines, transformCoordinateOnNode } from '../common/utils'\nimport { checkIsAtRectangleInner } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotText } from '../support/plot'\nimport { AppObject, Node } from '../types'\n\nexport default class Text extends BaseNode {\n  public text: string\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app, {\n      lockRatio: true\n    })\n\n    this.text = options?.text || ''\n\n    this.style.fillStyle = options?.style?.fillStyle || '#000000'\n\n    this.style.fontSize = options?.style?.fontSize || 18\n\n    this.style.lineHeightRatio = options?.style?.lineHeightRatio || 1.5\n\n    this.style.fontFamily =\n      options?.style?.fontFamily || 'Microsoft YaHei, sans-serif'\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtRectangleInner(this, rp)\n  }\n\n  // Update the wrap-around box\n  // @ts-ignore\n  updateRect(x: number, y: number, width: number, height: number) {\n    const { text, style } = this\n    this.style.fontSize = Math.floor(\n      height / splitTextLines(text).length / style.lineHeightRatio\n    )\n    super.updateRect(x, y, width, height)\n  }\n\n  serialize() {\n    const base = super.serialize()\n    return {\n      ...base,\n      text: this.text\n    }\n  }\n\n  render() {\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotText(this.app.ctx, this, -halfWidth, -halfHeight)\n    })\n    this.renderDragNode()\n  }\n}\n","import {\n  getNodeCenterCoordinate,\n  getRotatedCoordinate,\n  transformCoordinateOnNode\n} from '../common/utils'\nimport { checkIsAtTriangleEdge } from '../common/utils/checkClick'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { plotTriangle } from '../support/plot'\nimport { AppObject } from '../types'\n\nexport default class Triangle extends BaseNode {\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this, this.app)\n  }\n\n  // Get a list of the end coordinates of the graph after the rotation has been applied\n  getEndCoordinateList() {\n    const { x, y, width, height, rotate }: any = this\n    const coordinates = [\n      [x + width / 2, y],\n      [x + width, y + height],\n      [x, y + height]\n    ]\n    const center = getNodeCenterCoordinate(this)\n    return coordinates.map((coordinate) =>\n      getRotatedCoordinate(\n        coordinate[0],\n        coordinate[1],\n        center.x,\n        center.y,\n        rotate\n      )\n    )\n  }\n\n  isClick(x: number, y: number) {\n    const rp = transformCoordinateOnNode(x, y, this)\n    return checkIsAtTriangleEdge(this as any, rp)\n  }\n\n  render() {\n    const { width, height }: any = this\n    this.warpRender(({ halfWidth, halfHeight }: any) => {\n      plotTriangle(this.app.ctx, -halfWidth, -halfHeight, width, height, true)\n    })\n    this.renderDragNode()\n  }\n}\n","import { DRAG_NODE_PARTS } from '../common/constants'\nimport {\n  computedLineWidthBySpeed,\n  createImageObj,\n  getNodeID,\n  getTowCoordinateDistance,\n  throttle\n} from '../common/utils'\nimport ArbitraryPlot from '../components/ArbitraryPlot'\nimport Arrow from '../components/Arrow'\nimport Circle from '../components/Circle'\nimport Diamond from '../components/Diamond'\nimport Image from '../components/Image'\nimport Line from '../components/Line'\nimport Rectangle from '../components/Rectangle'\nimport Text from '../components/Text'\nimport Triangle from '../components/Triangle'\nimport { AppObject, Ctx, Node, NodeArray, PlotType } from '../types'\n\nexport default class Nodes {\n  public app: AppObject\n\n  public nodeList: NodeArray\n\n  activeNode: Node | undefined\n\n  public isCreateNode: boolean\n\n  public isResize: boolean\n\n  public resizeNode: Node | null\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    // All graphic objects\n    this.nodeList = []\n\n    // Currently active graphic object\n    this.activeNode = undefined\n\n    // A new graphic object is currently being created\n    this.isCreateNode = false\n\n    // The graphic object is currently being adjusted\n    this.isResize = false\n\n    // The graphic object currently being adjusted\n    this.resizeNode = null\n\n    // A little relief from lag\n    this.handleResize = throttle(this.handleResize, this as any, 15)\n  }\n\n  createNode(\n    options: any,\n    callback: (...args: any) => void = () => {},\n    ctx?: Ctx,\n    notActive?: boolean\n  ) {\n    if (this.hasActiveNode() || this.isCreateNode) {\n      return this\n    }\n    options.id = getNodeID()\n    const node: any = this.pureCreateNode(options)\n    if (!node) {\n      return this\n    }\n    this.addNode(node)\n    if (!notActive) {\n      this.setActiveNode(node)\n    }\n    this.isCreateNode = true\n    // @ts-ignore\n    callback.call(ctx, node)\n    return this\n  }\n\n  copyNode(node: Node, notActive?: boolean, pos?: { x: number; y: number }) {\n    return new Promise<any>(async (resolve) => {\n      if (!node) {\n        return\n      }\n      const data: any = node.serialize?.()\n      if (data.type === 'image' && data.url != null) {\n        data.imageObj = (await createImageObj(data.url)) as HTMLInputElement\n      }\n      this.createNode(\n        data,\n        (node: any) => {\n          node.startResize(DRAG_NODE_PARTS.BODY)\n          let ox = 20\n          let oy = 20\n          if (pos) {\n            ox = pos.x - node.x - node.width / 2\n            oy = pos.y - node.y - node.height / 2\n          }\n          const gridAdsorbentPos = this.app.calculate.gridAdsorbent(ox, oy)\n          node.resize(null, null, null, gridAdsorbentPos.x, gridAdsorbentPos.y)\n          node.isCreate = false\n          if (notActive) {\n            node.isActive = false\n          }\n          this.isCreateNode = false\n          resolve(node)\n        },\n        this as unknown as Ctx,\n        notActive\n      )\n    })\n  }\n\n  // Rectangle-like graphic object being created\n  createRectangleLikeNode(\n    type: PlotType,\n    x: number,\n    y: number,\n    offsetX: number,\n    offsetY: number\n  ) {\n    this.createNode({\n      type,\n      x,\n      y,\n      width: offsetX,\n      height: offsetY\n    })\n    this.activeNode?.updateSize?.(offsetX, offsetY)\n  }\n\n  // Circular graphic object being created\n  createCircle(x: number, y: number, e: { clientX: any; clientY: any }) {\n    this.createNode({\n      type: 'circle',\n      x,\n      y\n    })\n    const radius = getTowCoordinateDistance(e.clientX, e.clientY, x, y)\n    this.activeNode?.updateSize?.(radius, radius)\n  }\n\n  // Freehand brush graphic object being created\n  createArbitraryPlot(\n    e: { clientX: any; clientY: any },\n    event: { mouseSpeed: number; lastMousePos: { x: number; y: number } }\n  ) {\n    this.createNode({\n      type: 'arbitrary-plot'\n    })\n    const node = this.activeNode\n    // Calculating brush thickness\n    const lineWidth = computedLineWidthBySpeed(\n      event.mouseSpeed,\n      <number>node?.lastLineWidth\n    )\n    if (node?.lastLineWidth) {\n      node.lastLineWidth = lineWidth\n    }\n    node?.addCoordinate?.(e.clientX, e.clientY, lineWidth)\n    // The brush is not repainted and incremental painting is used, otherwise it will lag\n    const { calculate, ctx, state } = this.app\n    const tfp = calculate.transformToCanvasCalculate(\n      calculate.subScrollX(event.lastMousePos.x),\n      calculate.subScrollY(event.lastMousePos.y)\n    )\n    const ttp = calculate.transformToCanvasCalculate(\n      calculate.subScrollX(e.clientX),\n      calculate.subScrollY(e.clientY)\n    )\n    ctx.save()\n    ctx.scale(<number>state.scale, <number>state.scale)\n    node?.singleRender?.(tfp.x, tfp.y, ttp.x, ttp.y, lineWidth)\n    ctx.restore()\n  }\n\n  // Image graphic object being created\n  createImage(\n    e: { unGridClientX: number; unGridClientY: number },\n    {\n      width,\n      height,\n      imageObj,\n      url,\n      ratio\n    }: {\n      width: number\n      height: number\n      imageObj: HTMLInputElement\n      url: string\n      ratio: number\n    }\n  ) {\n    const gp = this.app.calculate.gridAdsorbent(\n      e.unGridClientX - width / 2,\n      e.unGridClientY - height / 2\n    )\n    this.createNode({\n      type: 'image',\n      x: gp.x,\n      y: gp.y,\n      url,\n      imageObj,\n      width,\n      height,\n      ratio\n    })\n  }\n\n  // Text graphic object being edited\n  editingText(node: Node) {\n    if (node.type !== 'text') {\n      return\n    }\n    node.noRender = true\n    this.setActiveNode(node)\n  }\n\n  // Complete editing of text graphic objects\n  completeEditingText() {\n    const node = this.activeNode\n    if (!node || node.type !== 'text') {\n      return\n    }\n    if (!node?.text?.trim()) {\n      this.deleteNode(node)\n      this.setActiveNode()\n      return\n    }\n    node.noRender = false\n  }\n\n  // Complete the creation of the arrow graphic object\n  completeCreateArrow(e: { clientX: number; clientY: number }) {\n    this.activeNode?.addCoordinate?.(e.clientX, e.clientY)\n  }\n\n  // Arrowhead graphic object being created\n  createArrow(x: number, y: number, e: { clientX: any; clientY: any }) {\n    this.createNode(\n      {\n        type: 'arrow',\n        x,\n        y\n      },\n      (node) => {\n        node.addCoordinate(x, y)\n      }\n    )\n    this.activeNode?.updateFictitiousCoordinate?.(e.clientX, e.clientY)\n  }\n\n  // Line/line graphical object being created\n  createLine(\n    x: number | undefined,\n    y: number | undefined,\n    e: { clientX: number; clientY: number },\n    isSingle = false,\n    notCreate = false\n  ) {\n    if (!notCreate) {\n      this.createNode(\n        {\n          type: 'line',\n          x,\n          y,\n          isSingle\n        },\n        (node) => {\n          node.addCoordinate(x, y)\n        }\n      )\n    }\n    const node = this.activeNode\n    if (node) {\n      node.updateFictitiousCoordinate?.(e.clientX, e.clientY)\n    }\n  }\n\n  insertNode(node: Node, index: number) {\n    this.nodeList.splice(index, 0, node)\n  }\n\n  addNode(node: Node) {\n    this.nodeList.push(node)\n    return this\n  }\n\n  getNodesNum() {\n    return this.nodeList.length\n  }\n\n  hasNodes() {\n    return this.nodeList.length > 0\n  }\n\n  unshiftNode(node: Node) {\n    this.nodeList.unshift(node)\n    return this\n  }\n\n  // Deleting graphic objects\n  deleteNode(node: Node) {\n    const index = this.getNodeIndex(node)\n    if (index !== -1) {\n      this.nodeList.splice(index, 1)\n      if (node.isActive) {\n        this.cancelActiveNode()\n      }\n    }\n    return this\n  }\n\n  // Delete all graphic objects\n  deleteAllNodes() {\n    this.activeNode = undefined\n    this.nodeList = []\n    this.isCreateNode = false\n    this.isResize = false\n    this.resizeNode = null\n    return this\n  }\n\n  // Get the index of the graphic object in the list of graphic objects\n  getNodeIndex(node: Node) {\n    return this.nodeList.findIndex((item) => item === node)\n  }\n\n  // Create graphic objects from graphic object data\n  createNodesFromData(nodes: NodeArray) {\n    nodes.forEach((node) => {\n      const nodeObject: any = this.pureCreateNode(node)\n      nodeObject.isActive = false\n      nodeObject.isCreate = false\n      this.addNode(nodeObject as Node)\n    })\n    return this\n  }\n\n  // Presence or absence of active graphic objects\n  hasActiveNode() {\n    return this.activeNode\n  }\n\n  // Setting the activation of graphic objects\n  setActiveNode(node?: Node) {\n    this.cancelActiveNode()\n    this.activeNode = node\n    if (node) {\n      node.isActive = true\n    }\n    this.app.emit('activeNodeChange', this.activeNode)\n    return this\n  }\n\n  // Cancel the currently active graphic object\n  cancelActiveNode() {\n    if (!this.hasActiveNode()) {\n      return this\n    }\n    if (this.activeNode) {\n      this.activeNode.isActive = false\n      this.activeNode = undefined\n    }\n    this.app.emit('activeNodeChange', this.activeNode)\n    return this\n  }\n\n  // Detects if a graphic object is selected by a coordinate click\n  checkIsClickNode(e: any) {\n    const x = e.unGridClientX\n    const y = e.unGridClientY\n    for (let i = this.nodeList.length - 1; i >= 0; i -= 1) {\n      const node = this.nodeList[i]\n      if (node.isClick?.(x, y)) {\n        return node\n      }\n    }\n    return null\n  }\n\n  pureCreateNode(options: any = {}) {\n    switch (options.type) {\n      case 'rectangle':\n        return new Rectangle(options, this.app)\n      case 'diamond':\n        return new Diamond(options, this.app)\n      case 'triangle':\n        return new Triangle(options, this.app)\n      case 'circle':\n        return new Circle(options, this.app)\n      case 'arbitrary-plot':\n        return new ArbitraryPlot(options, this.app)\n      case 'image':\n        return new Image(options, this.app)\n      case 'arrow':\n        return new Arrow(options, this.app)\n      case 'line':\n        return new Line(options, this.app)\n      case 'text':\n        return new Text(options, this.app)\n      default:\n        return null\n    }\n  }\n\n  // Complete the creation of line/dash graphical objects\n  completeCreateLine(\n    e: { clientX: number; clientY: number },\n    completeCallback = () => {}\n  ) {\n    let node = this.activeNode\n    const x = e.clientX\n    const y = e.clientY\n    if (node && node.isSingle) {\n      node.addCoordinate?.(x, y)\n      completeCallback()\n    } else {\n      this.createNode({\n        type: 'line',\n        isSingle: false\n      })\n      node = this.activeNode\n      node?.addCoordinate?.(x, y)\n      node?.updateFictitiousCoordinate?.(x, y)\n    }\n  }\n\n  // Creation of graphic objects complete\n  completeCreateNode() {\n    this.isCreateNode = false\n    const node: any = this.activeNode\n    if (!node) {\n      return this\n    }\n    if (['arbitrary-plot', 'arrow', 'line'].includes(node.type)) {\n      node.updateMultiplexCoordinateBoundingRect()\n    }\n    node.isCreate = false\n    this.app.emitChange()\n    return this\n  }\n\n  // Styling of active graphic objects\n  setActiveNodeStyle(style = {}) {\n    if (!this.hasActiveNode()) {\n      return this\n    }\n    Object.keys(style).forEach((key) => {\n      // @ts-ignore\n      this.activeNode.style[key] = style[key]\n    })\n    return this\n  }\n\n  // Detects if the specified position is on the graphic object adjustment handle\n  checkInResizeHand(x: any, y: any) {\n    const node = this.activeNode\n    const hand = node?.dragNode?.checkCoordinateInDragNodeWhere?.(x, y)\n    if (hand) {\n      return {\n        node,\n        hand\n      }\n    }\n    return null\n  }\n\n  // Check if a graphic object adjustment operation is required\n  checkIsResize(x: number, y: number, e: any) {\n    if (!this.hasActiveNode()) {\n      return false\n    }\n    const res = this.checkInResizeHand(x, y)\n    if (res) {\n      this.isResize = true\n      if (res.node) {\n        this.resizeNode = res.node\n        this.resizeNode.startResize?.(res.hand, e)\n      }\n      this.app.cursor.setResize(res.hand)\n      return true\n    }\n    return false\n  }\n\n  // Performing graphic object adjustment operations\n  handleResize(...args: any[]) {\n    if (!this.isResize) {\n      return\n    }\n    this.resizeNode?.resize?.(...args)\n  }\n\n  // Ending a graphic object adjustment operation\n  endResize() {\n    this.isResize = false\n    this.resizeNode?.endResize?.()\n    this.resizeNode = null\n  }\n\n  // Serialize all graphic objects on the current canvas\n  serialize(stringify = false) {\n    const data = this.nodeList.map((node) => node.serialize?.())\n    return stringify ? JSON.stringify(data) : data\n  }\n}\n","import { getMultiplexNodeRectInfo } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class Render {\n  public app: AppObject\n\n  public beingCopyActiveNode: null\n\n  public beingCopySelectedNodes: any[]\n\n  public beingCopyNode: undefined\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    // The active graphic object that will be copied\n    this.beingCopyActiveNode = null\n\n    // The selected graphic object that will be copied\n    this.beingCopySelectedNodes = []\n\n    this.registerShortcutKeys()\n  }\n\n  // Styling of active graphic objects\n  setActiveNodeStyle(style = {}) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.setActiveNodeStyle(style)\n    this.render()\n    if (!this.app.nodes.isCreateNode) {\n      this.app.emitChange()\n    }\n    return this\n  }\n\n  // Set the style for the currently active or selected graphic object\n  setCurrentNodesStyle(style = {}) {\n    this.setActiveNodeStyle(style)\n    this.app.selection.setSelectedNodeStyle(style)\n  }\n\n  clearCanvas() {\n    const { width, height } = this.app\n    this.app.ctx.clearRect(-width / 2, -height / 2, width, height)\n    return this\n  }\n\n  render() {\n    const { state } = this.app\n    this.clearCanvas()\n    this.app.ctx.save()\n    this.app.ctx.scale(<number>state.scale, <number>state.scale)\n    this.app.nodes.nodeList.forEach((node: any) => {\n      if (node.noRender) {\n        return\n      }\n      node.render()\n    })\n    this.app.ctx.restore()\n    return this\n  }\n\n  registerShortcutKeys() {\n    // Select all\n    this.app.keyCommand.addShortcut('Control+a', () => {\n      this.selectAll()\n    })\n    // Resetting scaling\n    this.app.keyCommand.addShortcut('Control+0', () => {\n      this.setZoom(1)\n    })\n    // Delete the currently active graphic object\n    this.app.keyCommand.addShortcut('Del|Backspace', () => {\n      this.deleteCurrentNodes()\n    })\n    // Copying graphic objects\n    this.app.keyCommand.addShortcut('Control+c', () => {\n      this.copyCurrentNode()\n    })\n    // Cutting graphic objects\n    this.app.keyCommand.addShortcut('Control+x', () => {\n      this.cutCurrentNode()\n    })\n    // Withdrawn\n    this.app.keyCommand.addShortcut('Control+z', () => {\n      this.app.history.undo()\n    })\n    // Show or hide the grid\n    this.app.keyCommand.addShortcut(\"Control+'\", () => {\n      if (this.app.state.showGrid) {\n        this.app.grid.hideGrid()\n      } else {\n        this.app.grid.showGrid()\n      }\n    })\n    // Redo\n    this.app.keyCommand.addShortcut('Control+y', () => {\n      this.app.history.redo()\n    })\n    // Paste graphic objects\n    this.app.keyCommand.addShortcut('Control+v', () => {\n      this.pasteCurrentNode(true)\n    })\n  }\n\n  // Copy the currently active or selected graphic object\n  copyCurrentNode() {\n    if (this.app.nodes.activeNode) {\n      this.beingCopySelectedNodes = []\n      this.beingCopyNode = this.app.nodes.activeNode\n    } else if (this.app.selection.hasSelectionNodes()) {\n      this.beingCopyNode = undefined\n      this.beingCopySelectedNodes = this.app.selection.getSelectionNodes()\n    }\n  }\n\n  // Cuts the currently active or selected graphic object\n  cutCurrentNode() {\n    if (this.app.nodes.activeNode) {\n      this.copyCurrentNode()\n      this.deleteCurrentNodes()\n    } else if (this.app.selection.hasSelectionNodes()) {\n      this.copyCurrentNode()\n      this.deleteCurrentNodes()\n      this.app.selection.setMultiplexSelectNodes(this.beingCopySelectedNodes)\n      this.app.selection.emitChange()\n    }\n  }\n\n  // Paste the copied or cut graphic object\n  pasteCurrentNode(useCurrentEventPos = false) {\n    let pos = null\n    if (useCurrentEventPos) {\n      const { x } = this.app.event.lastMousePos\n      const { y } = this.app.event.lastMousePos\n      pos = {\n        x,\n        y\n      }\n    }\n    if (this.beingCopyNode) {\n      this.copyNode(this.beingCopyNode, false, pos as any).then(() => {})\n    } else if (this.beingCopySelectedNodes.length > 0) {\n      this.app.selection.copySelectionNodes(useCurrentEventPos ? pos : null)\n    }\n  }\n\n  // Deleting graphic objects\n  deleteNode(node: any) {\n    this.app.nodes.deleteNode(node)\n    this.render()\n    this.app.emitChange()\n  }\n\n  // Copy and paste graphic objects\n  async copyNode(node: any, notActive?: boolean, pos?: { x: any; y: any }) {\n    this.app.nodes.cancelActiveNode()\n    await this.app.nodes.copyNode(node, notActive, pos)\n    this.render()\n    this.app.emitChange()\n  }\n\n  // Delete the currently active graphic object\n  deleteActiveNode() {\n    if (!this.app.nodes.hasActiveNode()) {\n      return\n    }\n    this.deleteNode(this.app.nodes.activeNode)\n  }\n\n  // Delete the currently active or selected graphic object\n  deleteCurrentNodes() {\n    this.deleteActiveNode()\n    this.app.selection.deleteSelectedNodes()\n  }\n\n  // Cancel the currently active graphic object\n  cancelActiveNode() {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.cancelActiveNode()\n    this.render()\n    return this\n  }\n\n  // Update the position of the currently active graphic object\n  updateActiveNodePosition(x: number, y: number) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.activeNode.updatePos(x, y)\n    this.render()\n    return this\n  }\n\n  // Update the size of the currently active graphic object\n  updateActiveNodeSize(width: number, height: number) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.activeNode.updateSize(width, height)\n    this.render()\n    return this\n  }\n\n  // Update the rotation angle of the currently active graphic object\n  updateActiveNodeRotate(rotate: number) {\n    if (!this.app.nodes.hasActiveNode()) {\n      return this\n    }\n    this.app.nodes.activeNode.updateRotate(rotate)\n    this.render()\n    return this\n  }\n\n  // Emptying a graphic object\n  empty() {\n    this.app.nodes.deleteAllNodes()\n    this.render()\n    this.app.emitChange()\n  }\n\n  // Enlarge\n  zoomIn(num = 0.1) {\n    if (this.app.state.scale) {\n      this.app.updateState({\n        scale: this.app.state.scale + num\n      } as any)\n      this.render()\n      this.app.emit('zoomChange', this.app.state.scale)\n    }\n  }\n\n  // Reduction\n  zoomOut(num = 0.1) {\n    if (this.app.state.scale) {\n      this.app.updateState({\n        scale: this.app.state.scale - num > 0 ? this.app.state.scale - num : 0\n      } as any)\n      this.render()\n      this.app.emit('zoomChange', this.app.state.scale)\n    }\n  }\n\n  // Set the specified zoom value\n  setZoom(zoom: number) {\n    if (zoom < 0 || zoom > 1) {\n      return\n    }\n    this.app.updateState({\n      scale: zoom\n    } as any)\n    this.render()\n    this.app.emit('zoomChange', this.app.state.scale)\n  }\n\n  // Scaling to fit all graphic objects\n  fit() {\n    if (!this.app.nodes.hasNodes()) {\n      return\n    }\n    this.scrollToCenter()\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.app.nodes.nodeList\n    )\n    const width = maxX - minX\n    const height = maxY - minY\n    const maxScale = Math.min(this.app.width / width, this.app.height / height)\n    this.setZoom(maxScale)\n  }\n\n  // Scroll to the specified position\n  scrollTo(scrollX: number, scrollY: number) {\n    this.app.updateState({\n      scrollX,\n      scrollY\n    } as any)\n    this.render()\n    this.app.emit(\n      'scrollChange',\n      this.app.state.scrollX,\n      this.app.state.scrollY\n    )\n  }\n\n  // Scroll to centre, i.e. back to the centre of all graphic objects\n  scrollToCenter() {\n    if (!this.app.nodes.hasNodes()) {\n      this.scrollTo(0, 0)\n      return\n    }\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.app.nodes.nodeList\n    )\n    const width = maxX - minX\n    const height = maxY - minY\n    this.scrollTo(\n      minX - (this.app.width - width) / 2,\n      minY - (this.app.height - height) / 2\n    )\n  }\n\n  // Copy and paste the current graphic object\n  copyPasteCurrentNodes() {\n    this.copyCurrentNode()\n    this.pasteCurrentNode()\n  }\n\n  // Set the background colour\n  setBackgroundColor(color: string) {\n    this.app.updateState({\n      backgroundColor: color\n    } as any)\n    this.app.background.set()\n  }\n\n  // Select all graphic objects\n  selectAll() {\n    this.app.selection.selectNodes(this.app.nodes.nodeList)\n  }\n}\n","import { AppObject } from '../../types'\n\nexport default class Calculate {\n  private readonly app: AppObject\n\n  constructor(app: AppObject) {\n    this.app = app\n  }\n\n  // Conversion of screen coordinates to canvas coordinates\n  transformToCanvasCalculate(x: number, y: number) {\n    x -= this.app.width / 2\n    y -= this.app.height / 2\n    return {\n      x,\n      y\n    }\n  }\n\n  // Object position attached to grid\n  gridAdsorbent(x: number, y: number) {\n    const { gridConfig, showGrid } = this.app.state\n    if (typeof gridConfig === 'undefined') {\n      return {}\n    }\n    if (!showGrid) {\n      return {\n        x,\n        y\n      }\n    }\n    const gridSize = gridConfig.size\n    if (typeof gridSize === 'undefined') {\n      return {}\n    }\n    return {\n      x: x - (x % gridSize),\n      y: y - (y % gridSize)\n    }\n  }\n\n  // Add vertical scroll distance\n  addScrollY(y: number) {\n    if (typeof this.app.state.scrollY === 'undefined') {\n      return 0\n    }\n    return this.app.state.scrollY + y\n  }\n\n  // Add horizontal scroll distance\n  addScrollX(x: number) {\n    if (typeof this.app.state.scrollX === 'undefined') {\n      return 0\n    }\n    return this.app.state.scrollX + x\n  }\n\n  // minus vertical scroll distance\n  subScrollY(y: number) {\n    if (typeof this.app.state.scrollY === 'undefined') {\n      return 0\n    }\n    return y - this.app.state.scrollY\n  }\n\n  // minus horizontal rolling distance\n  subScrollX(x: number) {\n    if (typeof this.app.state.scrollX === 'undefined') {\n      return 0\n    }\n    return x - this.app.state.scrollX\n  }\n\n  // Canvas conversion to screen coordinates\n  transformToScreenCalculate(x: number, y: number) {\n    x += this.app.width / 2\n    y += this.app.height / 2\n    return {\n      x,\n      y\n    }\n  }\n\n  // Integrated conversion, screen coordinates to canvas coordinates minus scroll values\n  transform(x: number, y: number) {\n    const t = this.transformToCanvasCalculate(x, y)\n    return {\n      x: this.subScrollX(t.x),\n      y: this.subScrollY(t.y)\n    }\n  }\n\n  // For when the container is not full screen, convert coordinates relative to the container to relative to the window\n  mountELToWindow(x: number, y: number) {\n    return {\n      x: x + this.app.left,\n      y: y + this.app.top\n    }\n  }\n\n  // For when the container is not full screen, Convert coordinates relative to the window to relative to the container\n  windowToContainer(x: number, y: number) {\n    return {\n      x: x - this.app.left,\n      y: y - this.app.top\n    }\n  }\n\n  // The position of the screen coordinates after applying canvas scaling\n  scale(x: number, y: number) {\n    const { state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return {}\n    }\n    const wp = this.transformToCanvasCalculate(x, y)\n    const sp = this.transformToScreenCalculate(\n      wp.x * state.scale,\n      wp.y * state.scale\n    )\n    return {\n      x: sp.x,\n      y: sp.y\n    }\n  }\n\n  // The position of the screen coordinates after applying the canvas zoom in reverse\n  reverseScale(x: number, y: number) {\n    const { state } = this.app\n    if (typeof state.scale === 'undefined') {\n      return {}\n    }\n    const tp = this.transformToCanvasCalculate(x, y)\n    const sp = this.transformToScreenCalculate(\n      tp.x / state.scale,\n      tp.y / state.scale\n    )\n    return {\n      x: sp.x,\n      y: sp.y\n    }\n  }\n}\n","import {\n  getMultiplexNodeRectInfo,\n  getNodeCenterCoordinate,\n  getTowCoordinateRotate\n} from '../common/utils'\nimport BaseNode from '../support/BaseNode'\nimport DragNode from '../support/DragNode'\nimport { AppObject, Node, NodeArray } from '../types'\n\nexport default class MultiplexSelectNode extends BaseNode {\n  selectedNodeList: NodeArray\n\n  public wholeCenterPos: { x: number; y: number }\n\n  constructor(options: Node, app: AppObject) {\n    super(options, app)\n\n    this.dragNode = new DragNode(this as any, this.app)\n\n    this.selectedNodeList = []\n\n    this.wholeCenterPos = { x: 0, y: 0 }\n  }\n\n  // Filtering out deleted graphic objects\n  updateNodes(nodes: NodeArray) {\n    const exists: NodeArray = []\n    this.selectedNodeList.forEach((node) => {\n      if (nodes.includes(node)) {\n        exists.push(node)\n      }\n    })\n    this.setSelectedNodeList(exists)\n  }\n\n  // Calculate size and position\n  // @ts-ignore\n  updateRect() {\n    if (this.selectedNodeList.length <= 0) {\n      super.updateRect(0, 0, 0, 0)\n      return\n    }\n    const { minX, maxX, minY, maxY } = getMultiplexNodeRectInfo(\n      this.selectedNodeList\n    )\n    super.updateRect(minX, minY, maxX - minX, maxY - minY)\n  }\n\n  // In adjustment\n  // @ts-ignore\n  resize(...args: any) {\n    this.selectedNodeList.forEach((node: Node) => {\n      if (node.dragNode && node.dragNode.resizeType === 'rotate') {\n        // 旋转操作特殊处理\n        this.handleRotate(node, ...args)\n      } else {\n        node?.resize?.(...args)\n      }\n    })\n  }\n\n  // Rotating graphic objects\n  handleRotate(node: Node, e?: any, mx?: number, my?: number) {\n    const rotate = getTowCoordinateRotate(\n      this.wholeCenterPos.x,\n      this.wholeCenterPos.y,\n      e.clientX,\n      e.clientY,\n      <number>mx,\n      <number>my\n    )\n    node.rotateByCenter?.(rotate, this.wholeCenterPos.x, this.wholeCenterPos.y)\n  }\n\n  // End of adjustment\n  // @ts-ignore\n  endResize() {\n    this.selectedNodeList.forEach((node) => {\n      node.endResize?.()\n    })\n  }\n\n  // Set the selected graphic object list\n  setSelectedNodeList(list: NodeArray) {\n    this.selectedNodeList.forEach((node) => {\n      node.isSelected = false\n    })\n    this.selectedNodeList = list\n    this.selectedNodeList.forEach((node) => {\n      node.isSelected = true\n    })\n  }\n\n  // Start of adjustment\n  // @ts-ignore\n  startResize(...args: any) {\n    this.selectedNodeList.forEach((node) => {\n      if (args[0] === 'rotate') {\n        // 计算多选图形对象整体中心坐标\n        this.wholeCenterPos = getNodeCenterCoordinate(this as any)\n      }\n      node.startResize?.(...args)\n    })\n  }\n\n  render() {\n    if (this.width && this.height && this.selectedNodeList.length > 0) {\n      if (this.width <= 0 || this.height <= 0) {\n        return\n      }\n      this.dragNode.render()\n    }\n  }\n}\n","import { DRAG_NODE_PARTS } from '../common/constants'\nimport { getBoundingRect, throttle } from '../common/utils'\nimport Calculate from '../common/utils/Calculate'\nimport MultiplexSelectNode from '../components/MultiplexSelectNode'\nimport Rectangle from '../components/Rectangle'\nimport Canvas from '../support/Canvas'\nimport { AppObject, Ctx, Node, NodeArray, State } from '../types'\n\nexport default class Selection {\n  public app: AppObject\n\n  public canvas: any\n\n  public ctx: Ctx | undefined\n\n  public createSelection: boolean\n\n  hasSelection: boolean\n\n  public isResize: boolean\n\n  public state: State\n\n  public width: number\n\n  public height: number\n\n  public calculate: Calculate\n\n  public rectangle: Rectangle\n\n  public multiplexSelectNode: MultiplexSelectNode\n\n  constructor(app: AppObject) {\n    this.app = app\n\n    this.canvas = null\n\n    this.ctx = undefined\n\n    // Is a selection currently being created\n    this.createSelection = false\n\n    // Whether there is currently a multiple selection of graphic objects\n    this.hasSelection = false\n\n    // Whether the selected graphic object is currently being adjusted\n    this.isResize = false\n\n    this.state = this.app.state\n\n    this.width = this.app.width\n\n    this.height = this.app.height\n\n    this.calculate = new Calculate(this as unknown as AppObject)\n\n    // Selection Rectangle\n    this.rectangle = new Rectangle(\n      {\n        type: 'rectangle',\n        style: {\n          strokeStyle: 'rgba(9,132,227,0.3)',\n          fillStyle: 'rgba(9,132,227,0.3)'\n        }\n      } as any,\n      this as any\n    )\n\n    // Virtual graphic object of the selected graphic object for displaying the drag and drop box\n    this.multiplexSelectNode = new MultiplexSelectNode(\n      {\n        type: 'multiplexSelectNode'\n      } as any,\n      this as any\n    )\n\n    // @ts-ignore\n    this.checkInNodes = throttle(this.checkInNodes, this, 20)\n\n    // A little relief from lag\n    this.handleResize = throttle(this.handleResize, this as any, 15)\n\n    this.init()\n\n    this.bindEvent()\n  }\n\n  // Detection of nodes in the selection\n  checkInNodes(e: any, event: any) {\n    const minX = Math.min(event.mousedownPos.x, e.clientX)\n    const minY = Math.min(event.mousedownPos.y, e.clientY)\n    const maxX = Math.max(event.mousedownPos.x, e.clientX)\n    const maxY = Math.max(event.mousedownPos.y, e.clientY)\n    const selectedNodeList: any[] | undefined = []\n    this.app.nodes.nodeList.forEach((node: Node) => {\n      let _minX = Infinity\n      let _maxX = -Infinity\n      let _minY = Infinity\n      let _maxY = -Infinity\n      const endCoordinateList = node?.getEndCoordinateList?.()\n      const rect: any = getBoundingRect(\n        endCoordinateList.map((coordinate: { x: number; y: number }) => [\n          coordinate.x,\n          coordinate.y\n        ]),\n        true\n      )\n      rect.forEach(({ x, y }: any) => {\n        if (x < _minX) {\n          _minX = x\n        }\n        if (x > _maxX) {\n          _maxX = x\n        }\n        if (y < _minY) {\n          _minY = y\n        }\n        if (y > _maxY) {\n          _maxY = y\n        }\n      })\n      if (_minX >= minX && _maxX <= maxX && _minY >= minY && _maxY <= maxY) {\n        selectedNodeList.push(node)\n      }\n    })\n    this.setMultiplexSelectNodes(selectedNodeList, true)\n    this.app.render.render()\n  }\n\n  // Detects if the specified position is on the graphic object adjustment handle\n  checkInResizeHand(x: any, y: any) {\n    return this.multiplexSelectNode.dragNode.checkCoordinateInDragNodeWhere(\n      x,\n      y\n    )\n  }\n\n  // Delete the currently selected graphic object\n  deleteSelectedNodes() {\n    this.getSelectionNodes().forEach((node: Node) => {\n      this.app.nodes.deleteNode(node)\n    })\n    this.selectNodes([])\n    this.app.emitChange()\n  }\n\n  // Whether the selected graphic object currently exists\n  hasSelectionNodes() {\n    return this.getSelectionNodes().length > 0\n  }\n\n  // Get the currently selected graphic object\n  getSelectionNodes() {\n    return this.multiplexSelectNode.selectedNodeList\n  }\n\n  // Copy the currently selected graphic objects\n  async copySelectionNodes(pos: { x: number; y: number }) {\n    const task = this.getSelectionNodes().map((node) =>\n      this.app.nodes.copyNode(node, true)\n    )\n    const nodes = await Promise.all(task)\n    this.setMultiplexSelectNodes(nodes)\n    // Paste to the specified location\n    if (pos) {\n      this.multiplexSelectNode.startResize(DRAG_NODE_PARTS.BODY)\n      if (\n        !this.multiplexSelectNode.x ||\n        !this.multiplexSelectNode.y ||\n        !this.multiplexSelectNode.width ||\n        !this.multiplexSelectNode.height\n      ) {\n        // eslint-disable-next-line no-console\n        console.error('multiplexSelectNode x or y or width or height is null')\n        return\n      }\n      const ox =\n        pos.x - this.multiplexSelectNode.x - this.multiplexSelectNode.width / 2\n      const oy =\n        pos.y - this.multiplexSelectNode.y - this.multiplexSelectNode.height / 2\n      // If the grid is turned on, then the coordinates are to be attached to the grid\n      const gridAdsorbentPos = this.app.calculate.gridAdsorbent(ox, oy)\n      this.multiplexSelectNode.resize(\n        null,\n        null,\n        null,\n        gridAdsorbentPos.x,\n        gridAdsorbentPos.y\n      )\n      this.multiplexSelectNode.endResize()\n      this.multiplexSelectNode.updateRect()\n    }\n    this.app.render.render()\n    this.renderSelection()\n    this.app.emitChange()\n  }\n\n  // Check if a graphic object adjustment operation is required\n  checkIsResize(x: number, y: number, e: any) {\n    if (!this.hasSelection) {\n      return false\n    }\n    const hand =\n      this.multiplexSelectNode.dragNode.checkCoordinateInDragNodeWhere(x, y)\n    if (hand) {\n      this.isResize = true\n      this.multiplexSelectNode.startResize(hand, e)\n      this.app.cursor.setResize(hand)\n      return true\n    }\n    return false\n  }\n\n  // Performing graphic object adjustment operations\n  handleResize(...args: any[]) {\n    if (!this.isResize) {\n      return\n    }\n    this.multiplexSelectNode.resize(...args)\n    this.app.render.render()\n    this.multiplexSelectNode.updateRect()\n    this.renderSelection()\n  }\n\n  // Ending a graphic object adjustment operation\n  endResize() {\n    this.isResize = false\n    this.multiplexSelectNode.endResize()\n  }\n\n  // Styling of multi-selected graphic objects\n  setSelectedNodeStyle(style = {}) {\n    if (!this.hasSelectionNodes()) {\n      return\n    }\n    Object.keys(style).forEach((key) => {\n      this.getSelectionNodes().forEach((node) => {\n        // @ts-ignore\n        node.style[key] = style[key]\n      })\n    })\n    this.app.render.render()\n    this.app.emitChange()\n  }\n\n  // Select the specified graphic object\n  selectNodes(nodes = []) {\n    this.hasSelection = nodes.length > 0\n    this.setMultiplexSelectNodes(nodes)\n    this.app.render.render()\n    this.renderSelection()\n    this.emitChange()\n  }\n\n  cancelSelectNodes() {\n    this.selectNodes([])\n  }\n\n  // Set the selected graphic object\n  setMultiplexSelectNodes(nodes: NodeArray = [], notUpdateRect?: boolean) {\n    this.multiplexSelectNode.setSelectedNodeList(nodes)\n    if (!notUpdateRect) {\n      this.multiplexSelectNode.updateRect()\n    }\n  }\n\n  emitChange() {\n    this.app.emit('multiplexSelectChange', this.getSelectionNodes())\n  }\n\n  bindEvent() {\n    this.app.on('change', () => {\n      this.state = this.app.state\n      this.multiplexSelectNode.updateNodes(this.app.nodes.nodeList)\n      this.renderSelection()\n    })\n    this.app.on('scrollChange', () => {\n      this.renderSelection()\n    })\n    this.app.on('zoomChange', () => {\n      this.renderSelection()\n    })\n  }\n\n  onMousedown(\n    e: { originEvent: { which: number } },\n    event: { mousedownPos: { x: number; y: number } }\n  ) {\n    if (e.originEvent.which !== 1) {\n      return\n    }\n    this.createSelection = true\n    this.rectangle.updatePos(event.mousedownPos.x, event.mousedownPos.y)\n  }\n\n  onMousemove(e: number, event: { mouseOffset: { x: number; y: number } }) {\n    if (\n      Math.abs(event.mouseOffset.x) <= 10 &&\n      Math.abs(event.mouseOffset.y) <= 10\n    ) {\n      return\n    }\n    this.onMove(e, event)\n  }\n\n  onMouseup() {\n    this.createSelection = false\n    this.rectangle.updateRect(0, 0, 0, 0)\n    // 判断是否有图形对象被选中\n    this.hasSelection = this.hasSelectionNodes()\n    this.multiplexSelectNode.updateRect()\n    this.renderSelection()\n    this.emitChange()\n  }\n\n  // Mouse movement events\n  onMove(e: number, event: { mouseOffset: { x: number; y: number } }) {\n    this.rectangle.updateSize(event.mouseOffset.x, event.mouseOffset.y)\n    this.renderSelection()\n    this.checkInNodes(e, event)\n  }\n\n  reset() {\n    this.setMultiplexSelectNodes([])\n    this.hasSelection = false\n    this.renderSelection()\n    this.emitChange()\n  }\n\n  renderSelection() {\n    this.canvas.clearCanvas()\n    this.ctx?.save()\n    if (this.app.state.scale) {\n      this.ctx?.scale(this.app.state.scale, this.app.state.scale)\n    }\n    this.rectangle.render()\n    this.multiplexSelectNode.render()\n    this.ctx?.restore()\n  }\n\n  init() {\n    if (this.canvas) {\n      this.app.mountEL.removeChild(this.canvas.el)\n    }\n    this.width = this.app.width\n    this.height = this.app.height\n    this.canvas = new Canvas(this.width, this.height, {\n      className: 'selection'\n    })\n    this.ctx = this.canvas.ctx\n    this.app.mountEL.appendChild(this.canvas.el)\n  }\n}\n","import EventEmitter from 'eventemitter3'\n\nimport { getFontString, getTextNodeSize } from '../common/utils'\nimport { AppObject } from '../types'\n\nexport default class TextEdit extends EventEmitter {\n  private readonly app: AppObject\n\n  private editable: undefined | HTMLTextAreaElement\n\n  isEditing: boolean\n\n  constructor(app: AppObject) {\n    super()\n    this.app = app\n    this.editable = undefined\n    this.isEditing = false\n    this.onTextInput = this.onTextInput.bind(this)\n    this.onTextBlur = this.onTextBlur.bind(this)\n  }\n\n  // Show text edit box\n  showTextEdit() {\n    if (!this.editable) {\n      this.crateTextInputEl()\n    } else {\n      this.editable.style.display = 'block'\n    }\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    this.updateTextInputStyle()\n    this.editable.focus()\n    this.editable.select()\n    this.isEditing = true\n  }\n\n  // Text input events\n  onTextInput() {\n    const { activeNode } = this.app.nodes\n    if (!activeNode) {\n      return\n    }\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    activeNode.text = this.editable.value\n    const { width, height } = getTextNodeSize(activeNode)\n    activeNode.width = width\n    activeNode.height = height\n    this.updateTextInputStyle()\n  }\n\n  // Text box out-of-focus event\n  onTextBlur() {\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    this.editable.style.display = 'none'\n    this.editable.value = ''\n    this.emit('blur')\n    this.isEditing = false\n  }\n\n  // Create text input box graphic objects\n  crateTextInputEl() {\n    this.editable = document.createElement('textarea')\n    this.editable.dir = 'auto'\n    this.editable.tabIndex = 0\n    this.editable.wrap = 'off'\n    this.editable.className = 'textInput'\n    Object.assign(this.editable.style, {\n      position: 'fixed',\n      display: 'block',\n      minHeight: '1em',\n      backfaceVisibility: 'hidden',\n      margin: 0,\n      padding: 0,\n      border: 0,\n      outline: 0,\n      resize: 'none',\n      background: 'transparent',\n      overflow: 'hidden',\n      whiteSpace: 'pre'\n    })\n    this.editable.addEventListener('input', this.onTextInput)\n    this.editable.addEventListener('blur', this.onTextBlur)\n    document.body.appendChild(this.editable)\n  }\n\n  // Update the style of the text input box according to the style of the current text graphic object\n  updateTextInputStyle() {\n    const { activeNode } = this.app.nodes\n    if (!activeNode) {\n      return\n    }\n    if (typeof this.editable === 'undefined') {\n      return\n    }\n    let { x, y }: any = activeNode\n    const { width, height, style, text, rotate }: any = activeNode\n    const { calculate, state } = this.app\n    this.editable.value = text\n    x = calculate.subScrollX(x)\n    y = calculate.subScrollY(y)\n    if (typeof state.scale === 'undefined') {\n      return\n    }\n    // Screen coordinates to canvas coordinates\n    const sp = calculate.scale(x, y)\n    const tp = calculate.mountELToWindow(sp.x, sp.y)\n    const fontSize = style.fontSize * state.scale\n    const styles = {\n      font: getFontString(fontSize, style.fontFamily),\n      lineHeight: `${fontSize * style.lineHeightRatio}px`,\n      left: `${tp.x}px`,\n      top: `${tp.y}px`,\n      color: style.fillStyle,\n      width: `${Math.max(width, 100) * state.scale}px`,\n      height: `${height * state.scale}px`,\n      transform: `rotate(${rotate}deg)`,\n      opacity: style.globalAlpha\n    }\n    Object.assign(this.editable.style, styles)\n  }\n}\n","import {\n  DiffNodesRes,\n  DiffStateRes,\n  LocalData,\n  NodeArray,\n  State\n} from '../../types'\n\n// Depth-first traversal based on key to determine if equal\nexport function isEqual(oldData: any, nowData: any) {\n  if (typeof oldData !== typeof nowData) {\n    return false\n  }\n  if (typeof oldData !== 'object') {\n    return oldData === nowData\n  }\n  const oldKeys = Object.keys(oldData)\n  const nowKeys = Object.keys(nowData)\n  if (oldKeys.length !== nowKeys.length) {\n    return false\n  }\n  for (let i = 0; i < oldKeys.length; i += 1) {\n    const key = oldKeys[i]\n    if (!isEqual(oldData[key], nowData[key])) {\n      return false\n    }\n  }\n  return true\n}\n\n// diff nodes\nexport function getDiffData(oldData: LocalData, nowData: LocalData) {\n  const isUNOld = typeof oldData === 'undefined'\n  const isUNNow = typeof nowData === 'undefined'\n  if (isUNOld && isUNNow) {\n    return undefined\n  }\n  if (isUNNow) {\n    return {\n      type: 'delete-all'\n    }\n  }\n  if (isUNOld && nowData.nodes.length === 0) {\n    return {\n      type: 'delete-all'\n    }\n  }\n  if (isUNOld) {\n    return {\n      type: 'cover-all',\n      nodes: nowData.nodes\n    }\n  }\n  if (isEqual(oldData.nodes, nowData.nodes)) {\n    return undefined\n  }\n  const oldNodes = oldData.nodes\n  const nowNodes = nowData.nodes\n  const oldLen = oldNodes.length\n  const nowLen = nowNodes.length\n  // Add｜Delete Operation\n  const isAdd = nowLen > oldLen\n  const isDelete = nowLen < oldLen\n  if (isAdd || isDelete) {\n    const ANodes = isAdd ? nowNodes : oldNodes\n    const PIDs = isAdd\n      ? oldNodes.map((item) => item.id)\n      : nowNodes.map((item) => item.id)\n    let diffNodes = ANodes.filter((item) => !PIDs.includes(item.id))\n    if (isDelete) {\n      diffNodes = diffNodes.map((item) => ({ id: item.id })) as any\n    }\n    return {\n      type: isAdd ? 'add' : 'delete',\n      nodes: diffNodes\n    }\n  }\n  if (nowLen === oldLen) {\n    const updateNodes = []\n    // Determine which attributes have changed and store those that have changed, but not those that have not\n    for (let i = 0; i < nowLen; i += 1) {\n      if (!isEqual(oldNodes[i], nowNodes[i])) {\n        const diff: any = {}\n        Object.keys(nowNodes[i]).forEach((key) => {\n          // @ts-ignore\n          if (!isEqual(oldNodes[i][key], nowNodes[i][key])) {\n            // @ts-ignore\n            diff[key] = nowNodes[i][key]\n          }\n        })\n        diff.id = nowNodes[i].id\n        updateNodes.push(diff)\n      }\n    }\n    if (updateNodes.length > 0) {\n      return {\n        type: 'update',\n        nodes: updateNodes\n      }\n    }\n  }\n  return undefined\n}\n\nexport function parseDiffNodes(\n  oldNodes: NodeArray,\n  { type, nodes }: DiffNodesRes\n): NodeArray {\n  const fns = {\n    add: () => {\n      oldNodes.push(...nodes)\n    },\n    delete: () => {\n      nodes.forEach((item) => {\n        const index = oldNodes.findIndex((node) => node.id === item.id)\n        oldNodes.splice(index, 1)\n      })\n    },\n    update: () => {\n      nodes.forEach((item) => {\n        const index = oldNodes.findIndex((node) => node.id === item.id)\n        oldNodes[index] = { ...oldNodes[index], ...item }\n      })\n    },\n    'cover-all': () => {\n      oldNodes.splice(0, oldNodes.length, ...nodes)\n    },\n    'delete-all': () => {\n      oldNodes.splice(0, oldNodes.length)\n    }\n  }\n  fns[type]()\n  return oldNodes\n}\n\n// diff state att: ( backgroundColor / showGrid / showGrid )\nexport function getDiffState(oldData: LocalData, nowData: LocalData) {\n  const oldState = oldData?.state\n  if (typeof oldState === 'undefined') {\n    return undefined\n  }\n  const nowState = nowData?.state\n  const isDiffBac = oldState.backgroundColor !== nowState.backgroundColor\n  const isDiffGrid = oldState.showGrid !== nowState.showGrid\n  const isDiffReadonly = oldState.readonly !== nowState.readonly\n  if (isDiffBac || isDiffGrid || isDiffReadonly) {\n    const state: any = {}\n    if (isDiffBac) {\n      state.backgroundColor = nowState.backgroundColor\n    }\n    if (isDiffGrid) {\n      state.showGrid = nowState.showGrid\n    }\n    if (isDiffReadonly) {\n      state.readonly = nowState.readonly\n    }\n    return {\n      type: 'update-state',\n      state\n    }\n  }\n  return undefined\n}\n\nexport function parseDiffState(oldState: State, { state }: DiffStateRes) {\n  Object.keys(state).forEach((key) => {\n    // @ts-ignore\n    oldState[key] = state[key]\n  })\n  return oldState\n}\n","import ArbitraryPlot from './ArbitraryPlot'\nimport Arrow from './Arrow'\nimport Circle from './Circle'\nimport Diamond from './Diamond'\nimport Image from './Image'\nimport Line from './Line'\nimport MultiplexSelectNode from './MultiplexSelectNode'\nimport Rectangle from './Rectangle'\nimport Text from './Text'\nimport Triangle from './Triangle'\n\nexport default {\n  ArbitraryPlot,\n  Arrow,\n  Circle,\n  Diamond,\n  Image,\n  Line,\n  MultiplexSelectNode,\n  Rectangle,\n  Text,\n  Triangle\n}\n","import EventEmitter from 'eventemitter3'\n\nimport Author from './classFile/Author'\nimport Background from './classFile/Background'\nimport Cursor from './classFile/Cursor'\nimport Event from './classFile/Event'\nimport Export from './classFile/Export'\nimport Grid from './classFile/Grid'\nimport History from './classFile/History'\nimport ImageEdit from './classFile/ImageEdit'\nimport KeyCommand from './classFile/KeyCommand'\nimport Nodes from './classFile/Nodes'\nimport Render from './classFile/Render'\nimport Selection from './classFile/Selection'\nimport TextEdit from './classFile/TextEdit'\nimport {\n  createCanvas,\n  createImageObj,\n  getTowCoordinateDistance,\n  throttle\n} from './common/utils'\nimport * as utils from './common/utils'\nimport Calculate from './common/utils/Calculate'\nimport * as checkClick from './common/utils/checkClick'\nimport {\n  getDiffData,\n  getDiffState,\n  parseDiffNodes,\n  parseDiffState\n} from './common/utils/diffData'\nimport nodes from './components'\nimport * as plot from './support/plot'\nimport {\n  Ctx,\n  DiffNodesRes,\n  DiffStateRes,\n  LocalData,\n  OnCallBack,\n  PlotType,\n  State\n} from './types'\n\ntype Options = {\n  mountEL: HTMLElement | HTMLDivElement\n  plotType?: PlotType\n  state?: State\n}\n\nclass CreatLoader extends EventEmitter {\n  public options: Options\n\n  public readonly mountEL: HTMLElement | HTMLDivElement\n\n  public plotType: any\n\n  public width: number\n\n  public height: number\n\n  public left: number\n\n  public top: number\n\n  public canvas: HTMLCanvasElement | undefined\n\n  public ctx: Ctx | undefined\n\n  public state: State\n\n  public calculate: Calculate\n\n  public event: Event\n\n  public keyCommand: KeyCommand\n\n  public imageEdit: ImageEdit\n\n  public textEdit: TextEdit\n\n  public cursor: Cursor\n\n  public history: History\n\n  public export: Export\n\n  public background: Background\n\n  public selection: Selection\n\n  public grid: Grid\n\n  public author: Author\n\n  public nodes: any\n\n  public render: Render\n\n  public watch: any\n\n  static utils: any\n\n  static checkClick: any\n\n  static plot: any\n\n  static nodes: any\n\n  public onceLoaderOK: boolean = false\n\n  constructor(options: Options) {\n    super()\n\n    window.onload = () => {\n      this.onceLoaderOK = true\n    }\n\n    this.options = options\n\n    this.mountEL = options.mountEL\n\n    this.plotType = options.plotType || 'selection'\n\n    // Container width and height position information\n    this.width = 0\n    this.height = 0\n    this.left = 0\n    this.top = 0\n\n    // Main rendering canvas graphics objects\n    this.canvas = undefined\n\n    // canvas drawing context\n    this.ctx = undefined\n\n    // Canvas state\n    this.state = {\n      // resizing\n      scale: 1,\n      // Scroll offset in horizontal direction\n      scrollX: 0,\n      // Scroll offset in vertical direction\n      scrollY: 0,\n      // Rolling step\n      scrollStep: 25,\n      // Background colour\n      backgroundColor: '',\n      // Whether to display the grid or not\n      showGrid: false,\n      // Is it read-only mode\n      readonly: false,\n      // Default colour\n      defaultColor: '#000000',\n      // Grid configuration\n      gridConfig: {\n        // Grid size\n        size: 20,\n        // Grid line colours\n        strokeStyle: '#dfe0e1',\n        // Mesh line width\n        lineWidth: 1\n      },\n      // Coverage\n      ...(options.state || {})\n    } as any\n\n    this.initCanvas()\n\n    this.calculate = new Calculate(this as any)\n\n    this.event = new Event(this as any)\n    this.event.on('mousedown', this.onMousedown, this)\n    this.event.on('mousemove', this.onMousemove, this)\n    this.event.on('mouseup', this.onMouseup, this)\n    this.event.on('dblclick', this.onDblclick, this)\n    this.event.on('mousewheel', this.onMousewheel, this)\n    this.event.on('contextmenu', this.onContextmenu, this)\n\n    this.keyCommand = new KeyCommand(this as any)\n\n    this.imageEdit = new ImageEdit(this as any)\n    this.imageEdit.on('imageSelectChange', this.onImageSelectChange, this)\n\n    this.textEdit = new TextEdit(this as any)\n    this.textEdit.on('blur', this.onTextInputBlur, this)\n\n    this.cursor = new Cursor(this as any)\n\n    this.history = new History(this as any)\n\n    this.export = new Export(this as any)\n\n    this.background = new Background(this as any)\n\n    this.selection = new Selection(this as any)\n\n    this.grid = new Grid(this as any)\n\n    this.nodes = new Nodes(this as any)\n\n    this.render = new Render(this as any)\n\n    this.author = new Author(this as any)\n\n    this.mountFunction()\n\n    this.checkIsOnNode = throttle(this.checkIsOnNode, this as any)\n\n    this.emitChange()\n\n    this.helpUpdate()\n\n    this.watch = {\n      zoomChange: (callback: OnCallBack) => this.on('zoomChange', callback),\n      scrollChange: (callback: OnCallBack) => this.on('scrollChange', callback),\n      currentTypeChange: (callback: OnCallBack) =>\n        this.on('currentTypeChange', callback),\n      shuttle: (callback: OnCallBack) => this.on('shuttle', callback),\n      activeNodeChange: (callback: OnCallBack) =>\n        this.on('activeNodeChange', callback),\n      multiplexSelectChange: (callback: OnCallBack) =>\n        this.on('multiplexSelectChange', callback),\n      contextmenu: (callback: OnCallBack) => this.on('contextmenu', callback),\n      diffNodesChange: (callback: OnCallBack) =>\n        this.on('diffNodesChange', callback),\n      diffStateChange: (callback: OnCallBack) =>\n        this.on('diffStateChange', callback),\n      localDataChange: (callback: OnCallBack) => this.on('change', callback),\n      nodeRotateChange: (callback: OnCallBack) => {\n        this.on('nodeRotateChange', callback)\n      }\n    }\n  }\n\n  mountFunction() {\n    ;['exportImage', 'exportJson'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.export[method].bind(this.export)\n    })\n    ;['showGrid', 'hideGrid', 'updateGrid'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.grid[method].bind(this.grid)\n    })\n    ;['setEditAuthor', 'setReadonlyAuthor'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.author[method].bind(this.author)\n    })\n    ;['undo', 'redo'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.history[method].bind(this.history)\n    })\n    ;['unBindEvent', 'bindEvent'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.keyCommand[method].bind(this.keyCommand)\n    })\n    ;['setSelectedNodeStyle', 'cancelSelectNodes'].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.selection[method].bind(this.selection)\n    })\n    ;[\n      'updateActiveNodeRotate',\n      'updateActiveNodeSize',\n      'updateActiveNodePosition',\n      'cancelActiveNode',\n      'scrollToCenter',\n      'copyPasteCurrentNodes',\n      'empty',\n      'zoomIn',\n      'zoomOut',\n      'setZoom',\n      'selectAll',\n      'fit',\n      'deleteActiveNode',\n      'deleteCurrentNodes',\n      'setBackgroundColor',\n      'copyNode',\n      'copyCurrentNode',\n      'deleteNode',\n      'setActiveNodeStyle',\n      'setCurrentNodesStyle',\n      'scrollTo',\n      'cutCurrentNode',\n      'pasteCurrentNode'\n    ].forEach((method) => {\n      // @ts-ignore\n      this[method] = this.render[method].bind(this.render)\n    })\n  }\n\n  // Access to data, including state data and graphical object data\n  getData() {\n    return {\n      state: {\n        ...this.state\n      },\n      nodes: this.nodes.serialize()\n    }\n  }\n\n  // Image selection events\n  onImageSelectChange() {\n    this.cursor.hide()\n  }\n\n  // Get container size location information\n  getContainerRectInfo() {\n    const { width, height, left, top } = this.mountEL.getBoundingClientRect()\n    this.width = width\n    this.height = height\n    this.left = left\n    this.top = top\n  }\n\n  // Rendering as necessary\n  helpUpdate() {\n    if (this.state.readonly) {\n      // @ts-ignore\n      this.setReadonlyAuthor()\n    }\n    if (this.state.showGrid) {\n      this.grid.showGrid()\n    }\n    this.background.set()\n  }\n\n  // Setting data, including status data and graphic object data\n  async setData(\n    { state = {}, nodes = [] }: any,\n    noEmitChange: boolean,\n    noDiffData?: boolean\n  ) {\n    this.state = state\n    for (let i = 0; i < nodes.length; i += 1) {\n      if (nodes[i].type === 'image') {\n        // eslint-disable-next-line no-await-in-loop\n        nodes[i].imageObj = await createImageObj(nodes[i].url)\n      }\n    }\n    this.helpUpdate()\n    this.nodes.deleteAllNodes().createNodesFromData(nodes)\n    this.render.render()\n    if (!noEmitChange) {\n      this.emitChange(noDiffData)\n    }\n  }\n\n  initCanvas() {\n    this.getContainerRectInfo()\n    if (this.canvas) {\n      this.mountEL.removeChild(this.canvas)\n    }\n    const { canvas, ctx }: any = createCanvas(this.width, this.height, {\n      className: 'main'\n    })\n    this.canvas = canvas\n    this.ctx = ctx\n    this.mountEL.appendChild(this.canvas as any)\n  }\n\n  // Container resizing\n  resize() {\n    this.initCanvas()\n    this.render.render()\n    this.selection.init()\n    this.grid.init()\n    this.grid.renderGrid()\n  }\n\n  // Updating the state data only updates the state data and does not trigger a render\n  updateState(data = {}) {\n    this.state = {\n      ...this.state,\n      ...data\n    }\n    this.emitChange(undefined, true)\n  }\n\n  // Update current drawing type\n  updateCurrentType(plotType: PlotType) {\n    this.plotType = plotType\n    if (this.plotType === 'image') {\n      this.imageEdit.selectImage()\n    }\n    if (this.plotType === 'eraser') {\n      this.cursor.setEraser()\n      // @ts-ignore\n      this.cancelActiveNode()\n    } else if (this.plotType === 'text') {\n      this.cursor.setText()\n    } else if (this.plotType !== 'selection') {\n      this.cursor.setCrossHair()\n    } else {\n      this.cursor.reset()\n    }\n    this.emit('currentTypeChange', this.plotType)\n  }\n\n  // Mouse press event\n  onMousedown(\n    e: {\n      unGridClientX?: number\n      unGridClientY?: number\n      originEvent?: { which: number }\n    },\n    event: { mousedownPos: any }\n  ) {\n    if (this.state.readonly || this.author.isDragAuthor) {\n      this.author.onStart()\n      return\n    }\n    if (!this.nodes.isCreateNode && !this.textEdit.isEditing) {\n      const clickNode = this.nodes.checkIsClickNode(e)\n      if (this.plotType === 'selection') {\n        if (this.nodes.hasActiveNode()) {\n          const isResize = this.nodes.checkIsResize(\n            event.mousedownPos.unGridClientX,\n            event.mousedownPos.unGridClientY,\n            e\n          )\n          if (!isResize) {\n            this.nodes.setActiveNode(clickNode as any)\n            this.render.render()\n          }\n        } else if (this.selection.hasSelection) {\n          const isResize = this.selection.checkIsResize(\n            event.mousedownPos.unGridClientX,\n            event.mousedownPos.unGridClientY,\n            e\n          )\n          if (!isResize) {\n            this.selection.reset()\n            this.nodes.setActiveNode(clickNode as any)\n            this.render.render()\n          }\n        } else if (clickNode) {\n          this.nodes.setActiveNode(clickNode)\n          this.render.render()\n          this.onMousedown(e, event)\n        } else {\n          this.selection.onMousedown(e as any, event)\n        }\n      } else if (this.plotType === 'eraser') {\n        // @ts-ignore\n        this.deleteNode(clickNode)\n      }\n    }\n  }\n\n  // Mouse movement events\n  onMousemove(e: any, event: any) {\n    // TODO : Real-time synchronisation, currently on mouse up, expected to be on mouse over\n    if (this.state.readonly || this.author.isDragAuthor) {\n      if (event.isMousedown) {\n        this.author.onMove(e, event)\n      }\n      return\n    }\n    if (event.isMousedown) {\n      const mx = event.mousedownPos.x\n      const my = event.mousedownPos.y\n      const offsetX = Math.max(event.mouseOffset.x, 0)\n      const offsetY = Math.max(event.mouseOffset.y, 0)\n      if (this.plotType === 'selection') {\n        if (this.selection.isResize) {\n          this.selection.handleResize(\n            e,\n            mx,\n            my,\n            event.mouseOffset.x,\n            event.mouseOffset.y\n          )\n        } else if (this.selection.createSelection) {\n          this.selection.onMousemove(e, event)\n        } else {\n          this.nodes.handleResize(\n            e,\n            mx,\n            my,\n            event.mouseOffset.x,\n            event.mouseOffset.y\n          )\n          this.render.render()\n        }\n      } else if (['rectangle', 'diamond', 'triangle'].includes(this.plotType)) {\n        this.nodes.createRectangleLikeNode(\n          this.plotType,\n          mx,\n          my,\n          offsetX,\n          offsetY\n        )\n        this.render.render()\n      } else if (this.plotType === 'circle') {\n        this.nodes.createCircle(mx, my, e)\n        this.render.render()\n      } else if (this.plotType === 'arbitrary-plot') {\n        this.nodes.createArbitraryPlot(e, event)\n      } else if (this.plotType === 'arrow') {\n        this.nodes.createArrow(mx, my, e)\n        this.render.render()\n      } else if (this.plotType === 'line') {\n        if (getTowCoordinateDistance(mx, my, e.clientX, e.clientY) > 3) {\n          this.nodes.createLine(mx, my, e, true)\n          this.render.render()\n        }\n      }\n    } else if (this.imageEdit.isReady) {\n      this.cursor.hide()\n      this.imageEdit.updatePreviewElPos(\n        e.originEvent.clientX,\n        e.originEvent.clientY\n      )\n    } else if (this.plotType === 'selection') {\n      if (this.nodes.hasActiveNode()) {\n        const handData: any = ''\n        const h = this.nodes.checkInResizeHand(e.unGridClientX, e.unGridClientY)\n        if (h) {\n          this.cursor.setResize(handData.hand)\n        } else {\n          // @ts-ignore\n          this.checkIsOnNode(e)\n        }\n      } else if (this.selection.hasSelection) {\n        const hand = this.selection.checkInResizeHand(\n          e.unGridClientX,\n          e.unGridClientY\n        )\n        if (hand) {\n          this.cursor.setResize(hand)\n        } else {\n          // @ts-ignore\n          this.checkIsOnNode(e)\n        }\n      } else {\n        // @ts-ignore\n        this.checkIsOnNode(e)\n      }\n    } else if (this.plotType === 'line') {\n      this.nodes.createLine(undefined, undefined, e, false, true)\n      this.render.render()\n    }\n  }\n\n  // Detects if a graphic object has been slid over\n  checkIsOnNode(e: { unGridClientX: number; unGridClientY: number }) {\n    const clickNode = this.nodes.checkIsClickNode(e)\n    if (clickNode) {\n      this.cursor.setMove()\n    } else {\n      this.cursor.reset()\n    }\n  }\n\n  // Reset current type to selection mode\n  resetCurrentType() {\n    if (this.plotType !== 'selection') {\n      this.plotType = 'selection'\n      this.emit('currentTypeChange', 'selection')\n    }\n  }\n\n  // Creation of new graphic objects complete\n  completeCreateNewNode() {\n    this.resetCurrentType()\n    this.nodes.completeCreateNode()\n    this.render.render()\n  }\n\n  // Mouse release event\n  onMouseup(e: any) {\n    if (this.state.readonly || this.author.isDragAuthor) {\n      return\n    }\n    if (this.plotType === 'text') {\n      if (!this.textEdit.isEditing) {\n        this.createTextNode(e)\n        this.resetCurrentType()\n      }\n    } else if (this.imageEdit.isReady) {\n      this.nodes.createImage(e, this.imageEdit.imageData as any)\n      this.completeCreateNewNode()\n      this.cursor.reset()\n      this.imageEdit.reset()\n    } else if (this.plotType === 'arrow') {\n      this.nodes.completeCreateArrow(e)\n      this.completeCreateNewNode()\n    } else if (this.plotType === 'line') {\n      this.nodes.completeCreateLine(e, () => {\n        this.completeCreateNewNode()\n      })\n      this.render.render()\n    } else if (this.nodes.isCreateNode) {\n      if (this.plotType === 'arbitrary-plot') {\n        this.nodes.completeCreateNode()\n        this.nodes.setActiveNode()\n      } else {\n        this.completeCreateNewNode()\n      }\n    } else if (this.nodes.isResize) {\n      this.nodes.endResize()\n      this.emitChange()\n    } else if (this.selection.createSelection) {\n      this.selection.onMouseup()\n    } else if (this.selection.isResize) {\n      this.selection.endResize()\n      this.emitChange()\n    }\n  }\n\n  // Double click event\n  onDblclick(e: { unGridClientX: number; unGridClientY: number }) {\n    if (this.plotType === 'line') {\n      this.completeCreateNewNode()\n    } else {\n      const clickNode = this.nodes.checkIsClickNode(e)\n      if (clickNode) {\n        if (clickNode.type === 'text') {\n          this.nodes.editingText(clickNode)\n          this.render.render()\n          this.keyCommand.unBindEvent()\n          this.textEdit.showTextEdit()\n        }\n      } else if (!this.textEdit.isEditing) {\n        // @ts-ignore\n        this.createTextNode(e)\n      }\n    }\n  }\n\n  // Text box out-of-focus event\n  onTextInputBlur() {\n    this.keyCommand.bindEvent()\n    this.nodes.completeEditingText()\n    this.render.render()\n    this.emitChange()\n  }\n\n  // Creating text graphic objects\n  createTextNode(e: { clientX: any; clientY: any }) {\n    this.nodes.createNode({\n      type: 'text',\n      x: e.clientX,\n      y: e.clientY\n    })\n    this.keyCommand.unBindEvent()\n    this.textEdit.showTextEdit()\n  }\n\n  // Mouse scroll event\n  onMousewheel(dir: string) {\n    if (\n      typeof this.state.scrollStep === 'undefined' ||\n      typeof this.state.scale === 'undefined'\n    ) {\n      return\n    }\n    const stepNum = this.state.scrollStep / this.state.scale\n    const step = dir === 'down' ? stepNum : -stepNum\n    // @ts-ignore\n    this.scrollTo(this.state.scrollX, this.state.scrollY + step)\n  }\n\n  // Right-click menu events\n  onContextmenu(e: { originEvent: any }) {\n    let el: any\n    if (this.nodes.hasActiveNode()) {\n      el = [this.nodes.activeNode]\n    } else if (this.selection.hasSelectionNodes()) {\n      el = this.selection.getSelectionNodes()\n    }\n    this.emit('contextmenu', e.originEvent, el)\n  }\n\n  unBindEvent() {\n    this.keyCommand.unBindEvent()\n  }\n\n  bindEvent() {\n    this.keyCommand.bindEvent()\n  }\n\n  // Triggering update events\n  emitChange(noDiffData?: boolean, noHistory?: boolean) {\n    const data = this.getData()\n    const oldData = this.history.now()\n    if (\n      (typeof oldData === 'undefined' && data.nodes.length !== 0) ||\n      (typeof oldData !== 'undefined' && !noHistory)\n    ) {\n      this.history.add(<LocalData>data)\n    }\n    if (this.onceLoaderOK && !noDiffData) {\n      this.emitDiffNodesChange(oldData, data)\n      this.emitDiffStateChange(oldData, data)\n    }\n    this.emit('change', data)\n  }\n\n  // Customised data object update triggers with diff algorithm processing\n  emitDiffNodesChange(oldData: LocalData, nowData: LocalData) {\n    const diffRes = getDiffData(oldData, nowData)\n    if (typeof diffRes === 'object') {\n      this.emit('diffNodesChange', diffRes)\n    }\n  }\n\n  // Customised data state update triggers with diff algorithm processing\n  emitDiffStateChange(oldData: LocalData, nowData: LocalData) {\n    const diffRes = getDiffState(oldData, nowData)\n    if (typeof diffRes !== 'undefined') {\n      this.emit('diffStateChange')\n    }\n  }\n\n  async parseSetDiffData(config: DiffNodesRes | DiffStateRes) {\n    const oldData = this.getData()\n    const newData: any = {}\n    if (config.type === 'update-state') {\n      newData.nodes = oldData.nodes\n      newData.state = parseDiffState(oldData.nodes, config)\n    } else {\n      newData.state = oldData.state\n      newData.nodes = parseDiffNodes(oldData.nodes, config)\n    }\n    await this.setData(newData, false, true)\n  }\n}\n\nCreatLoader.utils = utils\nCreatLoader.checkClick = checkClick\nCreatLoader.plot = plot\nCreatLoader.nodes = nodes\n\nexport default CreatLoader\n","import CreatLoader from './API'\nimport { AppResponse, AppState } from './types'\n\nexport default function creatLoader(state: AppState) {\n  function mount(mountEl: string | Object | HTMLElement): AppResponse {\n    // get DOM\n    const el =\n      typeof mountEl === 'string' ? document.querySelector(mountEl) : mountEl\n    // check\n    if (!el || !(el instanceof HTMLElement)) {\n      throw new Error('mountEl is not a HTMLElement !')\n    }\n    if (\n      !['absolute', 'fixed', 'relative'].includes(\n        window.getComputedStyle(<HTMLElement>el).position\n      )\n    ) {\n      throw new Error(\n        'The DOM being mounted needs to be set to absolute/fixed/relative positioning!'\n      )\n    }\n    // init\n    return new CreatLoader({\n      mountEL: el as any,\n      plotType: state.plotType,\n      state\n    }) as unknown as AppResponse\n  }\n  return { mount }\n}\n"],"names":["keyPosit","0","1","2","3","4","5","6","7","8","9","Backspace","Tab","Enter","Shift","Control","Alt","CapsLock","Esc","Space","PageUp","PageDown","End","Home","Insert","Left","Up","Right","Down","Del","NumLock","Cmd","CmdFF","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","`","=","+","-","'","/",".","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","FOUR_CORNER","TOP_LEFT","TOP_RIGHT","BOTTOM_RIGHT","BOTTOM_LEFT","DRAG_NODE_PARTS","BODY","ROTATE","TOP_LEFT_BUTTON","TOP_RIGHT_BUTTON","BOTTOM_RIGHT_BUTTON","BOTTOM_LEFT_BUTTON","getNodeID","Math","floor","random","Date","getTime","toString","let","nodeKeyIndex","createNodeKey","deepCopy","JSON","parse","stringify","obj","throttle","fn","ctx","time","_timer","args","setTimeout","call","getFontString","fontSize","fontFamily","splitTextLines","text","replace","split","radToDeg","rad","PI","degToRad","deg","createCanvas","width","height","option","noStyle","noTranslate","className","canvas","document","createElement","style","cssText","getContext","translate","getTowCoordinateDistance","x1","y1","x2","y2","sqrt","getCoordinateToLineDistance","abs","A","B","checkIsAtSegment","dis","dis1","dis2","dis3","max","getTowCoordinateRotate","cx","cy","tx","ty","fx","fy","atan2","getRotatedCoordinate","rotate","del","cos","sin","getNodeCenterCoordinate","node","transformCoordinateReverseRotate","rp","transformCoordinateOnNode","center","getNodeFourCornerCoordinate","dir","getBoundingRect","coordinateArr","returnFourCorners","minX","Infinity","maxX","minY","maxY","forEach","coordinate","getNodeRotatedFourCornerCoordinate","dirPos","checkCoordinateIsInRectangle","rx","ry","rw","rh","getMultiplexNodeRectInfo","nodeList","length","getEndCoordinateList","textCheckEl","getTextActWidth","position","left","body","appendChild","innerText","getBoundingClientRect","getNodeFourCorners","bottomRight","createImageObj","Promise","img","Image","setAttribute","onload","resolve","onerror","src","url","getWrapTextActWidth","textArr","maxWidth","textRow","getTextNodeSize","lineHeightRatio","computedLineWidthBySpeed","speed","lastLineWidth","baseLineWidth","lineWidth","maxLineWidth","file","fileName","href","download","click","maxNumber","Author","app","startScrollX","startScrollY","isDragAuthor","constructor","this","onMove","bindEvent","onStart","state","scrollX","scrollY","event","scale","scrollTo","mouseOffset","originX","originY","on","keyCode","cursor","set","setEditAuthor","updateState","readonly","setReadonlyAuthor","cancelActiveNode","Background","backgroundColor","addBackgroundColor","remove","mountEL","canvasAddBackgroundColor","save","rect","fillStyle","fill","restore","Cursor","currentType","type","setEraser","setText","setMove","hide","reset","setCrossHair","setResize","direction","Event","EventEmitter","calculate","lastMousePos","mouseDistance","lastMouseTime","mouseDuration","mouseSpeed","isMousedown","mousedownPos","super","now","unGridClientX","unGridClientY","originClientX","originClientY","onMousedown","bind","onMousemove","onMouseup","onDblclick","onMousewheel","onKeydown","onKeyup","onContextmenu","transformEvent","emit","originEvent","wheelDelta","stopPropagation","preventDefault","clientX","clientY","curTime","wp","windowToContainer","reverseScale","addScrollX","addScrollY","gp","gridAdsorbent","addEventListener","window","unbindEvent","removeEventListener","Export","openPreview","saveState","exportJson","getData","render","onlySelected","getNodeList","cacheActive","cacheSelected","noRender","isActive","isSelected","saveAppState","exportImage","renderBg","useBlob","paddingX","paddingY","show","changeAppState","recoveryAppState","reject","toBlob","blob","toDataURL","console","error","nodes","selectedNodes","activeNode","push","selection","hasSelectionNodes","getSelectionNodes","filter","includes","Canvas","el","opt","clearCanvas","clearRect","Grid","init","renderGrid","renderVerticalLines","gridConfig","maxRight","size","plotVerticalLine","subScrollX","renderHorizontalLines","maxBottom","plotHorizontalLine","subScrollY","showGrid","strokeStyle","_i","beginPath","moveTo","lineTo","stroke","hideGrid","updateGrid","config","removeChild","insertBefore","children","History","historyStack","index","fixIndex","emitChange","clear","add","data","prev","copyData","shuttle","oldData","fixLength","setData","then","emitDiffNodesChange","emitDiffStateChange","catch","undo","redo","ImageEdit","isReady","previewEl","imageData","maxHeight","maxRatio","onImageSelectChange","updatePreviewElPos","ratio","backgroundImage","backgroundSize","pointerEvents","tp","mountELToWindow","top","value","getImageUrl","reader","FileReader","onloadend","result","readAsDataURL","getImageSize","imageObj","await","target","files","selectImage","accept","KeyCommand","shortcutMap","getKeyCodeArr","key","keyArr","map","item","arr","getOriginEventCodeArr","ctrlKey","metaKey","altKey","shiftKey","checkKey","findIndex","splice","Object","keys","addShortcut","removeShortcut","unBindEvent","off","checkIsAtRectangleInner","getCircleRadius","min","checkIsAtMultiplexSegment","segments","res","seg","checkIsAtCircleEdge","radius","checkIsAtRectangleEdge","checkIsAtTriangleEdge","checkIsAtDiamondEdge","checkIsAtArrowEdge","checkIsAtArbitraryPlotLineEdge","checkIsAtLineEdge","len","BaseNode","id","isCreate","startX","startY","startRotate","dragNode","options","defaultColor","lineDash","globalAlpha","undefined","isClick","Error","offsetRotate","or","updateRotate","setStyle","_style","setLineDash","warpRender","renderFn","transform","halfWidth","halfHeight","move","ox","oy","rotateByCenter","np","updatePos","startResize","resizeType","endResize","resize","handleResizeNode","updateRect","updateSize","serialize","renderDragNode","showAll","onlyShowBody","BaseMultiplexCoordinateNode","startCoordinateArr","startWidth","startHeight","fictitiousCoordinate","opts","scaleX","scaleY","slice","offsetX","offsetY","updateMultiplexCoordinateBoundingRect","addCoordinate","Array","isArray","updateFictitiousCoordinate","plotWrap","plotCircle","arc","plotArrow","lineDeg","plusDeg","_x","_y","plotRect","fillRect","plotDiamond","closePath","transformArbitraryLineCoordinate","plotLineSegment","mx","my","lineCap","lineJoin","plotTriangle","plotArbitraryLine","coordinates","nextCoordinate","plotText","textObj","lineHeight","font","textBaseline","fillText","plotImage","showWidth","showHeight","drawImage","plotLine","first","DragNode","offset","diagonalCoordinate","mousedownPosAndNodePosOffset","nodeRatio","hideParts","notNeedDragNode","lockRatio","handleDragMousedown","corner","centerPos","pos","handleMoveNode","handleRotateNode","handleStretchNode","newCenter","newRatio","newRect","newSize","setHideParts","parts","update","stretchCalc","calcSize","calcPos","isWidthReverse","isHeightReverse","newPos","fixPos","actClientX","actClientY","fixStretch","fp","fixNewRect","checkCoordinateInDragNodeWhere","part","_checkCoordinateIsInButton","ArbitraryPlot","singleRender","Arrow","realtimeCoordinate","concat","Circle","Diamond","Line","isSingle","Rectangle","Text","Triangle","Nodes","isCreateNode","isResize","resizeNode","handleResize","createNode","callback","notActive","hasActiveNode","pureCreateNode","addNode","setActiveNode","copyNode","async","gridAdsorbentPos","createRectangleLikeNode","createCircle","createArbitraryPlot","tfp","transformToCanvasCalculate","ttp","createImage","editingText","completeEditingText","trim","deleteNode","completeCreateArrow","createArrow","createLine","notCreate","insertNode","getNodesNum","hasNodes","unshiftNode","unshift","getNodeIndex","deleteAllNodes","createNodesFromData","nodeObject","checkIsClickNode","completeCreateLine","completeCallback","completeCreateNode","setActiveNodeStyle","checkInResizeHand","hand","checkIsResize","Render","beingCopyActiveNode","beingCopySelectedNodes","beingCopyNode","registerShortcutKeys","setCurrentNodesStyle","setSelectedNodeStyle","keyCommand","selectAll","setZoom","deleteCurrentNodes","copyCurrentNode","cutCurrentNode","history","grid","pasteCurrentNode","setMultiplexSelectNodes","useCurrentEventPos","copySelectionNodes","deleteActiveNode","deleteSelectedNodes","updateActiveNodePosition","updateActiveNodeSize","updateActiveNodeRotate","empty","zoomIn","num","zoomOut","zoom","fit","maxScale","scrollToCenter","copyPasteCurrentNodes","setBackgroundColor","color","background","selectNodes","Calculate","gridSize","transformToScreenCalculate","sp","MultiplexSelectNode","selectedNodeList","wholeCenterPos","updateNodes","exists","setSelectedNodeList","handleRotate","list","Selection","createSelection","hasSelection","rectangle","multiplexSelectNode","checkInNodes","_minX","_maxX","_minY","_maxY","endCoordinateList","task","all","renderSelection","cancelSelectNodes","notUpdateRect","which","TextEdit","editable","isEditing","onTextInput","onTextBlur","showTextEdit","display","crateTextInputEl","updateTextInputStyle","focus","select","tabIndex","wrap","assign","minHeight","backfaceVisibility","margin","padding","border","outline","overflow","whiteSpace","styles","opacity","isEqual","nowData","oldKeys","nowKeys","CreatLoader","plotType","imageEdit","textEdit","export","author","watch","utils","checkClick","plot","onceLoaderOK","scrollStep","initCanvas","onTextInputBlur","mountFunction","checkIsOnNode","helpUpdate","zoomChange","scrollChange","currentTypeChange","activeNodeChange","multiplexSelectChange","contextmenu","diffNodesChange","diffStateChange","localDataChange","nodeRotateChange","method","getContainerRectInfo","noEmitChange","noDiffData","updateCurrentType","clickNode","resetCurrentType","completeCreateNewNode","createTextNode","stepNum","noHistory","diffRes","isUNOld","isUNNow","oldNodes","nowNodes","oldLen","nowLen","isAdd","isDelete","ANodes","PIDs","diffNodes","diff","isDiffBac","isDiffGrid","oldState","nowState","isDiffReadonly","parseSetDiffData","newData","parseDiffState","parseDiffNodes","delete","cover-all","delete-all","mount","mountEl","querySelector","HTMLElement","getComputedStyle"],"mappings":"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"}